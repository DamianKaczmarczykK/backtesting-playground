import{B as createEffect,v as createRenderEffect,a as createMemo,f as onCleanup,$ as $TRACK,u as untrack,d as createRoot,e as createSignal,k as splitProps,s as spread,m as mergeProps,t as template,o as on$1,b as createComponent,i as insert,C as setAttribute,D as onMount,F as use,G as For,S as Show,H as className,p as useContext,q as createContext,I as createUniqueId,x as batch,J as style,K as createComputed,L as Switch,M as Match,P as Portal,c as children,h as delegateEvents}from"./web-Kpt9dW4_.js";import{a as asArray,b as access,t as tryOnCleanup,c as cn$1,d as cva,e as createStore,B as ButtonRoot,_ as __vitePreload,v as visuallyHiddenStyles,m as mergeDefaultProps,P as Polymorphic,f as callHandler,g as createTagName,h as mergeRefs,i as createGenerateId,j as createRegisterId,k as accessWith,l as __export,n as composeEventHandlers,o as isString,p as isNumber,q as focusWithoutScrolling,s as scrollIntoView,r as isAppleDevice,u as getFocusableTreeWalker,w as isMac,x as isWebKit$1,y as combineStyle,z as getWindow$1,A as getActiveElement,C as contains$1,D as removeItemFromArray,E as getDocument,F as isFocusable,G as DATA_TOP_LAYER_ATTR,H as getAllTabbableIn,I as EventKey,J as noop,K as isCtrlKey,L as layerStack,M as access$1,N as src_default$1,O as isFunction,Q as showToast}from"./toast-4QDb3iM0.js";function makeEventListener(n,t,i,s){return n.addEventListener(t,i,s),tryOnCleanup(n.removeEventListener.bind(n,t,i,s))}function createEventListener(n,t,i,s){const Le=()=>{asArray(access(n)).forEach(Oe=>{Oe&&asArray(access(t)).forEach(Ae=>makeEventListener(Oe,Ae,i,s))})};typeof n=="function"?createEffect(Le):createRenderEffect(Le)}var FALLBACK=Symbol("fallback");function dispose(n){for(const t of n)t.dispose()}function keyArray(n,t,i,s={}){const Le=new Map;return onCleanup(()=>dispose(Le.values())),()=>{const Ae=n()||[];return Ae[$TRACK],untrack(()=>{if(!Ae.length)return dispose(Le.values()),Le.clear(),s.fallback?[createRoot(He=>(Le.set(FALLBACK,{dispose:He}),s.fallback()))]:[];const Ee=new Array(Ae.length),$e=Le.get(FALLBACK);if(!Le.size||$e){$e?.dispose(),Le.delete(FALLBACK);for(let Fe=0;Fe<Ae.length;Fe++){const He=Ae[Fe],ze=t(He,Fe);Oe(Ee,He,Fe,ze)}return Ee}const Ie=new Set(Le.keys());for(let Fe=0;Fe<Ae.length;Fe++){const He=Ae[Fe],ze=t(He,Fe);Ie.delete(ze);const je=Le.get(ze);je?(Ee[Fe]=je.mapped,je.setIndex?.(Fe),je.setItem(()=>He)):Oe(Ee,He,Fe,ze)}for(const Fe of Ie)Le.get(Fe)?.dispose(),Le.delete(Fe);return Ee})};function Oe(Ae,Ee,$e,Ie){createRoot(Fe=>{const[He,ze]=createSignal(Ee),je={setItem:ze,dispose:Fe};if(i.length>1){const[Ne,Ke]=createSignal($e);je.setIndex=Ke,je.mapped=i(He,Ne)}else je.mapped=i(He);Le.set(Ie,je),Ae[$e]=je.mapped})}}function Key(n){const{by:t}=n;return createMemo(keyArray(()=>n.each,typeof t=="function"?t:i=>i[t],n.children,"fallback"in n?{fallback:()=>n.fallback}:void 0))}var PositionType=(n=>(n[n.BUY=0]="BUY",n[n.SELL=1]="SELL",n))(PositionType||{});function closePositionProfitWithoutCommission(n){return positionProfitWithoutCommission(n,n.endPrice)}function positionProfitWithoutCommission(n,t){return n.type===0?(t-n.startPrice)*n.quantity:(n.startPrice-t)*n.quantity}class Broker{idSequence;marketData;initialBalance;currentBalance;commissionPercentage;openPositions;closedPositions;constructor(t,i,s){this.idSequence=1,this.marketData=t,this.initialBalance=i,this.currentBalance=i,this.commissionPercentage=s,this.openPositions=[],this.closedPositions=[]}baseByBalancePercentage(t){if(t<=0)return 0;const i=this.marketData.last(0);return this.currentBalance/i.close*t}marketBuy(t){if(t-Number.EPSILON<0)return;const i=this.marketData.last(0);i.close*t>this.currentBalance?console.warn("[BACKTESTING] Position value bigger than current balance"):this.openPosition(0,i.close,i.time,t)}marketSell(t){if(t-Number.EPSILON<0)return;const i=this.marketData.last(0);i.close*t>this.currentBalance?console.warn("[BACKTESTING] Position value bigger than current balance"):this.openPosition(1,i.close,i.time,t)}closeAll(){const t=this.marketData.last(0);this.closeAllPositions(t.close,t.time)}openPosition(t,i,s,Le){this.openPositions.push({id:this.idSequence,startDate:s,startPrice:i,quantity:Le,type:t});const Oe=i*Le;console.log("[OPEN]"+Oe),this.currentBalance-=Oe,this.idSequence+=1}closeAllPositions(t,i){for(let s of this.openPositions){const Le={id:s.id,startDate:s.startDate,startPrice:s.startPrice,quantity:s.quantity,type:s.type,endDate:i,endPrice:t};this.closedPositions.push(Le);const Oe=Le.startPrice*Le.quantity,Ae=closePositionProfitWithoutCommission(Le)+Oe;console.log("[CLOSE]"+Oe),this.currentBalance+=Ae}this.openPositions=[]}}class MarketData{index;baseSymbol;quoteSymbol;data;constructor(t,i="",s=""){this.index=0,this.data=t,this.baseSymbol=i,this.quoteSymbol=s}next(){return this.index>=this.data.length-1?!1:(this.index+=1,!0)}last(t){const i=this.index-t;return this.data[i]}}const EXAMPLE_STRATEGIES=[{label:"Simple buy",disabled:!1,strategy:`// Here you initialize 'context' with indicators and request data before strategy runs
window.initStrategy = () => {
	return {
		// use Indicators object to access some standard TA indicators
		// see 'https://github.com/debut-js/Indicators' to learn, how to use them
		sma: new Indicators.SMA(25) 
	}
}

// Here is the definition of your strategy
// All info about your account and marketData is kept in broker and all your defined indicators are in context
window.onTick = (broker, context) => {
    const currentCandle = broker.marketData.last(0); // get most recent candle
    const sma = context.sma; // retrieve your custom objects from context
    const smaValue = sma.nextValue(currentCandle.close); // calculate SMA value
    
    if (smaValue < 35000.0 && broker.openPositions.length === 0) { // open only 1 position
        const baseValue = broker.baseByBalancePercentage(0.10); // get quantity equal 10% of your available capital
        broker.marketBuy(baseValue); // buy using 10% of your capital
    } else if (smaValue > 56000.0) {
        broker.closeAll(); // close all positions
    }
}`},{label:"Simple sell",disabled:!1,strategy:`// Here you initialize 'context' with indicators and request data before strategy runs
window.initStrategy = () => {
	return {
		sma: new Indicators.SMA(25)
	}
}

// Here is the definition of your strategy
// All info about your account and marketData is kept in broker and all your defined indicators are in context
window.onTick = (broker, context) => {
    const currentCandle = broker.marketData.last(0); // get most recent candle
    const sma = context.sma; // retrieve your custom objects from context

    const smaValue = sma.nextValue(currentCandle.close); // calculate SMA value
    if (currentCandle.close > 60000.0) {
        broker.marketSell(0.1); // sell 0.1 quantity - e.g. for pair BTC-USD it's 0.1 BTC
    } else if (currentCandle.close < 30000.0) {
        broker.closeAll(); // close all positions
    }
}`}],DEFAULT_STRATEGY=EXAMPLE_STRATEGIES[0].strategy;function calculateCurrentTotalProfit(n){const t=n.marketData.last(0);let i=0;for(let s of n.openPositions)i+=s.startPrice*s.quantity+positionProfitWithoutCommission(s,t.close);return{time:t.time,value:n.currentBalance+i}}function runBacktesting(n,t){console.time("backtesting");const i=[],s=t.marketData,Le=n.initStrategy();do{n.onTick(t,Le);const Oe=calculateCurrentTotalProfit(t);i.push(Oe)}while(s.next());return t.closeAll(),console.timeEnd("backtesting"),{baseSymbol:s.baseSymbol,quoteSymbol:s.quoteSymbol,initialBalance:t.initialBalance,equity:t.currentBalance,commissionPercentage:t.commissionPercentage,openPositions:t.openPositions,closedPositions:t.closedPositions,equityTimeseries:i}}function size$2(n){var t=n.width,i=n.height;if(t<0)throw new Error("Negative width is not allowed for Size");if(i<0)throw new Error("Negative height is not allowed for Size");return{width:t,height:i}}function equalSizes(n,t){return n.width===t.width&&n.height===t.height}var Observable=function(){function n(t){var i=this;this._resolutionListener=function(){return i._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=t,this._installResolutionListener()}return n.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(n.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(t){var i=this,s={next:t};return this._observers.push(s),{unsubscribe:function(){i._observers=i._observers.filter(function(Le){return Le!==s})}}},n.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(t,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},n.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},n.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},n.prototype._onResolutionChanged=function(){var t=this;this._observers.forEach(function(i){return i.next(t._window.devicePixelRatio)}),this._reinstallResolutionListener()},n}();function createObservable(n){return new Observable(n)}var DevicePixelContentBoxBinding=function(){function n(t,i,s){var Le;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=t,this._canvasElementClientSize=size$2({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=i??function(Oe){return Oe},this._allowResizeObserver=(Le=s?.allowResizeObserver)!==null&&Le!==void 0?Le:!0,this._chooseAndInitObserver()}return n.prototype.dispose=function(){var t,i;if(this._canvasElement===null)throw new Error("Object is disposed");(t=this._canvasElementResizeObserver)===null||t===void 0||t.disconnect(),this._canvasElementResizeObserver=null,(i=this._devicePixelRatioObservable)===null||i===void 0||i.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(n.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bitmapSize",{get:function(){return size$2({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),n.prototype.resizeCanvasElement=function(t){this._canvasElementClientSize=size$2(t),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},n.prototype.subscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeBitmapSizeChanged=function(t){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(i){return i!==t})},Object.defineProperty(n.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),n.prototype.subscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners.push(t)},n.prototype.unsubscribeSuggestedBitmapSizeChanged=function(t){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(i){return i!==t})},n.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var t=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(t),this._emitSuggestedBitmapSizeChanged(t,this._suggestedBitmapSize)}},n.prototype._resizeBitmap=function(t){var i=this.bitmapSize;equalSizes(i,t)||(this.canvasElement.width=t.width,this.canvasElement.height=t.height,this._emitBitmapSizeChanged(i,t))},n.prototype._emitBitmapSizeChanged=function(t,i){var s=this;this._bitmapSizeChangedListeners.forEach(function(Le){return Le.call(s,t,i)})},n.prototype._suggestNewBitmapSize=function(t){var i=this._suggestedBitmapSize,s=size$2(this._transformBitmapSize(t,this._canvasElementClientSize)),Le=equalSizes(this.bitmapSize,s)?null:s;i===null&&Le===null||i!==null&&Le!==null&&equalSizes(i,Le)||(this._suggestedBitmapSize=Le,this._emitSuggestedBitmapSizeChanged(i,Le))},n.prototype._emitSuggestedBitmapSizeChanged=function(t,i){var s=this;this._suggestedBitmapSizeChangedListeners.forEach(function(Le){return Le.call(s,t,i)})},n.prototype._chooseAndInitObserver=function(){var t=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}isDevicePixelContentBoxSupported().then(function(i){return i?t._initResizeObserver():t._initDevicePixelRatioObservable()})},n.prototype._initDevicePixelRatioObservable=function(){var t=this;if(this._canvasElement!==null){var i=canvasElementWindow(this._canvasElement);if(i===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=createObservable(i),this._devicePixelRatioObservable.subscribe(function(){return t._invalidateBitmapSize()}),this._invalidateBitmapSize()}},n.prototype._invalidateBitmapSize=function(){var t,i;if(this._canvasElement!==null){var s=canvasElementWindow(this._canvasElement);if(s!==null){var Le=(i=(t=this._devicePixelRatioObservable)===null||t===void 0?void 0:t.value)!==null&&i!==void 0?i:s.devicePixelRatio,Oe=this._canvasElement.getClientRects(),Ae=Oe[0]!==void 0?predictedBitmapSize(Oe[0],Le):size$2({width:this._canvasElementClientSize.width*Le,height:this._canvasElementClientSize.height*Le});this._suggestNewBitmapSize(Ae)}}},n.prototype._initResizeObserver=function(){var t=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(i){var s=i.find(function(Ae){return Ae.target===t._canvasElement});if(!(!s||!s.devicePixelContentBoxSize||!s.devicePixelContentBoxSize[0])){var Le=s.devicePixelContentBoxSize[0],Oe=size$2({width:Le.inlineSize,height:Le.blockSize});t._suggestNewBitmapSize(Oe)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},n}();function bindTo(n,t){if(t.type==="device-pixel-content-box")return new DevicePixelContentBoxBinding(n,t.transform,t.options);throw new Error("Unsupported binding target")}function canvasElementWindow(n){return n.ownerDocument.defaultView}function isDevicePixelContentBoxSupported(){return new Promise(function(n){var t=new ResizeObserver(function(i){n(i.every(function(s){return"devicePixelContentBoxSize"in s})),t.disconnect()});t.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function predictedBitmapSize(n,t){return size$2({width:Math.round(n.left*t+n.width*t)-Math.round(n.left*t),height:Math.round(n.top*t+n.height*t)-Math.round(n.top*t)})}var CanvasRenderingTarget2D=function(){function n(t,i,s){if(i.width===0||i.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=i,s.width===0||s.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=s,this._context=t}return n.prototype.useMediaCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),t({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},n.prototype.useBitmapCoordinateSpace=function(t){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),t({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(n.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),n}();function tryCreateCanvasRenderingTarget2D(n,t){var i=n.canvasElementClientSize;if(i.width===0||i.height===0)return null;var s=n.bitmapSize;if(s.width===0||s.height===0)return null;var Le=n.canvasElement.getContext("2d",t);return Le===null?null:new CanvasRenderingTarget2D(Le,i,s)}/*!
 * @license
 * TradingView Lightweight Charts™ v4.2.0
 * Copyright (c) 2024 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const e={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},r={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},h={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},l={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},a={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},o={color:"#26a69a",base:0},_={color:"#2196f3"},u={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var c,d;function f(n,t){const i={0:[],1:[n.lineWidth,n.lineWidth],2:[2*n.lineWidth,2*n.lineWidth],3:[6*n.lineWidth,6*n.lineWidth],4:[n.lineWidth,4*n.lineWidth]}[t];n.setLineDash(i)}function v(n,t,i,s){n.beginPath();const Le=n.lineWidth%2?.5:0;n.moveTo(i,t+Le),n.lineTo(s,t+Le),n.stroke()}function p(n,t){if(!n)throw new Error("Assertion failed"+(t?": "+t:""))}function m(n){if(n===void 0)throw new Error("Value is undefined");return n}function b(n){if(n===null)throw new Error("Value is null");return n}function w(n){return b(m(n))}(function(n){n[n.Simple=0]="Simple",n[n.WithSteps=1]="WithSteps",n[n.Curved=2]="Curved"})(c||(c={})),function(n){n[n.Solid=0]="Solid",n[n.Dotted=1]="Dotted",n[n.Dashed=2]="Dashed",n[n.LargeDashed=3]="LargeDashed",n[n.SparseDotted=4]="SparseDotted"}(d||(d={}));const g={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function M(n){return n<0?0:n>255?255:Math.round(n)||0}function x(n){return n<=0||n>1?Math.min(Math.max(n,0),1):Math.round(1e4*n)/1e4}const S=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,k=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,y=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,C=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d*\.?\d+)\s*\)$/;function T(n){(n=n.toLowerCase())in g&&(n=g[n]);{const t=C.exec(n)||y.exec(n);if(t)return[M(parseInt(t[1],10)),M(parseInt(t[2],10)),M(parseInt(t[3],10)),x(t.length<5?1:parseFloat(t[4]))]}{const t=k.exec(n);if(t)return[M(parseInt(t[1],16)),M(parseInt(t[2],16)),M(parseInt(t[3],16)),1]}{const t=S.exec(n);if(t)return[M(17*parseInt(t[1],16)),M(17*parseInt(t[2],16)),M(17*parseInt(t[3],16)),1]}throw new Error(`Cannot parse color: ${n}`)}function P(n){return .199*n[0]+.687*n[1]+.114*n[2]}function R(n){const t=T(n);return{t:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,i:P(t)>160?"black":"white"}}class D{constructor(){this.h=[]}l(t,i,s){const Le={o:t,_:i,u:s===!0};this.h.push(Le)}v(t){const i=this.h.findIndex(s=>t===s.o);i>-1&&this.h.splice(i,1)}p(t){this.h=this.h.filter(i=>i._!==t)}m(t,i,s){const Le=[...this.h];this.h=this.h.filter(Oe=>!Oe.u),Le.forEach(Oe=>Oe.o(t,i,s))}M(){return this.h.length>0}S(){this.h=[]}}function V(n,...t){for(const i of t)for(const s in i)i[s]!==void 0&&(typeof i[s]!="object"||n[s]===void 0||Array.isArray(i[s])?n[s]=i[s]:V(n[s],i[s]));return n}function O(n){return typeof n=="number"&&isFinite(n)}function B(n){return typeof n=="number"&&n%1==0}function A(n){return typeof n=="string"}function I(n){return typeof n=="boolean"}function z(n){const t=n;if(!t||typeof t!="object")return t;let i,s,Le;for(s in i=Array.isArray(t)?[]:{},t)t.hasOwnProperty(s)&&(Le=t[s],i[s]=Le&&typeof Le=="object"?z(Le):Le);return i}function L(n){return n!==null}function E(n){return n===null?void 0:n}const N="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function F(n,t,i){return t===void 0&&(t=N),`${i=i!==void 0?`${i} `:""}${n}px ${t}`}class W{constructor(t){this.k={C:1,T:5,P:NaN,R:"",D:"",V:"",O:"",B:0,A:0,I:0,L:0,N:0},this.F=t}W(){const t=this.k,i=this.j(),s=this.H();return t.P===i&&t.D===s||(t.P=i,t.D=s,t.R=F(i,s),t.L=2.5/12*i,t.B=t.L,t.A=i/12*t.T,t.I=i/12*t.T,t.N=0),t.V=this.$(),t.O=this.U(),this.k}$(){return this.F.W().layout.textColor}U(){return this.F.q()}j(){return this.F.W().layout.fontSize}H(){return this.F.W().layout.fontFamily}}class j{constructor(){this.Y=[]}Z(t){this.Y=t}X(t,i,s){this.Y.forEach(Le=>{Le.X(t,i,s)})}}class H{X(t,i,s){t.useBitmapCoordinateSpace(Le=>this.K(Le,i,s))}}class $ extends H{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.G===null||this.G.tt===null)return;const Le=this.G.tt,Oe=this.G,Ae=Math.max(1,Math.floor(i))%2/2,Ee=$e=>{t.beginPath();for(let Ie=Le.to-1;Ie>=Le.from;--Ie){const Fe=Oe.it[Ie],He=Math.round(Fe.nt*i)+Ae,ze=Fe.st*s,je=$e*s+Ae;t.moveTo(He,ze),t.arc(He,ze,je,0,2*Math.PI)}t.fill()};Oe.et>0&&(t.fillStyle=Oe.rt,Ee(Oe.ht+Oe.et)),t.fillStyle=Oe.lt,Ee(Oe.ht)}}function U(){return{it:[{nt:0,st:0,ot:0,_t:0}],lt:"",rt:"",ht:0,et:0,tt:null}}const q={from:0,to:1};class Y{constructor(t,i){this.ut=new j,this.ct=[],this.dt=[],this.ft=!0,this.F=t,this.vt=i,this.ut.Z(this.ct)}bt(t){const i=this.F.wt();i.length!==this.ct.length&&(this.dt=i.map(U),this.ct=this.dt.map(s=>{const Le=new $;return Le.J(s),Le}),this.ut.Z(this.ct)),this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.ut}Mt(){const t=this.vt.W().mode===2,i=this.F.wt(),s=this.vt.xt(),Le=this.F.St();i.forEach((Oe,Ae)=>{var Ee;const $e=this.dt[Ae],Ie=Oe.kt(s);if(t||Ie===null||!Oe.yt())return void($e.tt=null);const Fe=b(Oe.Ct());$e.lt=Ie.Tt,$e.ht=Ie.ht,$e.et=Ie.Pt,$e.it[0]._t=Ie._t,$e.it[0].st=Oe.Dt().Rt(Ie._t,Fe.Vt),$e.rt=(Ee=Ie.Ot)!==null&&Ee!==void 0?Ee:this.F.Bt($e.it[0].st/Oe.Dt().At()),$e.it[0].ot=s,$e.it[0].nt=Le.It(s),$e.tt=q})}}class Z extends H{constructor(t){super(),this.zt=t}K({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:Le}){if(this.zt===null)return;const Oe=this.zt.Lt.yt,Ae=this.zt.Et.yt;if(!Oe&&!Ae)return;const Ee=Math.round(this.zt.nt*s),$e=Math.round(this.zt.st*Le);t.lineCap="butt",Oe&&Ee>=0&&(t.lineWidth=Math.floor(this.zt.Lt.et*s),t.strokeStyle=this.zt.Lt.V,t.fillStyle=this.zt.Lt.V,f(t,this.zt.Lt.Nt),function(Ie,Fe,He,ze){Ie.beginPath();const je=Ie.lineWidth%2?.5:0;Ie.moveTo(Fe+je,He),Ie.lineTo(Fe+je,ze),Ie.stroke()}(t,Ee,0,i.height)),Ae&&$e>=0&&(t.lineWidth=Math.floor(this.zt.Et.et*Le),t.strokeStyle=this.zt.Et.V,t.fillStyle=this.zt.Et.V,f(t,this.zt.Et.Nt),v(t,$e,0,i.width))}}class X{constructor(t){this.ft=!0,this.Ft={Lt:{et:1,Nt:0,V:"",yt:!1},Et:{et:1,Nt:0,V:"",yt:!1},nt:0,st:0},this.Wt=new Z(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.yt(),i=b(this.jt.Ht()),s=i.$t().W().crosshair,Le=this.Ft;if(s.mode===2)return Le.Et.yt=!1,void(Le.Lt.yt=!1);Le.Et.yt=t&&this.jt.Ut(i),Le.Lt.yt=t&&this.jt.qt(),Le.Et.et=s.horzLine.width,Le.Et.Nt=s.horzLine.style,Le.Et.V=s.horzLine.color,Le.Lt.et=s.vertLine.width,Le.Lt.Nt=s.vertLine.style,Le.Lt.V=s.vertLine.color,Le.nt=this.jt.Yt(),Le.st=this.jt.Zt()}}function K(n,t,i,s,Le,Oe){n.fillRect(t+Oe,i,s-2*Oe,Oe),n.fillRect(t+Oe,i+Le-Oe,s-2*Oe,Oe),n.fillRect(t,i,Oe,Le),n.fillRect(t+s-Oe,i,Oe,Le)}function G(n,t,i,s,Le,Oe){n.save(),n.globalCompositeOperation="copy",n.fillStyle=Oe,n.fillRect(t,i,s,Le),n.restore()}function J(n,t,i,s,Le,Oe){n.beginPath(),n.roundRect?n.roundRect(t,i,s,Le,Oe):(n.lineTo(t+s-Oe[1],i),Oe[1]!==0&&n.arcTo(t+s,i,t+s,i+Oe[1],Oe[1]),n.lineTo(t+s,i+Le-Oe[2]),Oe[2]!==0&&n.arcTo(t+s,i+Le,t+s-Oe[2],i+Le,Oe[2]),n.lineTo(t+Oe[3],i+Le),Oe[3]!==0&&n.arcTo(t,i+Le,t,i+Le-Oe[3],Oe[3]),n.lineTo(t,i+Oe[0]),Oe[0]!==0&&n.arcTo(t,i,t+Oe[0],i,Oe[0]))}function Q(n,t,i,s,Le,Oe,Ae=0,Ee=[0,0,0,0],$e=""){if(n.save(),!Ae||!$e||$e===Oe)return J(n,t,i,s,Le,Ee),n.fillStyle=Oe,n.fill(),void n.restore();const Ie=Ae/2;var Fe;J(n,t+Ie,i+Ie,s-Ae,Le-Ae,(Fe=-Ie,Ee.map(He=>He===0?He:He+Fe))),Oe!=="transparent"&&(n.fillStyle=Oe,n.fill()),$e!=="transparent"&&(n.lineWidth=Ae,n.strokeStyle=$e,n.closePath(),n.stroke()),n.restore()}function tt(n,t,i,s,Le,Oe,Ae){n.save(),n.globalCompositeOperation="copy";const Ee=n.createLinearGradient(0,0,0,Le);Ee.addColorStop(0,Oe),Ee.addColorStop(1,Ae),n.fillStyle=Ee,n.fillRect(t,i,s,Le),n.restore()}class it{constructor(t,i){this.J(t,i)}J(t,i){this.zt=t,this.Xt=i}At(t,i){return this.zt.yt?t.P+t.L+t.B:0}X(t,i,s,Le){if(!this.zt.yt||this.zt.Kt.length===0)return;const Oe=this.zt.V,Ae=this.Xt.t,Ee=t.useBitmapCoordinateSpace($e=>{const Ie=$e.context;Ie.font=i.R;const Fe=this.Gt($e,i,s,Le),He=Fe.Jt,ze=(je,Ne)=>{Fe.Qt?Q(Ie,He.ti,He.ii,He.ni,He.si,je,He.ei,[He.ht,0,0,He.ht],Ne):Q(Ie,He.ri,He.ii,He.ni,He.si,je,He.ei,[0,He.ht,He.ht,0],Ne)};return ze(Ae,"transparent"),this.zt.hi&&(Ie.fillStyle=Oe,Ie.fillRect(He.ri,He.li,He.ai-He.ri,He.oi)),ze("transparent",Ae),this.zt._i&&(Ie.fillStyle=i.O,Ie.fillRect(Fe.Qt?He.ui-He.ei:0,He.ii,He.ei,He.ci-He.ii)),Fe});t.useMediaCoordinateSpace(({context:$e})=>{const Ie=Ee.di;$e.font=i.R,$e.textAlign=Ee.Qt?"right":"left",$e.textBaseline="middle",$e.fillStyle=Oe,$e.fillText(this.zt.Kt,Ie.fi,(Ie.ii+Ie.ci)/2+Ie.pi)})}Gt(t,i,s,Le){var Oe;const{context:Ae,bitmapSize:Ee,mediaSize:$e,horizontalPixelRatio:Ie,verticalPixelRatio:Fe}=t,He=this.zt.hi||!this.zt.mi?i.T:0,ze=this.zt.bi?i.C:0,je=i.L+this.Xt.wi,Ne=i.B+this.Xt.gi,Ke=i.A,Be=i.I,Ue=this.zt.Kt,We=i.P,Ge=s.Mi(Ae,Ue),qe=Math.ceil(s.xi(Ae,Ue)),Xe=We+je+Ne,Je=i.C+Ke+Be+qe+He,Ze=Math.max(1,Math.floor(Fe));let Ye=Math.round(Xe*Fe);Ye%2!=Ze%2&&(Ye+=1);const eo=ze>0?Math.max(1,Math.floor(ze*Ie)):0,Qe=Math.round(Je*Ie),io=Math.round(He*Ie),so=(Oe=this.Xt.Si)!==null&&Oe!==void 0?Oe:this.Xt.ki,uo=Math.round(so*Fe)-Math.floor(.5*Fe),no=Math.floor(uo+Ze/2-Ye/2),ho=no+Ye,lo=Le==="right",ao=lo?$e.width-ze:ze,oo=lo?Ee.width-eo:eo;let co,fo,mo;return lo?(co=oo-Qe,fo=oo-io,mo=ao-He-Ke-ze):(co=oo+Qe,fo=oo+io,mo=ao+He+Ke),{Qt:lo,Jt:{ii:no,li:uo,ci:ho,ni:Qe,si:Ye,ht:2*Ie,ei:eo,ti:co,ri:oo,ai:fo,oi:Ze,ui:Ee.width},di:{ii:no/Fe,ci:ho/Fe,fi:mo,pi:Ge}}}}class nt{constructor(t){this.yi={ki:0,t:"#000",gi:0,wi:0},this.Ci={Kt:"",yt:!1,hi:!0,mi:!1,Ot:"",V:"#FFF",_i:!1,bi:!1},this.Ti={Kt:"",yt:!1,hi:!1,mi:!0,Ot:"",V:"#FFF",_i:!0,bi:!0},this.ft=!0,this.Pi=new(t||it)(this.Ci,this.yi),this.Ri=new(t||it)(this.Ti,this.yi)}Kt(){return this.Di(),this.Ci.Kt}ki(){return this.Di(),this.yi.ki}bt(){this.ft=!0}At(t,i=!1){return Math.max(this.Pi.At(t,i),this.Ri.At(t,i))}Vi(){return this.yi.Si||0}Oi(t){this.yi.Si=t}Bi(){return this.Di(),this.Ci.yt||this.Ti.yt}Ai(){return this.Di(),this.Ci.yt}gt(t){return this.Di(),this.Ci.hi=this.Ci.hi&&t.W().ticksVisible,this.Ti.hi=this.Ti.hi&&t.W().ticksVisible,this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Pi}Ii(){return this.Di(),this.Pi.J(this.Ci,this.yi),this.Ri.J(this.Ti,this.yi),this.Ri}Di(){this.ft&&(this.Ci.hi=!0,this.Ti.hi=!1,this.zi(this.Ci,this.Ti,this.yi))}}class st extends nt{constructor(t,i,s){super(),this.jt=t,this.Li=i,this.Ei=s}zi(t,i,s){if(t.yt=!1,this.jt.W().mode===2)return;const Le=this.jt.W().horzLine;if(!Le.labelVisible)return;const Oe=this.Li.Ct();if(!this.jt.yt()||this.Li.Ni()||Oe===null)return;const Ae=R(Le.labelBackgroundColor);s.t=Ae.t,t.V=Ae.i;const Ee=2/12*this.Li.P();s.wi=Ee,s.gi=Ee;const $e=this.Ei(this.Li);s.ki=$e.ki,t.Kt=this.Li.Fi($e._t,Oe),t.yt=!0}}const et=/[1-9]/g;class rt{constructor(){this.zt=null}J(t){this.zt=t}X(t,i){if(this.zt===null||this.zt.yt===!1||this.zt.Kt.length===0)return;const s=t.useMediaCoordinateSpace(({context:ze})=>(ze.font=i.R,Math.round(i.Wi.xi(ze,b(this.zt).Kt,et))));if(s<=0)return;const Le=i.ji,Oe=s+2*Le,Ae=Oe/2,Ee=this.zt.Hi;let $e=this.zt.ki,Ie=Math.floor($e-Ae)+.5;Ie<0?($e+=Math.abs(0-Ie),Ie=Math.floor($e-Ae)+.5):Ie+Oe>Ee&&($e-=Math.abs(Ee-(Ie+Oe)),Ie=Math.floor($e-Ae)+.5);const Fe=Ie+Oe,He=Math.ceil(0+i.C+i.T+i.L+i.P+i.B);t.useBitmapCoordinateSpace(({context:ze,horizontalPixelRatio:je,verticalPixelRatio:Ne})=>{const Ke=b(this.zt);ze.fillStyle=Ke.t;const Be=Math.round(Ie*je),Ue=Math.round(0*Ne),We=Math.round(Fe*je),Ge=Math.round(He*Ne),qe=Math.round(2*je);if(ze.beginPath(),ze.moveTo(Be,Ue),ze.lineTo(Be,Ge-qe),ze.arcTo(Be,Ge,Be+qe,Ge,qe),ze.lineTo(We-qe,Ge),ze.arcTo(We,Ge,We,Ge-qe,qe),ze.lineTo(We,Ue),ze.fill(),Ke.hi){const Xe=Math.round(Ke.ki*je),Je=Ue,Ze=Math.round((Je+i.T)*Ne);ze.fillStyle=Ke.V;const Ye=Math.max(1,Math.floor(je)),eo=Math.floor(.5*je);ze.fillRect(Xe-eo,Je,Ye,Ze-Je)}}),t.useMediaCoordinateSpace(({context:ze})=>{const je=b(this.zt),Ne=0+i.C+i.T+i.L+i.P/2;ze.font=i.R,ze.textAlign="left",ze.textBaseline="middle",ze.fillStyle=je.V;const Ke=i.Wi.Mi(ze,"Apr0");ze.translate(Ie+Le,Ne+Ke),ze.fillText(je.Kt,0,0)})}}class ht{constructor(t,i,s){this.ft=!0,this.Wt=new rt,this.Ft={yt:!1,t:"#4c525e",V:"white",Kt:"",Hi:0,ki:NaN,hi:!0},this.vt=t,this.$i=i,this.Ei=s}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt.J(this.Ft),this.Wt}Mt(){const t=this.Ft;if(t.yt=!1,this.vt.W().mode===2)return;const i=this.vt.W().vertLine;if(!i.labelVisible)return;const s=this.$i.St();if(s.Ni())return;t.Hi=s.Hi();const Le=this.Ei();if(Le===null)return;t.ki=Le.ki;const Oe=s.Ui(this.vt.xt());t.Kt=s.qi(b(Oe)),t.yt=!0;const Ae=R(i.labelBackgroundColor);t.t=Ae.t,t.V=Ae.i,t.hi=s.W().ticksVisible}}class lt{constructor(){this.Yi=null,this.Zi=0}Xi(){return this.Zi}Ki(t){this.Zi=t}Dt(){return this.Yi}Gi(t){this.Yi=t}Ji(t){return[]}Qi(){return[]}yt(){return!0}}var at;(function(n){n[n.Normal=0]="Normal",n[n.Magnet=1]="Magnet",n[n.Hidden=2]="Hidden"})(at||(at={}));class ot extends lt{constructor(t,i){super(),this.tn=null,this.nn=NaN,this.sn=0,this.en=!0,this.rn=new Map,this.hn=!1,this.ln=NaN,this.an=NaN,this._n=NaN,this.un=NaN,this.$i=t,this.cn=i,this.dn=new Y(t,this),this.fn=((Le,Oe)=>Ae=>{const Ee=Oe(),$e=Le();if(Ae===b(this.tn).vn())return{_t:$e,ki:Ee};{const Ie=b(Ae.Ct());return{_t:Ae.pn(Ee,Ie),ki:Ee}}})(()=>this.nn,()=>this.an);const s=((Le,Oe)=>()=>{const Ae=this.$i.St().mn(Le()),Ee=Oe();return Ae&&Number.isFinite(Ee)?{ot:Ae,ki:Ee}:null})(()=>this.sn,()=>this.Yt());this.bn=new ht(this,t,s),this.wn=new X(this)}W(){return this.cn}gn(t,i){this._n=t,this.un=i}Mn(){this._n=NaN,this.un=NaN}xn(){return this._n}Sn(){return this.un}kn(t,i,s){this.hn||(this.hn=!0),this.en=!0,this.yn(t,i,s)}xt(){return this.sn}Yt(){return this.ln}Zt(){return this.an}yt(){return this.en}Cn(){this.en=!1,this.Tn(),this.nn=NaN,this.ln=NaN,this.an=NaN,this.tn=null,this.Mn()}Pn(t){return this.tn!==null?[this.wn,this.dn]:[]}Ut(t){return t===this.tn&&this.cn.horzLine.visible}qt(){return this.cn.vertLine.visible}Rn(t,i){this.en&&this.tn===t||this.rn.clear();const s=[];return this.tn===t&&s.push(this.Dn(this.rn,i,this.fn)),s}Qi(){return this.en?[this.bn]:[]}Ht(){return this.tn}Vn(){this.wn.bt(),this.rn.forEach(t=>t.bt()),this.bn.bt(),this.dn.bt()}On(t){return t&&!t.vn().Ni()?t.vn():null}yn(t,i,s){this.Bn(t,i,s)&&this.Vn()}Bn(t,i,s){const Le=this.ln,Oe=this.an,Ae=this.nn,Ee=this.sn,$e=this.tn,Ie=this.On(s);this.sn=t,this.ln=isNaN(t)?NaN:this.$i.St().It(t),this.tn=s;const Fe=Ie!==null?Ie.Ct():null;return Ie!==null&&Fe!==null?(this.nn=i,this.an=Ie.Rt(i,Fe)):(this.nn=NaN,this.an=NaN),Le!==this.ln||Oe!==this.an||Ee!==this.sn||Ae!==this.nn||$e!==this.tn}Tn(){const t=this.$i.wt().map(s=>s.In().An()).filter(L),i=t.length===0?null:Math.max(...t);this.sn=i!==null?i:NaN}Dn(t,i,s){let Le=t.get(i);return Le===void 0&&(Le=new st(this,i,s),t.set(i,Le)),Le}}function _t(n){return n==="left"||n==="right"}class ut{constructor(t){this.zn=new Map,this.Ln=[],this.En=t}Nn(t,i){const s=function(Le,Oe){return Le===void 0?Oe:{Fn:Math.max(Le.Fn,Oe.Fn),Wn:Le.Wn||Oe.Wn}}(this.zn.get(t),i);this.zn.set(t,s)}jn(){return this.En}Hn(t){const i=this.zn.get(t);return i===void 0?{Fn:this.En}:{Fn:Math.max(this.En,i.Fn),Wn:i.Wn}}$n(){this.Un(),this.Ln=[{qn:0}]}Yn(t){this.Un(),this.Ln=[{qn:1,Vt:t}]}Zn(t){this.Xn(),this.Ln.push({qn:5,Vt:t})}Un(){this.Xn(),this.Ln.push({qn:6})}Kn(){this.Un(),this.Ln=[{qn:4}]}Gn(t){this.Un(),this.Ln.push({qn:2,Vt:t})}Jn(t){this.Un(),this.Ln.push({qn:3,Vt:t})}Qn(){return this.Ln}ts(t){for(const i of t.Ln)this.ns(i);this.En=Math.max(this.En,t.En),t.zn.forEach((i,s)=>{this.Nn(s,i)})}static ss(){return new ut(2)}static es(){return new ut(3)}ns(t){switch(t.qn){case 0:this.$n();break;case 1:this.Yn(t.Vt);break;case 2:this.Gn(t.Vt);break;case 3:this.Jn(t.Vt);break;case 4:this.Kn();break;case 5:this.Zn(t.Vt);break;case 6:this.Xn()}}Xn(){const t=this.Ln.findIndex(i=>i.qn===5);t!==-1&&this.Ln.splice(t,1)}}const ct=".";function dt(n,t){if(!O(n))return"n/a";if(!B(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?n.toString():("0000000000000000"+n.toString()).slice(-t)}class ft{constructor(t,i){if(i||(i=1),O(t)&&B(t)||(t=100),t<0)throw new TypeError("invalid base");this.Li=t,this.rs=i,this.hs()}format(t){const i=t<0?"−":"";return t=Math.abs(t),i+this.ls(t)}hs(){if(this.os=0,this.Li>0&&this.rs>0){let t=this.Li;for(;t>1;)t/=10,this.os++}}ls(t){const i=this.Li/this.rs;let s=Math.floor(t),Le="";const Oe=this.os!==void 0?this.os:NaN;if(i>1){let Ae=+(Math.round(t*i)-s*i).toFixed(this.os);Ae>=i&&(Ae-=i,s+=1),Le=ct+dt(+Ae.toFixed(this.os)*this.rs,Oe)}else s=Math.round(s*i)/i,Oe>0&&(Le=ct+dt(0,Oe));return s.toFixed(0)+Le}}class vt extends ft{constructor(t=100){super(t)}format(t){return`${super.format(t)}%`}}class pt{constructor(t){this._s=t}format(t){let i="";return t<0&&(i="-",t=-t),t<995?i+this.us(t):t<999995?i+this.us(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),i+this.us(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),i+this.us(t/1e9)+"B")}us(t){let i;const s=Math.pow(10,this._s);return i=(t=Math.round(t*s)/s)>=1e-15&&t<1?t.toFixed(this._s).replace(/\.?0+$/,""):String(t),i.replace(/(\.[1-9]*)0+$/,(Le,Oe)=>Oe)}}function mt(n,t,i,s,Le,Oe,Ae){if(t.length===0||s.from>=t.length||s.to<=0)return;const{context:Ee,horizontalPixelRatio:$e,verticalPixelRatio:Ie}=n,Fe=t[s.from];let He=Oe(n,Fe),ze=Fe;if(s.to-s.from<2){const je=Le/2;Ee.beginPath();const Ne={nt:Fe.nt-je,st:Fe.st},Ke={nt:Fe.nt+je,st:Fe.st};Ee.moveTo(Ne.nt*$e,Ne.st*Ie),Ee.lineTo(Ke.nt*$e,Ke.st*Ie),Ae(n,He,Ne,Ke)}else{const je=(Ke,Be)=>{Ae(n,He,ze,Be),Ee.beginPath(),He=Ke,ze=Be};let Ne=ze;Ee.beginPath(),Ee.moveTo(Fe.nt*$e,Fe.st*Ie);for(let Ke=s.from+1;Ke<s.to;++Ke){Ne=t[Ke];const Be=Oe(n,Ne);switch(i){case 0:Ee.lineTo(Ne.nt*$e,Ne.st*Ie);break;case 1:Ee.lineTo(Ne.nt*$e,t[Ke-1].st*Ie),Be!==He&&(je(Be,Ne),Ee.lineTo(Ne.nt*$e,t[Ke-1].st*Ie)),Ee.lineTo(Ne.nt*$e,Ne.st*Ie);break;case 2:{const[Ue,We]=Mt(t,Ke-1,Ke);Ee.bezierCurveTo(Ue.nt*$e,Ue.st*Ie,We.nt*$e,We.st*Ie,Ne.nt*$e,Ne.st*Ie);break}}i!==1&&Be!==He&&(je(Be,Ne),Ee.moveTo(Ne.nt*$e,Ne.st*Ie))}(ze!==Ne||ze===Ne&&i===1)&&Ae(n,He,ze,Ne)}}const bt=6;function wt(n,t){return{nt:n.nt-t.nt,st:n.st-t.st}}function gt(n,t){return{nt:n.nt/t,st:n.st/t}}function Mt(n,t,i){const s=Math.max(0,t-1),Le=Math.min(n.length-1,i+1);var Oe,Ae;return[(Oe=n[t],Ae=gt(wt(n[i],n[s]),bt),{nt:Oe.nt+Ae.nt,st:Oe.st+Ae.st}),wt(n[i],gt(wt(n[Le],n[t]),bt))]}function xt(n,t,i,s,Le){const{context:Oe,horizontalPixelRatio:Ae,verticalPixelRatio:Ee}=t;Oe.lineTo(Le.nt*Ae,n*Ee),Oe.lineTo(s.nt*Ae,n*Ee),Oe.closePath(),Oe.fillStyle=i,Oe.fill()}class St extends H{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){var i;if(this.G===null)return;const{it:s,tt:Le,cs:Oe,et:Ae,Nt:Ee,ds:$e}=this.G,Ie=(i=this.G.fs)!==null&&i!==void 0?i:this.G.vs?0:t.mediaSize.height;if(Le===null)return;const Fe=t.context;Fe.lineCap="butt",Fe.lineJoin="round",Fe.lineWidth=Ae,f(Fe,Ee),Fe.lineWidth=1,mt(t,s,$e,Le,Oe,this.ps.bind(this),xt.bind(null,Ie))}}function kt(n,t,i){return Math.min(Math.max(n,t),i)}function yt(n,t,i){return t-n<=i}function Ct(n){const t=Math.ceil(n);return t%2==0?t-1:t}class Tt{bs(t,i){const s=this.ws,{gs:Le,Ms:Oe,xs:Ae,Ss:Ee,ks:$e,fs:Ie}=i;if(this.ys===void 0||s===void 0||s.gs!==Le||s.Ms!==Oe||s.xs!==Ae||s.Ss!==Ee||s.fs!==Ie||s.ks!==$e){const Fe=t.context.createLinearGradient(0,0,0,$e);if(Fe.addColorStop(0,Le),Ie!=null){const He=kt(Ie*t.verticalPixelRatio/$e,0,1);Fe.addColorStop(He,Oe),Fe.addColorStop(He,Ae)}Fe.addColorStop(1,Ee),this.ys=Fe,this.ws=i}return this.ys}}class Pt extends St{constructor(){super(...arguments),this.Cs=new Tt}ps(t,i){return this.Cs.bs(t,{gs:i.Ts,Ms:"",xs:"",Ss:i.Ps,ks:t.bitmapSize.height})}}function Rt(n,t){const i=n.context;i.strokeStyle=t,i.stroke()}class Dt extends H{constructor(){super(...arguments),this.G=null}J(t){this.G=t}K(t){if(this.G===null)return;const{it:i,tt:s,cs:Le,ds:Oe,et:Ae,Nt:Ee,Rs:$e}=this.G;if(s===null)return;const Ie=t.context;Ie.lineCap="butt",Ie.lineWidth=Ae*t.verticalPixelRatio,f(Ie,Ee),Ie.lineJoin="round";const Fe=this.Ds.bind(this);Oe!==void 0&&mt(t,i,Oe,s,Le,Fe,Rt),$e&&function(He,ze,je,Ne,Ke){const{horizontalPixelRatio:Be,verticalPixelRatio:Ue,context:We}=He;let Ge=null;const qe=Math.max(1,Math.floor(Be))%2/2,Xe=je*Ue+qe;for(let Je=Ne.to-1;Je>=Ne.from;--Je){const Ze=ze[Je];if(Ze){const Ye=Ke(He,Ze);Ye!==Ge&&(We.beginPath(),Ge!==null&&We.fill(),We.fillStyle=Ye,Ge=Ye);const eo=Math.round(Ze.nt*Be)+qe,Qe=Ze.st*Ue;We.moveTo(eo,Qe),We.arc(eo,Qe,Xe,0,2*Math.PI)}}We.fill()}(t,i,$e,s,Fe)}}class Vt extends Dt{Ds(t,i){return i.lt}}function Ot(n,t,i,s,Le=0,Oe=t.length){let Ae=Oe-Le;for(;0<Ae;){const Ee=Ae>>1,$e=Le+Ee;s(t[$e],i)===n?(Le=$e+1,Ae-=Ee+1):Ae=Ee}return Le}const Bt=Ot.bind(null,!0),At=Ot.bind(null,!1);function It(n,t){return n.ot<t}function zt(n,t){return t<n.ot}function Lt(n,t,i){const s=t.Vs(),Le=t.ui(),Oe=Bt(n,s,It),Ae=At(n,Le,zt);if(!i)return{from:Oe,to:Ae};let Ee=Oe,$e=Ae;return Oe>0&&Oe<n.length&&n[Oe].ot>=s&&(Ee=Oe-1),Ae>0&&Ae<n.length&&n[Ae-1].ot<=Le&&($e=Ae+1),{from:Ee,to:$e}}class Et{constructor(t,i,s){this.Os=!0,this.Bs=!0,this.As=!0,this.Is=[],this.zs=null,this.Ls=t,this.Es=i,this.Ns=s}bt(t){this.Os=!0,t==="data"&&(this.Bs=!0),t==="options"&&(this.As=!0)}gt(){return this.Ls.yt()?(this.Fs(),this.zs===null?null:this.Ws):null}js(){this.Is=this.Is.map(t=>Object.assign(Object.assign({},t),this.Ls.$s().Hs(t.ot)))}Us(){this.zs=null}Fs(){this.Bs&&(this.qs(),this.Bs=!1),this.As&&(this.js(),this.As=!1),this.Os&&(this.Ys(),this.Os=!1)}Ys(){const t=this.Ls.Dt(),i=this.Es.St();if(this.Us(),i.Ni()||t.Ni())return;const s=i.Zs();if(s===null||this.Ls.In().Xs()===0)return;const Le=this.Ls.Ct();Le!==null&&(this.zs=Lt(this.Is,s,this.Ns),this.Ks(t,i,Le.Vt),this.Gs())}}class Nt extends Et{constructor(t,i){super(t,i,!0)}Ks(t,i,s){i.Js(this.Is,E(this.zs)),t.Qs(this.Is,s,E(this.zs))}te(t,i){return{ot:t,_t:i,nt:NaN,st:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(i=>{const s=i.Vt[3];return this.ne(i.se,s,t)})}}class Ft extends Nt{constructor(t,i){super(t,i),this.Ws=new j,this.ee=new Pt,this.re=new Vt,this.Ws.Z([this.ee,this.re])}ne(t,i,s){return Object.assign(Object.assign({},this.te(t,i)),s.Hs(t))}Gs(){const t=this.Ls.W();this.ee.J({ds:t.lineType,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,fs:null,vs:t.invertFilledArea,tt:this.zs,cs:this.Es.St().he()}),this.re.J({ds:t.lineVisible?t.lineType:void 0,it:this.Is,Nt:t.lineStyle,et:t.lineWidth,tt:this.zs,cs:this.Es.St().he(),Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0})}}class Wt extends H{constructor(){super(...arguments),this.zt=null,this.le=0,this.ae=0}J(t){this.zt=t}K({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;this.le=this.oe(i),this.le>=2&&Math.max(1,Math.floor(i))%2!=this.le%2&&this.le--,this.ae=this.zt._e?Math.min(this.le,Math.floor(i)):this.le;let Le=null;const Oe=this.ae<=this.le&&this.zt.he>=Math.floor(1.5*i);for(let Ae=this.zt.tt.from;Ae<this.zt.tt.to;++Ae){const Ee=this.zt.In[Ae];Le!==Ee.ue&&(t.fillStyle=Ee.ue,Le=Ee.ue);const $e=Math.floor(.5*this.ae),Ie=Math.round(Ee.nt*i),Fe=Ie-$e,He=this.ae,ze=Fe+He-1,je=Math.min(Ee.ce,Ee.de),Ne=Math.max(Ee.ce,Ee.de),Ke=Math.round(je*s)-$e,Be=Math.round(Ne*s)+$e,Ue=Math.max(Be-Ke,this.ae);t.fillRect(Fe,Ke,He,Ue);const We=Math.ceil(1.5*this.le);if(Oe){if(this.zt.fe){const Je=Ie-We;let Ze=Math.max(Ke,Math.round(Ee.ve*s)-$e),Ye=Ze+He-1;Ye>Ke+Ue-1&&(Ye=Ke+Ue-1,Ze=Ye-He+1),t.fillRect(Je,Ze,Fe-Je,Ye-Ze+1)}const Ge=Ie+We;let qe=Math.max(Ke,Math.round(Ee.pe*s)-$e),Xe=qe+He-1;Xe>Ke+Ue-1&&(Xe=Ke+Ue-1,qe=Xe-He+1),t.fillRect(ze+1,qe,Ge-ze,Xe-qe+1)}}}oe(t){const i=Math.floor(t);return Math.max(i,Math.floor(function(s,Le){return Math.floor(.3*s*Le)}(b(this.zt).he,t)))}}class jt extends Et{constructor(t,i){super(t,i,!1)}Ks(t,i,s){i.Js(this.Is,E(this.zs)),t.me(this.Is,s,E(this.zs))}be(t,i,s){return{ot:t,we:i.Vt[0],ge:i.Vt[1],Me:i.Vt[2],xe:i.Vt[3],nt:NaN,ve:NaN,ce:NaN,de:NaN,pe:NaN}}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(i=>this.ne(i.se,i,t))}}class Ht extends jt{constructor(){super(...arguments),this.Ws=new Wt}ne(t,i,s){return Object.assign(Object.assign({},this.be(t,i,s)),s.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),fe:t.openVisible,_e:t.thinBars,tt:this.zs})}}class $t extends St{constructor(){super(...arguments),this.Cs=new Tt}ps(t,i){const s=this.G;return this.Cs.bs(t,{gs:i.Se,Ms:i.ke,xs:i.ye,Ss:i.Ce,ks:t.bitmapSize.height,fs:s.fs})}}class Ut extends Dt{constructor(){super(...arguments),this.Te=new Tt}Ds(t,i){const s=this.G;return this.Te.bs(t,{gs:i.Pe,Ms:i.Pe,xs:i.Re,Ss:i.Re,ks:t.bitmapSize.height,fs:s.fs})}}class qt extends Nt{constructor(t,i){super(t,i),this.Ws=new j,this.De=new $t,this.Ve=new Ut,this.Ws.Z([this.De,this.Ve])}ne(t,i,s){return Object.assign(Object.assign({},this.te(t,i)),s.Hs(t))}Gs(){const t=this.Ls.Ct();if(t===null)return;const i=this.Ls.W(),s=this.Ls.Dt().Rt(i.baseValue.price,t.Vt),Le=this.Es.St().he();this.De.J({it:this.Is,et:i.lineWidth,Nt:i.lineStyle,ds:i.lineType,fs:s,vs:!1,tt:this.zs,cs:Le}),this.Ve.J({it:this.Is,et:i.lineWidth,Nt:i.lineStyle,ds:i.lineVisible?i.lineType:void 0,Rs:i.pointMarkersVisible?i.pointMarkersRadius||i.lineWidth/2+2:void 0,fs:s,tt:this.zs,cs:Le})}}class Yt extends H{constructor(){super(...arguments),this.zt=null,this.le=0}J(t){this.zt=t}K(t){if(this.zt===null||this.zt.In.length===0||this.zt.tt===null)return;const{horizontalPixelRatio:i}=t;this.le=function(Oe,Ae){if(Oe>=2.5&&Oe<=4)return Math.floor(3*Ae);const Ee=1-.2*Math.atan(Math.max(4,Oe)-4)/(.5*Math.PI),$e=Math.floor(Oe*Ee*Ae),Ie=Math.floor(Oe*Ae),Fe=Math.min($e,Ie);return Math.max(Math.floor(Ae),Fe)}(this.zt.he,i),this.le>=2&&Math.floor(i)%2!=this.le%2&&this.le--;const s=this.zt.In;this.zt.Oe&&this.Be(t,s,this.zt.tt),this.zt._i&&this.Ae(t,s,this.zt.tt);const Le=this.Ie(i);(!this.zt._i||this.le>2*Le)&&this.ze(t,s,this.zt.tt)}Be(t,i,s){if(this.zt===null)return;const{context:Le,horizontalPixelRatio:Oe,verticalPixelRatio:Ae}=t;let Ee="",$e=Math.min(Math.floor(Oe),Math.floor(this.zt.he*Oe));$e=Math.max(Math.floor(Oe),Math.min($e,this.le));const Ie=Math.floor(.5*$e);let Fe=null;for(let He=s.from;He<s.to;He++){const ze=i[He];ze.Le!==Ee&&(Le.fillStyle=ze.Le,Ee=ze.Le);const je=Math.round(Math.min(ze.ve,ze.pe)*Ae),Ne=Math.round(Math.max(ze.ve,ze.pe)*Ae),Ke=Math.round(ze.ce*Ae),Be=Math.round(ze.de*Ae);let Ue=Math.round(Oe*ze.nt)-Ie;const We=Ue+$e-1;Fe!==null&&(Ue=Math.max(Fe+1,Ue),Ue=Math.min(Ue,We));const Ge=We-Ue+1;Le.fillRect(Ue,Ke,Ge,je-Ke),Le.fillRect(Ue,Ne+1,Ge,Be-Ne),Fe=We}}Ie(t){let i=Math.floor(1*t);this.le<=2*i&&(i=Math.floor(.5*(this.le-1)));const s=Math.max(Math.floor(t),i);return this.le<=2*s?Math.max(Math.floor(t),Math.floor(1*t)):s}Ae(t,i,s){if(this.zt===null)return;const{context:Le,horizontalPixelRatio:Oe,verticalPixelRatio:Ae}=t;let Ee="";const $e=this.Ie(Oe);let Ie=null;for(let Fe=s.from;Fe<s.to;Fe++){const He=i[Fe];He.Ee!==Ee&&(Le.fillStyle=He.Ee,Ee=He.Ee);let ze=Math.round(He.nt*Oe)-Math.floor(.5*this.le);const je=ze+this.le-1,Ne=Math.round(Math.min(He.ve,He.pe)*Ae),Ke=Math.round(Math.max(He.ve,He.pe)*Ae);if(Ie!==null&&(ze=Math.max(Ie+1,ze),ze=Math.min(ze,je)),this.zt.he*Oe>2*$e)K(Le,ze,Ne,je-ze+1,Ke-Ne+1,$e);else{const Be=je-ze+1;Le.fillRect(ze,Ne,Be,Ke-Ne+1)}Ie=je}}ze(t,i,s){if(this.zt===null)return;const{context:Le,horizontalPixelRatio:Oe,verticalPixelRatio:Ae}=t;let Ee="";const $e=this.Ie(Oe);for(let Ie=s.from;Ie<s.to;Ie++){const Fe=i[Ie];let He=Math.round(Math.min(Fe.ve,Fe.pe)*Ae),ze=Math.round(Math.max(Fe.ve,Fe.pe)*Ae),je=Math.round(Fe.nt*Oe)-Math.floor(.5*this.le),Ne=je+this.le-1;if(Fe.ue!==Ee){const Ke=Fe.ue;Le.fillStyle=Ke,Ee=Ke}this.zt._i&&(je+=$e,He+=$e,Ne-=$e,ze-=$e),He>ze||Le.fillRect(je,He,Ne-je+1,ze-He+1)}}}class Zt extends jt{constructor(){super(...arguments),this.Ws=new Yt}ne(t,i,s){return Object.assign(Object.assign({},this.be(t,i,s)),s.Hs(t))}Gs(){const t=this.Ls.W();this.Ws.J({In:this.Is,he:this.Es.St().he(),Oe:t.wickVisible,_i:t.borderVisible,tt:this.zs})}}class Xt{constructor(t,i){this.Ne=t,this.Li=i}X(t,i,s){this.Ne.draw(t,this.Li,i,s)}}class Kt extends Et{constructor(t,i,s){super(t,i,!1),this.wn=s,this.Ws=new Xt(this.wn.renderer(),Le=>{const Oe=t.Ct();return Oe===null?null:t.Dt().Rt(Le,Oe.Vt)})}Fe(t){return this.wn.priceValueBuilder(t)}We(t){return this.wn.isWhitespace(t)}qs(){const t=this.Ls.$s();this.Is=this.Ls.In().ie().map(i=>Object.assign(Object.assign({ot:i.se,nt:NaN},t.Hs(i.se)),{je:i.He}))}Ks(t,i){i.Js(this.Is,E(this.zs))}Gs(){this.wn.update({bars:this.Is.map(Gt),barSpacing:this.Es.St().he(),visibleRange:this.zs},this.Ls.W())}}function Gt(n){return{x:n.nt,time:n.ot,originalData:n.je,barColor:n.ue}}class Jt extends H{constructor(){super(...arguments),this.zt=null,this.$e=[]}J(t){this.zt=t,this.$e=[]}K({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return;this.$e.length||this.Ue(i);const Le=Math.max(1,Math.floor(s)),Oe=Math.round(this.zt.qe*s)-Math.floor(Le/2),Ae=Oe+Le;for(let Ee=this.zt.tt.from;Ee<this.zt.tt.to;Ee++){const $e=this.zt.it[Ee],Ie=this.$e[Ee-this.zt.tt.from],Fe=Math.round($e.st*s);let He,ze;t.fillStyle=$e.ue,Fe<=Oe?(He=Fe,ze=Ae):(He=Oe,ze=Fe-Math.floor(Le/2)+Le),t.fillRect(Ie.Vs,He,Ie.ui-Ie.Vs+1,ze-He)}}Ue(t){if(this.zt===null||this.zt.it.length===0||this.zt.tt===null)return void(this.$e=[]);const i=Math.ceil(this.zt.he*t)<=1?0:Math.max(1,Math.floor(t)),s=Math.round(this.zt.he*t)-i;this.$e=new Array(this.zt.tt.to-this.zt.tt.from);for(let Oe=this.zt.tt.from;Oe<this.zt.tt.to;Oe++){const Ae=this.zt.it[Oe],Ee=Math.round(Ae.nt*t);let $e,Ie;if(s%2){const Fe=(s-1)/2;$e=Ee-Fe,Ie=Ee+Fe}else{const Fe=s/2;$e=Ee-Fe,Ie=Ee+Fe-1}this.$e[Oe-this.zt.tt.from]={Vs:$e,ui:Ie,Ye:Ee,Ze:Ae.nt*t,ot:Ae.ot}}for(let Oe=this.zt.tt.from+1;Oe<this.zt.tt.to;Oe++){const Ae=this.$e[Oe-this.zt.tt.from],Ee=this.$e[Oe-this.zt.tt.from-1];Ae.ot===Ee.ot+1&&Ae.Vs-Ee.ui!==i+1&&(Ee.Ye>Ee.Ze?Ee.ui=Ae.Vs-i-1:Ae.Vs=Ee.ui+i+1)}let Le=Math.ceil(this.zt.he*t);for(let Oe=this.zt.tt.from;Oe<this.zt.tt.to;Oe++){const Ae=this.$e[Oe-this.zt.tt.from];Ae.ui<Ae.Vs&&(Ae.ui=Ae.Vs);const Ee=Ae.ui-Ae.Vs+1;Le=Math.min(Ee,Le)}if(i>0&&Le<4)for(let Oe=this.zt.tt.from;Oe<this.zt.tt.to;Oe++){const Ae=this.$e[Oe-this.zt.tt.from];Ae.ui-Ae.Vs+1>Le&&(Ae.Ye>Ae.Ze?Ae.ui-=1:Ae.Vs+=1)}}}class Qt extends Nt{constructor(){super(...arguments),this.Ws=new Jt}ne(t,i,s){return Object.assign(Object.assign({},this.te(t,i)),s.Hs(t))}Gs(){const t={it:this.Is,he:this.Es.St().he(),tt:this.zs,qe:this.Ls.Dt().Rt(this.Ls.W().base,b(this.Ls.Ct()).Vt)};this.Ws.J(t)}}class ti extends Nt{constructor(){super(...arguments),this.Ws=new Vt}ne(t,i,s){return Object.assign(Object.assign({},this.te(t,i)),s.Hs(t))}Gs(){const t=this.Ls.W(),i={it:this.Is,Nt:t.lineStyle,ds:t.lineVisible?t.lineType:void 0,et:t.lineWidth,Rs:t.pointMarkersVisible?t.pointMarkersRadius||t.lineWidth/2+2:void 0,tt:this.zs,cs:this.Es.St().he()};this.Ws.J(i)}}const ii=/[2-9]/g;class ni{constructor(t=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Je={},this.Qe=new Map,this.tr=t}ir(){this.Xe=0,this.Qe.clear(),this.Ke=1,this.Ge=1,this.Je={}}xi(t,i,s){return this.nr(t,i,s).width}Mi(t,i,s){const Le=this.nr(t,i,s);return((Le.actualBoundingBoxAscent||0)-(Le.actualBoundingBoxDescent||0))/2}nr(t,i,s){const Le=s||ii,Oe=String(i).replace(Le,"0");if(this.Qe.has(Oe))return m(this.Qe.get(Oe)).sr;if(this.Xe===this.tr){const Ee=this.Je[this.Ge];delete this.Je[this.Ge],this.Qe.delete(Ee),this.Ge++,this.Xe--}t.save(),t.textBaseline="middle";const Ae=t.measureText(Oe);return t.restore(),Ae.width===0&&i.length||(this.Qe.set(Oe,{sr:Ae,er:this.Ke}),this.Je[this.Ke]=Oe,this.Xe++,this.Ke++),Ae}}class si{constructor(t){this.rr=null,this.k=null,this.hr="right",this.lr=t}ar(t,i,s){this.rr=t,this.k=i,this.hr=s}X(t){this.k!==null&&this.rr!==null&&this.rr.X(t,this.k,this.lr,this.hr)}}class ei{constructor(t,i,s){this._r=t,this.lr=new ni(50),this.ur=i,this.F=s,this.j=-1,this.Wt=new si(this.lr)}gt(){const t=this.F.cr(this.ur);if(t===null)return null;const i=t.dr(this.ur)?t.vr():this.ur.Dt();if(i===null)return null;const s=t.pr(i);if(s==="overlay")return null;const Le=this.F.mr();return Le.P!==this.j&&(this.j=Le.P,this.lr.ir()),this.Wt.ar(this._r.Ii(),Le,s),this.Wt}}class ri extends H{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}br(t,i){var s;if(!(!((s=this.zt)===null||s===void 0)&&s.yt))return null;const{st:Le,et:Oe,wr:Ae}=this.zt;return i>=Le-Oe-7&&i<=Le+Oe+7?{gr:this.zt,wr:Ae}:null}K({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:Le}){if(this.zt===null||this.zt.yt===!1)return;const Oe=Math.round(this.zt.st*Le);Oe<0||Oe>i.height||(t.lineCap="butt",t.strokeStyle=this.zt.V,t.lineWidth=Math.floor(this.zt.et*s),f(t,this.zt.Nt),v(t,Oe,0,i.width))}}class hi{constructor(t){this.Mr={st:0,V:"rgba(0, 0, 0, 0)",et:1,Nt:0,yt:!1},this.Sr=new ri,this.ft=!0,this.Ls=t,this.Es=t.$t(),this.Sr.J(this.Mr)}bt(){this.ft=!0}gt(){return this.Ls.yt()?(this.ft&&(this.kr(),this.ft=!1),this.Sr):null}}class li extends hi{constructor(t){super(t)}kr(){this.Mr.yt=!1;const t=this.Ls.Dt(),i=t.yr().yr;if(i!==2&&i!==3)return;const s=this.Ls.W();if(!s.baseLineVisible||!this.Ls.yt())return;const Le=this.Ls.Ct();Le!==null&&(this.Mr.yt=!0,this.Mr.st=t.Rt(Le.Vt,Le.Vt),this.Mr.V=s.baseLineColor,this.Mr.et=s.baseLineWidth,this.Mr.Nt=s.baseLineStyle)}}class ai extends H{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}He(){return this.zt}K({context:t,horizontalPixelRatio:i,verticalPixelRatio:s}){const Le=this.zt;if(Le===null)return;const Oe=Math.max(1,Math.floor(i)),Ae=Oe%2/2,Ee=Math.round(Le.Ze.x*i)+Ae,$e=Le.Ze.y*s;t.fillStyle=Le.Cr,t.beginPath();const Ie=Math.max(2,1.5*Le.Tr)*i;t.arc(Ee,$e,Ie,0,2*Math.PI,!1),t.fill(),t.fillStyle=Le.Pr,t.beginPath(),t.arc(Ee,$e,Le.ht*i,0,2*Math.PI,!1),t.fill(),t.lineWidth=Oe,t.strokeStyle=Le.Rr,t.beginPath(),t.arc(Ee,$e,Le.ht*i+Oe/2,0,2*Math.PI,!1),t.stroke()}}const oi=[{Dr:0,Vr:.25,Or:4,Br:10,Ar:.25,Ir:0,zr:.4,Lr:.8},{Dr:.25,Vr:.525,Or:10,Br:14,Ar:0,Ir:0,zr:.8,Lr:0},{Dr:.525,Vr:1,Or:14,Br:14,Ar:0,Ir:0,zr:0,Lr:0}];function _i(n,t,i,s){return function(Le,Oe){if(Le==="transparent")return Le;const Ae=T(Le),Ee=Ae[3];return`rgba(${Ae[0]}, ${Ae[1]}, ${Ae[2]}, ${Oe*Ee})`}(n,i+(s-i)*t)}function ui(n,t){const i=n%2600/2600;let s;for(const $e of oi)if(i>=$e.Dr&&i<=$e.Vr){s=$e;break}p(s!==void 0,"Last price animation internal logic error");const Le=(i-s.Dr)/(s.Vr-s.Dr);return{Pr:_i(t,Le,s.Ar,s.Ir),Rr:_i(t,Le,s.zr,s.Lr),ht:(Oe=Le,Ae=s.Or,Ee=s.Br,Ae+(Ee-Ae)*Oe)};var Oe,Ae,Ee}class ci{constructor(t){this.Wt=new ai,this.ft=!0,this.Er=!0,this.Nr=performance.now(),this.Fr=this.Nr-1,this.Wr=t}jr(){this.Fr=this.Nr-1,this.bt()}Hr(){if(this.bt(),this.Wr.W().lastPriceAnimation===2){const t=performance.now(),i=this.Fr-t;if(i>0)return void(i<650&&(this.Fr+=2600));this.Nr=t,this.Fr=t+2600}}bt(){this.ft=!0}$r(){this.Er=!0}yt(){return this.Wr.W().lastPriceAnimation!==0}Ur(){switch(this.Wr.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Fr}}gt(){return this.ft?(this.Mt(),this.ft=!1,this.Er=!1):this.Er&&(this.qr(),this.Er=!1),this.Wt}Mt(){this.Wt.J(null);const t=this.Wr.$t().St(),i=t.Zs(),s=this.Wr.Ct();if(i===null||s===null)return;const Le=this.Wr.Yr(!0);if(Le.Zr||!i.Xr(Le.se))return;const Oe={x:t.It(Le.se),y:this.Wr.Dt().Rt(Le._t,s.Vt)},Ae=Le.V,Ee=this.Wr.W().lineWidth,$e=ui(this.Kr(),Ae);this.Wt.J({Cr:Ae,Tr:Ee,Pr:$e.Pr,Rr:$e.Rr,ht:$e.ht,Ze:Oe})}qr(){const t=this.Wt.He();if(t!==null){const i=ui(this.Kr(),t.Cr);t.Pr=i.Pr,t.Rr=i.Rr,t.ht=i.ht}}Kr(){return this.Ur()?performance.now()-this.Nr:2599}}function di(n,t){return Ct(Math.min(Math.max(n,12),30)*t)}function fi(n,t){switch(n){case"arrowDown":case"arrowUp":return di(t,1);case"circle":return di(t,.8);case"square":return di(t,.7)}}function vi(n){return function(t){const i=Math.ceil(t);return i%2!=0?i-1:i}(di(n,1))}function pi(n){return Math.max(di(n,.1),3)}function mi(n,t,i){return t?n:i?Math.ceil(n/2):0}function bi(n,t,i,s,Le){const Oe=fi("square",i),Ae=(Oe-1)/2,Ee=n-Ae,$e=t-Ae;return s>=Ee&&s<=Ee+Oe&&Le>=$e&&Le<=$e+Oe}function wi(n,t,i,s){const Le=(fi("arrowUp",s)-1)/2*i.Gr,Oe=(Ct(s/2)-1)/2*i.Gr;t.beginPath(),n?(t.moveTo(i.nt-Le,i.st),t.lineTo(i.nt,i.st-Le),t.lineTo(i.nt+Le,i.st),t.lineTo(i.nt+Oe,i.st),t.lineTo(i.nt+Oe,i.st+Le),t.lineTo(i.nt-Oe,i.st+Le),t.lineTo(i.nt-Oe,i.st)):(t.moveTo(i.nt-Le,i.st),t.lineTo(i.nt,i.st+Le),t.lineTo(i.nt+Le,i.st),t.lineTo(i.nt+Oe,i.st),t.lineTo(i.nt+Oe,i.st-Le),t.lineTo(i.nt-Oe,i.st-Le),t.lineTo(i.nt-Oe,i.st)),t.fill()}function gi(n,t,i,s,Le,Oe){return bi(t,i,s,Le,Oe)}class Mi extends H{constructor(){super(...arguments),this.zt=null,this.lr=new ni,this.j=-1,this.H="",this.Jr=""}J(t){this.zt=t}ar(t,i){this.j===t&&this.H===i||(this.j=t,this.H=i,this.Jr=F(t,i),this.lr.ir())}br(t,i){if(this.zt===null||this.zt.tt===null)return null;for(let s=this.zt.tt.from;s<this.zt.tt.to;s++){const Le=this.zt.it[s];if(Si(Le,t,i))return{gr:Le.Qr,wr:Le.wr}}return null}K({context:t,horizontalPixelRatio:i,verticalPixelRatio:s},Le,Oe){if(this.zt!==null&&this.zt.tt!==null){t.textBaseline="middle",t.font=this.Jr;for(let Ae=this.zt.tt.from;Ae<this.zt.tt.to;Ae++){const Ee=this.zt.it[Ae];Ee.Kt!==void 0&&(Ee.Kt.Hi=this.lr.xi(t,Ee.Kt.th),Ee.Kt.At=this.j,Ee.Kt.nt=Ee.nt-Ee.Kt.Hi/2),xi(Ee,t,i,s)}}}}function xi(n,t,i,s){t.fillStyle=n.V,n.Kt!==void 0&&function(Le,Oe,Ae,Ee,$e,Ie){Le.save(),Le.scale($e,Ie),Le.fillText(Oe,Ae,Ee),Le.restore()}(t,n.Kt.th,n.Kt.nt,n.Kt.st,i,s),function(Le,Oe,Ae){if(Le.Xs!==0){switch(Le.ih){case"arrowDown":return void wi(!1,Oe,Ae,Le.Xs);case"arrowUp":return void wi(!0,Oe,Ae,Le.Xs);case"circle":return void function(Ee,$e,Ie){const Fe=(fi("circle",Ie)-1)/2;Ee.beginPath(),Ee.arc($e.nt,$e.st,Fe*$e.Gr,0,2*Math.PI,!1),Ee.fill()}(Oe,Ae,Le.Xs);case"square":return void function(Ee,$e,Ie){const Fe=fi("square",Ie),He=(Fe-1)*$e.Gr/2,ze=$e.nt-He,je=$e.st-He;Ee.fillRect(ze,je,Fe*$e.Gr,Fe*$e.Gr)}(Oe,Ae,Le.Xs)}Le.ih}}(n,t,function(Le,Oe,Ae){const Ee=Math.max(1,Math.floor(Oe))%2/2;return{nt:Math.round(Le.nt*Oe)+Ee,st:Le.st*Ae,Gr:Oe}}(n,i,s))}function Si(n,t,i){return!(n.Kt===void 0||!function(s,Le,Oe,Ae,Ee,$e){const Ie=Ae/2;return Ee>=s&&Ee<=s+Oe&&$e>=Le-Ie&&$e<=Le+Ie}(n.Kt.nt,n.Kt.st,n.Kt.Hi,n.Kt.At,t,i))||function(s,Le,Oe){if(s.Xs===0)return!1;switch(s.ih){case"arrowDown":case"arrowUp":return gi(0,s.nt,s.st,s.Xs,Le,Oe);case"circle":return function(Ae,Ee,$e,Ie,Fe){const He=2+fi("circle",$e)/2,ze=Ae-Ie,je=Ee-Fe;return Math.sqrt(ze*ze+je*je)<=He}(s.nt,s.st,s.Xs,Le,Oe);case"square":return bi(s.nt,s.st,s.Xs,Le,Oe)}}(n,t,i)}function ki(n,t,i,s,Le,Oe,Ae,Ee,$e){const Ie=O(i)?i:i.xe,Fe=O(i)?i:i.ge,He=O(i)?i:i.Me,ze=O(t.size)?Math.max(t.size,0):1,je=vi(Ee.he())*ze,Ne=je/2;switch(n.Xs=je,t.position){case"inBar":return n.st=Ae.Rt(Ie,$e),void(n.Kt!==void 0&&(n.Kt.st=n.st+Ne+Oe+.6*Le));case"aboveBar":return n.st=Ae.Rt(Fe,$e)-Ne-s.nh,n.Kt!==void 0&&(n.Kt.st=n.st-Ne-.6*Le,s.nh+=1.2*Le),void(s.nh+=je+Oe);case"belowBar":return n.st=Ae.Rt(He,$e)+Ne+s.sh,n.Kt!==void 0&&(n.Kt.st=n.st+Ne+Oe+.6*Le,s.sh+=1.2*Le),void(s.sh+=je+Oe)}t.position}class yi{constructor(t,i){this.ft=!0,this.eh=!0,this.rh=!0,this.hh=null,this.ah=null,this.Wt=new Mi,this.Wr=t,this.$i=i,this.zt={it:[],tt:null}}bt(t){this.ft=!0,this.rh=!0,t==="data"&&(this.eh=!0,this.ah=null)}gt(t){if(!this.Wr.yt())return null;this.ft&&this.oh();const i=this.$i.W().layout;return this.Wt.ar(i.fontSize,i.fontFamily),this.Wt.J(this.zt),this.Wt}_h(){if(this.rh){if(this.Wr.uh().length>0){const t=this.$i.St().he(),i=pi(t),s=1.5*vi(t)+2*i,Le=this.dh();this.hh={above:mi(s,Le.aboveBar,Le.inBar),below:mi(s,Le.belowBar,Le.inBar)}}else this.hh=null;this.rh=!1}return this.hh}dh(){return this.ah===null&&(this.ah=this.Wr.uh().reduce((t,i)=>(t[i.position]||(t[i.position]=!0),t),{inBar:!1,aboveBar:!1,belowBar:!1})),this.ah}oh(){const t=this.Wr.Dt(),i=this.$i.St(),s=this.Wr.uh();this.eh&&(this.zt.it=s.map(Fe=>({ot:Fe.time,nt:0,st:0,Xs:0,ih:Fe.shape,V:Fe.color,Qr:Fe.Qr,wr:Fe.id,Kt:void 0})),this.eh=!1);const Le=this.$i.W().layout;this.zt.tt=null;const Oe=i.Zs();if(Oe===null)return;const Ae=this.Wr.Ct();if(Ae===null||this.zt.it.length===0)return;let Ee=NaN;const $e=pi(i.he()),Ie={nh:$e,sh:$e};this.zt.tt=Lt(this.zt.it,Oe,!0);for(let Fe=this.zt.tt.from;Fe<this.zt.tt.to;Fe++){const He=s[Fe];He.time!==Ee&&(Ie.nh=$e,Ie.sh=$e,Ee=He.time);const ze=this.zt.it[Fe];ze.nt=i.It(He.time),He.text!==void 0&&He.text.length>0&&(ze.Kt={th:He.text,nt:0,st:0,Hi:0,At:0});const je=this.Wr.fh(He.time);je!==null&&ki(ze,He,je,Ie,Le.fontSize,$e,t,i,Ae.Vt)}this.ft=!1}}class Ci extends hi{constructor(t){super(t)}kr(){const t=this.Mr;t.yt=!1;const i=this.Ls.W();if(!i.priceLineVisible||!this.Ls.yt())return;const s=this.Ls.Yr(i.priceLineSource===0);s.Zr||(t.yt=!0,t.st=s.ki,t.V=this.Ls.ph(s.V),t.et=i.priceLineWidth,t.Nt=i.priceLineStyle)}}class Ti extends nt{constructor(t){super(),this.jt=t}zi(t,i,s){t.yt=!1,i.yt=!1;const Le=this.jt;if(!Le.yt())return;const Oe=Le.W(),Ae=Oe.lastValueVisible,Ee=Le.mh()!=="",$e=Oe.seriesLastValueMode===0,Ie=Le.Yr(!1);if(Ie.Zr)return;Ae&&(t.Kt=this.bh(Ie,Ae,$e),t.yt=t.Kt.length!==0),(Ee||$e)&&(i.Kt=this.wh(Ie,Ae,Ee,$e),i.yt=i.Kt.length>0);const Fe=Le.ph(Ie.V),He=R(Fe);s.t=He.t,s.ki=Ie.ki,i.Ot=Le.$t().Bt(Ie.ki/Le.Dt().At()),t.Ot=Fe,t.V=He.i,i.V=He.i}wh(t,i,s,Le){let Oe="";const Ae=this.jt.mh();return s&&Ae.length!==0&&(Oe+=`${Ae} `),i&&Le&&(Oe+=this.jt.Dt().gh()?t.Mh:t.xh),Oe.trim()}bh(t,i,s){return i?s?this.jt.Dt().gh()?t.xh:t.Mh:t.Kt:""}}function Pi(n,t,i,s){const Le=Number.isFinite(t),Oe=Number.isFinite(i);return Le&&Oe?n(t,i):Le||Oe?Le?t:i:s}class Ri{constructor(t,i){this.Sh=t,this.kh=i}yh(t){return t!==null&&this.Sh===t.Sh&&this.kh===t.kh}Ch(){return new Ri(this.Sh,this.kh)}Th(){return this.Sh}Ph(){return this.kh}Rh(){return this.kh-this.Sh}Ni(){return this.kh===this.Sh||Number.isNaN(this.kh)||Number.isNaN(this.Sh)}ts(t){return t===null?this:new Ri(Pi(Math.min,this.Th(),t.Th(),-1/0),Pi(Math.max,this.Ph(),t.Ph(),1/0))}Dh(t){if(!O(t)||this.kh-this.Sh===0)return;const i=.5*(this.kh+this.Sh);let s=this.kh-i,Le=this.Sh-i;s*=t,Le*=t,this.kh=i+s,this.Sh=i+Le}Vh(t){O(t)&&(this.kh+=t,this.Sh+=t)}Oh(){return{minValue:this.Sh,maxValue:this.kh}}static Bh(t){return t===null?null:new Ri(t.minValue,t.maxValue)}}class Di{constructor(t,i){this.Ah=t,this.Ih=i||null}zh(){return this.Ah}Lh(){return this.Ih}Oh(){return this.Ah===null?null:{priceRange:this.Ah.Oh(),margins:this.Ih||void 0}}static Bh(t){return t===null?null:new Di(Ri.Bh(t.priceRange),t.margins)}}class Vi extends hi{constructor(t,i){super(t),this.Eh=i}kr(){const t=this.Mr;t.yt=!1;const i=this.Eh.W();if(!this.Ls.yt()||!i.lineVisible)return;const s=this.Eh.Nh();s!==null&&(t.yt=!0,t.st=s,t.V=i.color,t.et=i.lineWidth,t.Nt=i.lineStyle,t.wr=this.Eh.W().id)}}class Oi extends nt{constructor(t,i){super(),this.Wr=t,this.Eh=i}zi(t,i,s){t.yt=!1,i.yt=!1;const Le=this.Eh.W(),Oe=Le.axisLabelVisible,Ae=Le.title!=="",Ee=this.Wr;if(!Oe||!Ee.yt())return;const $e=this.Eh.Nh();if($e===null)return;Ae&&(i.Kt=Le.title,i.yt=!0),i.Ot=Ee.$t().Bt($e/Ee.Dt().At()),t.Kt=this.Fh(Le.price),t.yt=!0;const Ie=R(Le.axisLabelColor||Le.color);s.t=Ie.t;const Fe=Le.axisLabelTextColor||Ie.i;t.V=Fe,i.V=Fe,s.ki=$e}Fh(t){const i=this.Wr.Ct();return i===null?"":this.Wr.Dt().Fi(t,i.Vt)}}class Bi{constructor(t,i){this.Wr=t,this.cn=i,this.Wh=new Vi(t,this),this._r=new Oi(t,this),this.jh=new ei(this._r,t,t.$t())}Hh(t){V(this.cn,t),this.bt(),this.Wr.$t().$h()}W(){return this.cn}Uh(){return this.Wh}qh(){return this.jh}Yh(){return this._r}bt(){this.Wh.bt(),this._r.bt()}Nh(){const t=this.Wr,i=t.Dt();if(t.$t().St().Ni()||i.Ni())return null;const s=t.Ct();return s===null?null:i.Rt(this.cn.price,s.Vt)}}class Ai extends lt{constructor(t){super(),this.$i=t}$t(){return this.$i}}const Ii={Bar:(n,t,i,s)=>{var Le;const Oe=t.upColor,Ae=t.downColor,Ee=b(n(i,s)),$e=w(Ee.Vt[0])<=w(Ee.Vt[3]);return{ue:(Le=Ee.V)!==null&&Le!==void 0?Le:$e?Oe:Ae}},Candlestick:(n,t,i,s)=>{var Le,Oe,Ae;const Ee=t.upColor,$e=t.downColor,Ie=t.borderUpColor,Fe=t.borderDownColor,He=t.wickUpColor,ze=t.wickDownColor,je=b(n(i,s)),Ne=w(je.Vt[0])<=w(je.Vt[3]);return{ue:(Le=je.V)!==null&&Le!==void 0?Le:Ne?Ee:$e,Ee:(Oe=je.Ot)!==null&&Oe!==void 0?Oe:Ne?Ie:Fe,Le:(Ae=je.Zh)!==null&&Ae!==void 0?Ae:Ne?He:ze}},Custom:(n,t,i,s)=>{var Le;return{ue:(Le=b(n(i,s)).V)!==null&&Le!==void 0?Le:t.color}},Area:(n,t,i,s)=>{var Le,Oe,Ae,Ee;const $e=b(n(i,s));return{ue:(Le=$e.lt)!==null&&Le!==void 0?Le:t.lineColor,lt:(Oe=$e.lt)!==null&&Oe!==void 0?Oe:t.lineColor,Ts:(Ae=$e.Ts)!==null&&Ae!==void 0?Ae:t.topColor,Ps:(Ee=$e.Ps)!==null&&Ee!==void 0?Ee:t.bottomColor}},Baseline:(n,t,i,s)=>{var Le,Oe,Ae,Ee,$e,Ie;const Fe=b(n(i,s));return{ue:Fe.Vt[3]>=t.baseValue.price?t.topLineColor:t.bottomLineColor,Pe:(Le=Fe.Pe)!==null&&Le!==void 0?Le:t.topLineColor,Re:(Oe=Fe.Re)!==null&&Oe!==void 0?Oe:t.bottomLineColor,Se:(Ae=Fe.Se)!==null&&Ae!==void 0?Ae:t.topFillColor1,ke:(Ee=Fe.ke)!==null&&Ee!==void 0?Ee:t.topFillColor2,ye:($e=Fe.ye)!==null&&$e!==void 0?$e:t.bottomFillColor1,Ce:(Ie=Fe.Ce)!==null&&Ie!==void 0?Ie:t.bottomFillColor2}},Line:(n,t,i,s)=>{var Le,Oe;const Ae=b(n(i,s));return{ue:(Le=Ae.V)!==null&&Le!==void 0?Le:t.color,lt:(Oe=Ae.V)!==null&&Oe!==void 0?Oe:t.color}},Histogram:(n,t,i,s)=>{var Le;return{ue:(Le=b(n(i,s)).V)!==null&&Le!==void 0?Le:t.color}}};class zi{constructor(t){this.Xh=(i,s)=>s!==void 0?s.Vt:this.Wr.In().Kh(i),this.Wr=t,this.Gh=Ii[t.Jh()]}Hs(t,i){return this.Gh(this.Xh,this.Wr.W(),t,i)}}var Li;(function(n){n[n.NearestLeft=-1]="NearestLeft",n[n.None=0]="None",n[n.NearestRight=1]="NearestRight"})(Li||(Li={}));const Ei=30;class Ni{constructor(){this.Qh=[],this.tl=new Map,this.il=new Map}nl(){return this.Xs()>0?this.Qh[this.Qh.length-1]:null}sl(){return this.Xs()>0?this.el(0):null}An(){return this.Xs()>0?this.el(this.Qh.length-1):null}Xs(){return this.Qh.length}Ni(){return this.Xs()===0}Xr(t){return this.rl(t,0)!==null}Kh(t){return this.hl(t)}hl(t,i=0){const s=this.rl(t,i);return s===null?null:Object.assign(Object.assign({},this.ll(s)),{se:this.el(s)})}ie(){return this.Qh}al(t,i,s){if(this.Ni())return null;let Le=null;for(const Oe of s)Le=Fi(Le,this.ol(t,i,Oe));return Le}J(t){this.il.clear(),this.tl.clear(),this.Qh=t}el(t){return this.Qh[t].se}ll(t){return this.Qh[t]}rl(t,i){const s=this._l(t);if(s===null&&i!==0)switch(i){case-1:return this.ul(t);case 1:return this.cl(t);default:throw new TypeError("Unknown search mode")}return s}ul(t){let i=this.dl(t);return i>0&&(i-=1),i!==this.Qh.length&&this.el(i)<t?i:null}cl(t){const i=this.fl(t);return i!==this.Qh.length&&t<this.el(i)?i:null}_l(t){const i=this.dl(t);return i===this.Qh.length||t<this.Qh[i].se?null:i}dl(t){return Bt(this.Qh,t,(i,s)=>i.se<s)}fl(t){return At(this.Qh,t,(i,s)=>i.se>s)}vl(t,i,s){let Le=null;for(let Oe=t;Oe<i;Oe++){const Ae=this.Qh[Oe].Vt[s];Number.isNaN(Ae)||(Le===null?Le={pl:Ae,ml:Ae}:(Ae<Le.pl&&(Le.pl=Ae),Ae>Le.ml&&(Le.ml=Ae)))}return Le}ol(t,i,s){if(this.Ni())return null;let Le=null;const Oe=b(this.sl()),Ae=b(this.An()),Ee=Math.max(t,Oe),$e=Math.min(i,Ae),Ie=Math.ceil(Ee/Ei)*Ei,Fe=Math.max(Ie,Math.floor($e/Ei)*Ei);{const ze=this.dl(Ee),je=this.fl(Math.min($e,Ie,i));Le=Fi(Le,this.vl(ze,je,s))}let He=this.tl.get(s);He===void 0&&(He=new Map,this.tl.set(s,He));for(let ze=Math.max(Ie+1,Ee);ze<Fe;ze+=Ei){const je=Math.floor(ze/Ei);let Ne=He.get(je);if(Ne===void 0){const Ke=this.dl(je*Ei),Be=this.fl((je+1)*Ei-1);Ne=this.vl(Ke,Be,s),He.set(je,Ne)}Le=Fi(Le,Ne)}{const ze=this.dl(Fe),je=this.fl($e);Le=Fi(Le,this.vl(ze,je,s))}return Le}}function Fi(n,t){return n===null?t:t===null?n:{pl:Math.min(n.pl,t.pl),ml:Math.max(n.ml,t.ml)}}class Wi{constructor(t){this.bl=t}X(t,i,s){this.bl.draw(t)}wl(t,i,s){var Le,Oe;(Oe=(Le=this.bl).drawBackground)===null||Oe===void 0||Oe.call(Le,t)}}class ji{constructor(t){this.Qe=null,this.wn=t}gt(){var t;const i=this.wn.renderer();if(i===null)return null;if(((t=this.Qe)===null||t===void 0?void 0:t.gl)===i)return this.Qe.Ml;const s=new Wi(i);return this.Qe={gl:i,Ml:s},s}xl(){var t,i,s;return(s=(i=(t=this.wn).zOrder)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:"normal"}}function Hi(n){var t,i,s,Le,Oe;return{Kt:n.text(),ki:n.coordinate(),Si:(t=n.fixedCoordinate)===null||t===void 0?void 0:t.call(n),V:n.textColor(),t:n.backColor(),yt:(s=(i=n.visible)===null||i===void 0?void 0:i.call(n))===null||s===void 0||s,hi:(Oe=(Le=n.tickVisible)===null||Le===void 0?void 0:Le.call(n))===null||Oe===void 0||Oe}}class $i{constructor(t,i){this.Wt=new rt,this.Sl=t,this.kl=i}gt(){return this.Wt.J(Object.assign({Hi:this.kl.Hi()},Hi(this.Sl))),this.Wt}}class Ui extends nt{constructor(t,i){super(),this.Sl=t,this.Li=i}zi(t,i,s){const Le=Hi(this.Sl);s.t=Le.t,t.V=Le.V;const Oe=2/12*this.Li.P();s.wi=Oe,s.gi=Oe,s.ki=Le.ki,s.Si=Le.Si,t.Kt=Le.Kt,t.yt=Le.yt,t.hi=Le.hi}}class qi{constructor(t,i){this.yl=null,this.Cl=null,this.Tl=null,this.Pl=null,this.Rl=null,this.Dl=t,this.Wr=i}Vl(){return this.Dl}Vn(){var t,i;(i=(t=this.Dl).updateAllViews)===null||i===void 0||i.call(t)}Pn(){var t,i,s,Le;const Oe=(s=(i=(t=this.Dl).paneViews)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:[];if(((Le=this.yl)===null||Le===void 0?void 0:Le.gl)===Oe)return this.yl.Ml;const Ae=Oe.map(Ee=>new ji(Ee));return this.yl={gl:Oe,Ml:Ae},Ae}Qi(){var t,i,s,Le;const Oe=(s=(i=(t=this.Dl).timeAxisViews)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:[];if(((Le=this.Cl)===null||Le===void 0?void 0:Le.gl)===Oe)return this.Cl.Ml;const Ae=this.Wr.$t().St(),Ee=Oe.map($e=>new $i($e,Ae));return this.Cl={gl:Oe,Ml:Ee},Ee}Rn(){var t,i,s,Le;const Oe=(s=(i=(t=this.Dl).priceAxisViews)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:[];if(((Le=this.Tl)===null||Le===void 0?void 0:Le.gl)===Oe)return this.Tl.Ml;const Ae=this.Wr.Dt(),Ee=Oe.map($e=>new Ui($e,Ae));return this.Tl={gl:Oe,Ml:Ee},Ee}Ol(){var t,i,s,Le;const Oe=(s=(i=(t=this.Dl).priceAxisPaneViews)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:[];if(((Le=this.Pl)===null||Le===void 0?void 0:Le.gl)===Oe)return this.Pl.Ml;const Ae=Oe.map(Ee=>new ji(Ee));return this.Pl={gl:Oe,Ml:Ae},Ae}Bl(){var t,i,s,Le;const Oe=(s=(i=(t=this.Dl).timeAxisPaneViews)===null||i===void 0?void 0:i.call(t))!==null&&s!==void 0?s:[];if(((Le=this.Rl)===null||Le===void 0?void 0:Le.gl)===Oe)return this.Rl.Ml;const Ae=Oe.map(Ee=>new ji(Ee));return this.Rl={gl:Oe,Ml:Ae},Ae}Al(t,i){var s,Le,Oe;return(Oe=(Le=(s=this.Dl).autoscaleInfo)===null||Le===void 0?void 0:Le.call(s,t,i))!==null&&Oe!==void 0?Oe:null}br(t,i){var s,Le,Oe;return(Oe=(Le=(s=this.Dl).hitTest)===null||Le===void 0?void 0:Le.call(s,t,i))!==null&&Oe!==void 0?Oe:null}}function Yi(n,t,i,s){n.forEach(Le=>{t(Le).forEach(Oe=>{Oe.xl()===i&&s.push(Oe)})})}function Zi(n){return n.Pn()}function Xi(n){return n.Ol()}function Ki(n){return n.Bl()}class Gi extends Ai{constructor(t,i,s,Le,Oe){super(t),this.zt=new Ni,this.Wh=new Ci(this),this.Il=[],this.zl=new li(this),this.Ll=null,this.El=null,this.Nl=[],this.Fl=[],this.Wl=null,this.jl=[],this.cn=i,this.Hl=s;const Ae=new Ti(this);this.rn=[Ae],this.jh=new ei(Ae,this,t),s!=="Area"&&s!=="Line"&&s!=="Baseline"||(this.Ll=new ci(this)),this.$l(),this.Ul(Oe)}S(){this.Wl!==null&&clearTimeout(this.Wl)}ph(t){return this.cn.priceLineColor||t}Yr(t){const i={Zr:!0},s=this.Dt();if(this.$t().St().Ni()||s.Ni()||this.zt.Ni())return i;const Le=this.$t().St().Zs(),Oe=this.Ct();if(Le===null||Oe===null)return i;let Ae,Ee;if(t){const He=this.zt.nl();if(He===null)return i;Ae=He,Ee=He.se}else{const He=this.zt.hl(Le.ui(),-1);if(He===null||(Ae=this.zt.Kh(He.se),Ae===null))return i;Ee=He.se}const $e=Ae.Vt[3],Ie=this.$s().Hs(Ee,{Vt:Ae}),Fe=s.Rt($e,Oe.Vt);return{Zr:!1,_t:$e,Kt:s.Fi($e,Oe.Vt),Mh:s.ql($e),xh:s.Yl($e,Oe.Vt),V:Ie.ue,ki:Fe,se:Ee}}$s(){return this.El!==null||(this.El=new zi(this)),this.El}W(){return this.cn}Hh(t){const i=t.priceScaleId;i!==void 0&&i!==this.cn.priceScaleId&&this.$t().Zl(this,i),V(this.cn,t),t.priceFormat!==void 0&&(this.$l(),this.$t().Xl()),this.$t().Kl(this),this.$t().Gl(),this.wn.bt("options")}J(t,i){this.zt.J(t),this.Jl(),this.wn.bt("data"),this.dn.bt("data"),this.Ll!==null&&(i&&i.Ql?this.Ll.Hr():t.length===0&&this.Ll.jr());const s=this.$t().cr(this);this.$t().ta(s),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}ia(t){this.Nl=t,this.Jl();const i=this.$t().cr(this);this.dn.bt("data"),this.$t().ta(i),this.$t().Kl(this),this.$t().Gl(),this.$t().$h()}na(){return this.Nl}uh(){return this.Fl}sa(t){const i=new Bi(this,t);return this.Il.push(i),this.$t().Kl(this),i}ea(t){const i=this.Il.indexOf(t);i!==-1&&this.Il.splice(i,1),this.$t().Kl(this)}Jh(){return this.Hl}Ct(){const t=this.ra();return t===null?null:{Vt:t.Vt[3],ha:t.ot}}ra(){const t=this.$t().St().Zs();if(t===null)return null;const i=t.Vs();return this.zt.hl(i,1)}In(){return this.zt}fh(t){const i=this.zt.Kh(t);return i===null?null:this.Hl==="Bar"||this.Hl==="Candlestick"||this.Hl==="Custom"?{we:i.Vt[0],ge:i.Vt[1],Me:i.Vt[2],xe:i.Vt[3]}:i.Vt[3]}la(t){const i=[];Yi(this.jl,Zi,"top",i);const s=this.Ll;return s!==null&&s.yt()&&(this.Wl===null&&s.Ur()&&(this.Wl=setTimeout(()=>{this.Wl=null,this.$t().aa()},0)),s.$r(),i.unshift(s)),i}Pn(){const t=[];this.oa()||t.push(this.zl),t.push(this.wn,this.Wh,this.dn);const i=this.Il.map(s=>s.Uh());return t.push(...i),Yi(this.jl,Zi,"normal",t),t}_a(){return this.ua(Zi,"bottom")}ca(t){return this.ua(Xi,t)}da(t){return this.ua(Ki,t)}fa(t,i){return this.jl.map(s=>s.br(t,i)).filter(s=>s!==null)}Ji(t){return[this.jh,...this.Il.map(i=>i.qh())]}Rn(t,i){if(i!==this.Yi&&!this.oa())return[];const s=[...this.rn];for(const Le of this.Il)s.push(Le.Yh());return this.jl.forEach(Le=>{s.push(...Le.Rn())}),s}Qi(){const t=[];return this.jl.forEach(i=>{t.push(...i.Qi())}),t}Al(t,i){if(this.cn.autoscaleInfoProvider!==void 0){const s=this.cn.autoscaleInfoProvider(()=>{const Le=this.va(t,i);return Le===null?null:Le.Oh()});return Di.Bh(s)}return this.va(t,i)}pa(){return this.cn.priceFormat.minMove}ma(){return this.ba}Vn(){var t;this.wn.bt(),this.dn.bt();for(const i of this.rn)i.bt();for(const i of this.Il)i.bt();this.Wh.bt(),this.zl.bt(),(t=this.Ll)===null||t===void 0||t.bt(),this.jl.forEach(i=>i.Vn())}Dt(){return b(super.Dt())}kt(t){if(!((this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline")&&this.cn.crosshairMarkerVisible))return null;const i=this.zt.Kh(t);return i===null?null:{_t:i.Vt[3],ht:this.wa(),Ot:this.ga(),Pt:this.Ma(),Tt:this.xa(t)}}mh(){return this.cn.title}yt(){return this.cn.visible}Sa(t){this.jl.push(new qi(t,this))}ka(t){this.jl=this.jl.filter(i=>i.Vl()!==t)}ya(){if(this.wn instanceof Kt)return t=>this.wn.Fe(t)}Ca(){if(this.wn instanceof Kt)return t=>this.wn.We(t)}oa(){return!_t(this.Dt().Ta())}va(t,i){if(!B(t)||!B(i)||this.zt.Ni())return null;const s=this.Hl==="Line"||this.Hl==="Area"||this.Hl==="Baseline"||this.Hl==="Histogram"?[3]:[2,1],Le=this.zt.al(t,i,s);let Oe=Le!==null?new Ri(Le.pl,Le.ml):null;if(this.Jh()==="Histogram"){const Ee=this.cn.base,$e=new Ri(Ee,Ee);Oe=Oe!==null?Oe.ts($e):$e}let Ae=this.dn._h();return this.jl.forEach(Ee=>{const $e=Ee.Al(t,i);if($e?.priceRange){const je=new Ri($e.priceRange.minValue,$e.priceRange.maxValue);Oe=Oe!==null?Oe.ts(je):je}var Ie,Fe,He,ze;$e?.margins&&(Ie=Ae,Fe=$e.margins,Ae={above:Math.max((He=Ie?.above)!==null&&He!==void 0?He:0,Fe.above),below:Math.max((ze=Ie?.below)!==null&&ze!==void 0?ze:0,Fe.below)})}),new Di(Oe,Ae)}wa(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerRadius}return 0}ga(){switch(this.Hl){case"Line":case"Area":case"Baseline":{const t=this.cn.crosshairMarkerBorderColor;if(t.length!==0)return t}}return null}Ma(){switch(this.Hl){case"Line":case"Area":case"Baseline":return this.cn.crosshairMarkerBorderWidth}return 0}xa(t){switch(this.Hl){case"Line":case"Area":case"Baseline":{const i=this.cn.crosshairMarkerBackgroundColor;if(i.length!==0)return i}}return this.$s().Hs(t).ue}$l(){switch(this.cn.priceFormat.type){case"custom":this.ba={format:this.cn.priceFormat.formatter};break;case"volume":this.ba=new pt(this.cn.priceFormat.precision);break;case"percent":this.ba=new vt(this.cn.priceFormat.precision);break;default:{const t=Math.pow(10,this.cn.priceFormat.precision);this.ba=new ft(t,this.cn.priceFormat.minMove*t)}}this.Yi!==null&&this.Yi.Pa()}Jl(){const t=this.$t().St();if(!t.Ra()||this.zt.Ni())return void(this.Fl=[]);const i=b(this.zt.sl());this.Fl=this.Nl.map((s,Le)=>{const Oe=b(t.Da(s.time,!0)),Ae=Oe<i?1:-1;return{time:b(this.zt.hl(Oe,Ae)).se,position:s.position,shape:s.shape,color:s.color,id:s.id,Qr:Le,text:s.text,size:s.size,originalTime:s.originalTime}})}Ul(t){switch(this.dn=new yi(this,this.$t()),this.Hl){case"Bar":this.wn=new Ht(this,this.$t());break;case"Candlestick":this.wn=new Zt(this,this.$t());break;case"Line":this.wn=new ti(this,this.$t());break;case"Custom":this.wn=new Kt(this,this.$t(),m(t));break;case"Area":this.wn=new Ft(this,this.$t());break;case"Baseline":this.wn=new qt(this,this.$t());break;case"Histogram":this.wn=new Qt(this,this.$t());break;default:throw Error("Unknown chart style assigned: "+this.Hl)}}ua(t,i){const s=[];return Yi(this.jl,t,i,s),s}}class Ji{constructor(t){this.cn=t}Va(t,i,s){let Le=t;if(this.cn.mode===0)return Le;const Oe=s.vn(),Ae=Oe.Ct();if(Ae===null)return Le;const Ee=Oe.Rt(t,Ae),$e=s.Oa().filter(Fe=>Fe instanceof Gi).reduce((Fe,He)=>{if(s.dr(He)||!He.yt())return Fe;const ze=He.Dt(),je=He.In();if(ze.Ni()||!je.Xr(i))return Fe;const Ne=je.Kh(i);if(Ne===null)return Fe;const Ke=w(He.Ct());return Fe.concat([ze.Rt(Ne.Vt[3],Ke.Vt)])},[]);if($e.length===0)return Le;$e.sort((Fe,He)=>Math.abs(Fe-Ee)-Math.abs(He-Ee));const Ie=$e[0];return Le=Oe.pn(Ie,Ae),Le}}class Qi extends H{constructor(){super(...arguments),this.zt=null}J(t){this.zt=t}K({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:Le}){if(this.zt===null)return;const Oe=Math.max(1,Math.floor(s));t.lineWidth=Oe,function(Ae,Ee){Ae.save(),Ae.lineWidth%2&&Ae.translate(.5,.5),Ee(),Ae.restore()}(t,()=>{const Ae=b(this.zt);if(Ae.Ba){t.strokeStyle=Ae.Aa,f(t,Ae.Ia),t.beginPath();for(const Ee of Ae.za){const $e=Math.round(Ee.La*s);t.moveTo($e,-Oe),t.lineTo($e,i.height+Oe)}t.stroke()}if(Ae.Ea){t.strokeStyle=Ae.Na,f(t,Ae.Fa),t.beginPath();for(const Ee of Ae.Wa){const $e=Math.round(Ee.La*Le);t.moveTo(-Oe,$e),t.lineTo(i.width+Oe,$e)}t.stroke()}})}}class tn{constructor(t){this.Wt=new Qi,this.ft=!0,this.tn=t}bt(){this.ft=!0}gt(){if(this.ft){const t=this.tn.$t().W().grid,i={Ea:t.horzLines.visible,Ba:t.vertLines.visible,Na:t.horzLines.color,Aa:t.vertLines.color,Fa:t.horzLines.style,Ia:t.vertLines.style,Wa:this.tn.vn().ja(),za:(this.tn.$t().St().ja()||[]).map(s=>({La:s.coord}))};this.Wt.J(i),this.ft=!1}return this.Wt}}class nn{constructor(t){this.wn=new tn(t)}Uh(){return this.wn}}const sn={Ha:4,$a:1e-4};function en(n,t){const i=100*(n-t)/t;return t<0?-i:i}function rn(n,t){const i=en(n.Th(),t),s=en(n.Ph(),t);return new Ri(i,s)}function hn(n,t){const i=100*(n-t)/t+100;return t<0?-i:i}function ln(n,t){const i=hn(n.Th(),t),s=hn(n.Ph(),t);return new Ri(i,s)}function an(n,t){const i=Math.abs(n);if(i<1e-15)return 0;const s=Math.log10(i+t.$a)+t.Ha;return n<0?-s:s}function on(n,t){const i=Math.abs(n);if(i<1e-15)return 0;const s=Math.pow(10,i-t.Ha)-t.$a;return n<0?-s:s}function _n(n,t){if(n===null)return null;const i=an(n.Th(),t),s=an(n.Ph(),t);return new Ri(i,s)}function un(n,t){if(n===null)return null;const i=on(n.Th(),t),s=on(n.Ph(),t);return new Ri(i,s)}function cn(n){if(n===null)return sn;const t=Math.abs(n.Ph()-n.Th());if(t>=1||t<1e-15)return sn;const i=Math.ceil(Math.abs(Math.log10(t))),s=sn.Ha+i;return{Ha:s,$a:1/Math.pow(10,s)}}class dn{constructor(t,i){if(this.Ua=t,this.qa=i,function(s){if(s<0)return!1;for(let Le=s;Le>1;Le/=10)if(Le%10!=0)return!1;return!0}(this.Ua))this.Ya=[2,2.5,2];else{this.Ya=[];for(let s=this.Ua;s!==1;){if(s%2==0)this.Ya.push(2),s/=2;else{if(s%5!=0)throw new Error("unexpected base");this.Ya.push(2,2.5),s/=5}if(this.Ya.length>100)throw new Error("something wrong with base")}}}Za(t,i,s){const Le=this.Ua===0?0:1/this.Ua;let Oe=Math.pow(10,Math.max(0,Math.ceil(Math.log10(t-i)))),Ae=0,Ee=this.qa[0];for(;;){const He=yt(Oe,Le,1e-14)&&Oe>Le+1e-14,ze=yt(Oe,s*Ee,1e-14),je=yt(Oe,1,1e-14);if(!(He&&ze&&je))break;Oe/=Ee,Ee=this.qa[++Ae%this.qa.length]}if(Oe<=Le+1e-14&&(Oe=Le),Oe=Math.max(1,Oe),this.Ya.length>0&&($e=Oe,Ie=1,Fe=1e-14,Math.abs($e-Ie)<Fe))for(Ae=0,Ee=this.Ya[0];yt(Oe,s*Ee,1e-14)&&Oe>Le+1e-14;)Oe/=Ee,Ee=this.Ya[++Ae%this.Ya.length];var $e,Ie,Fe;return Oe}}class fn{constructor(t,i,s,Le){this.Xa=[],this.Li=t,this.Ua=i,this.Ka=s,this.Ga=Le}Za(t,i){if(t<i)throw new Error("high < low");const s=this.Li.At(),Le=(t-i)*this.Ja()/s,Oe=new dn(this.Ua,[2,2.5,2]),Ae=new dn(this.Ua,[2,2,2.5]),Ee=new dn(this.Ua,[2.5,2,2]),$e=[];return $e.push(Oe.Za(t,i,Le),Ae.Za(t,i,Le),Ee.Za(t,i,Le)),function(Ie){if(Ie.length<1)throw Error("array is empty");let Fe=Ie[0];for(let He=1;He<Ie.length;++He)Ie[He]<Fe&&(Fe=Ie[He]);return Fe}($e)}Qa(){const t=this.Li,i=t.Ct();if(i===null)return void(this.Xa=[]);const s=t.At(),Le=this.Ka(s-1,i),Oe=this.Ka(0,i),Ae=this.Li.W().entireTextOnly?this.io()/2:0,Ee=Ae,$e=s-1-Ae,Ie=Math.max(Le,Oe),Fe=Math.min(Le,Oe);if(Ie===Fe)return void(this.Xa=[]);let He=this.Za(Ie,Fe),ze=Ie%He;ze+=ze<0?He:0;const je=Ie>=Fe?1:-1;let Ne=null,Ke=0;for(let Be=Ie-ze;Be>Fe;Be-=He){const Ue=this.Ga(Be,i,!0);Ne!==null&&Math.abs(Ue-Ne)<this.Ja()||Ue<Ee||Ue>$e||(Ke<this.Xa.length?(this.Xa[Ke].La=Ue,this.Xa[Ke].no=t.so(Be)):this.Xa.push({La:Ue,no:t.so(Be)}),Ke++,Ne=Ue,t.eo()&&(He=this.Za(Be*je,Fe)))}this.Xa.length=Ke}ja(){return this.Xa}io(){return this.Li.P()}Ja(){return Math.ceil(2.5*this.io())}}function vn(n){return n.slice().sort((t,i)=>b(t.Xi())-b(i.Xi()))}var pn;(function(n){n[n.Normal=0]="Normal",n[n.Logarithmic=1]="Logarithmic",n[n.Percentage=2]="Percentage",n[n.IndexedTo100=3]="IndexedTo100"})(pn||(pn={}));const mn=new vt,bn=new ft(100,1);class wn{constructor(t,i,s,Le){this.ro=0,this.ho=null,this.Ah=null,this.lo=null,this.ao={oo:!1,_o:null},this.uo=0,this.co=0,this.do=new D,this.fo=new D,this.vo=[],this.po=null,this.mo=null,this.bo=null,this.wo=null,this.ba=bn,this.Mo=cn(null),this.xo=t,this.cn=i,this.So=s,this.ko=Le,this.yo=new fn(this,100,this.Co.bind(this),this.To.bind(this))}Ta(){return this.xo}W(){return this.cn}Hh(t){if(V(this.cn,t),this.Pa(),t.mode!==void 0&&this.Po({yr:t.mode}),t.scaleMargins!==void 0){const i=m(t.scaleMargins.top),s=m(t.scaleMargins.bottom);if(i<0||i>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${i}`);if(s<0||s>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${s}`);if(i+s>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${i+s}`);this.Ro(),this.mo=null}}Do(){return this.cn.autoScale}eo(){return this.cn.mode===1}gh(){return this.cn.mode===2}Vo(){return this.cn.mode===3}yr(){return{Wn:this.cn.autoScale,Oo:this.cn.invertScale,yr:this.cn.mode}}Po(t){const i=this.yr();let s=null;t.Wn!==void 0&&(this.cn.autoScale=t.Wn),t.yr!==void 0&&(this.cn.mode=t.yr,t.yr!==2&&t.yr!==3||(this.cn.autoScale=!0),this.ao.oo=!1),i.yr===1&&t.yr!==i.yr&&(function(Oe,Ae){if(Oe===null)return!1;const Ee=on(Oe.Th(),Ae),$e=on(Oe.Ph(),Ae);return isFinite(Ee)&&isFinite($e)}(this.Ah,this.Mo)?(s=un(this.Ah,this.Mo),s!==null&&this.Bo(s)):this.cn.autoScale=!0),t.yr===1&&t.yr!==i.yr&&(s=_n(this.Ah,this.Mo),s!==null&&this.Bo(s));const Le=i.yr!==this.cn.mode;Le&&(i.yr===2||this.gh())&&this.Pa(),Le&&(i.yr===3||this.Vo())&&this.Pa(),t.Oo!==void 0&&i.Oo!==t.Oo&&(this.cn.invertScale=t.Oo,this.Ao()),this.fo.m(i,this.yr())}Io(){return this.fo}P(){return this.So.fontSize}At(){return this.ro}zo(t){this.ro!==t&&(this.ro=t,this.Ro(),this.mo=null)}Lo(){if(this.ho)return this.ho;const t=this.At()-this.Eo()-this.No();return this.ho=t,t}zh(){return this.Fo(),this.Ah}Bo(t,i){const s=this.Ah;(i||s===null&&t!==null||s!==null&&!s.yh(t))&&(this.mo=null,this.Ah=t)}Ni(){return this.Fo(),this.ro===0||!this.Ah||this.Ah.Ni()}Wo(t){return this.Oo()?t:this.At()-1-t}Rt(t,i){return this.gh()?t=en(t,i):this.Vo()&&(t=hn(t,i)),this.To(t,i)}Qs(t,i,s){this.Fo();const Le=this.No(),Oe=b(this.zh()),Ae=Oe.Th(),Ee=Oe.Ph(),$e=this.Lo()-1,Ie=this.Oo(),Fe=$e/(Ee-Ae),He=s===void 0?0:s.from,ze=s===void 0?t.length:s.to,je=this.jo();for(let Ne=He;Ne<ze;Ne++){const Ke=t[Ne],Be=Ke._t;if(isNaN(Be))continue;let Ue=Be;je!==null&&(Ue=je(Ke._t,i));const We=Le+Fe*(Ue-Ae),Ge=Ie?We:this.ro-1-We;Ke.st=Ge}}me(t,i,s){this.Fo();const Le=this.No(),Oe=b(this.zh()),Ae=Oe.Th(),Ee=Oe.Ph(),$e=this.Lo()-1,Ie=this.Oo(),Fe=$e/(Ee-Ae),He=s===void 0?0:s.from,ze=s===void 0?t.length:s.to,je=this.jo();for(let Ne=He;Ne<ze;Ne++){const Ke=t[Ne];let Be=Ke.we,Ue=Ke.ge,We=Ke.Me,Ge=Ke.xe;je!==null&&(Be=je(Ke.we,i),Ue=je(Ke.ge,i),We=je(Ke.Me,i),Ge=je(Ke.xe,i));let qe=Le+Fe*(Be-Ae),Xe=Ie?qe:this.ro-1-qe;Ke.ve=Xe,qe=Le+Fe*(Ue-Ae),Xe=Ie?qe:this.ro-1-qe,Ke.ce=Xe,qe=Le+Fe*(We-Ae),Xe=Ie?qe:this.ro-1-qe,Ke.de=Xe,qe=Le+Fe*(Ge-Ae),Xe=Ie?qe:this.ro-1-qe,Ke.pe=Xe}}pn(t,i){const s=this.Co(t,i);return this.Ho(s,i)}Ho(t,i){let s=t;return this.gh()?s=function(Le,Oe){return Oe<0&&(Le=-Le),Le/100*Oe+Oe}(s,i):this.Vo()&&(s=function(Le,Oe){return Le-=100,Oe<0&&(Le=-Le),Le/100*Oe+Oe}(s,i)),s}Oa(){return this.vo}$o(){if(this.po)return this.po;let t=[];for(let i=0;i<this.vo.length;i++){const s=this.vo[i];s.Xi()===null&&s.Ki(i+1),t.push(s)}return t=vn(t),this.po=t,this.po}Uo(t){this.vo.indexOf(t)===-1&&(this.vo.push(t),this.Pa(),this.qo())}Yo(t){const i=this.vo.indexOf(t);if(i===-1)throw new Error("source is not attached to scale");this.vo.splice(i,1),this.vo.length===0&&(this.Po({Wn:!0}),this.Bo(null)),this.Pa(),this.qo()}Ct(){let t=null;for(const i of this.vo){const s=i.Ct();s!==null&&(t===null||s.ha<t.ha)&&(t=s)}return t===null?null:t.Vt}Oo(){return this.cn.invertScale}ja(){const t=this.Ct()===null;if(this.mo!==null&&(t||this.mo.Zo===t))return this.mo.ja;this.yo.Qa();const i=this.yo.ja();return this.mo={ja:i,Zo:t},this.do.m(),i}Xo(){return this.do}Ko(t){this.gh()||this.Vo()||this.bo===null&&this.lo===null&&(this.Ni()||(this.bo=this.ro-t,this.lo=b(this.zh()).Ch()))}Go(t){if(this.gh()||this.Vo()||this.bo===null)return;this.Po({Wn:!1}),(t=this.ro-t)<0&&(t=0);let i=(this.bo+.2*(this.ro-1))/(t+.2*(this.ro-1));const s=b(this.lo).Ch();i=Math.max(i,.1),s.Dh(i),this.Bo(s)}Jo(){this.gh()||this.Vo()||(this.bo=null,this.lo=null)}Qo(t){this.Do()||this.wo===null&&this.lo===null&&(this.Ni()||(this.wo=t,this.lo=b(this.zh()).Ch()))}t_(t){if(this.Do()||this.wo===null)return;const i=b(this.zh()).Rh()/(this.Lo()-1);let s=t-this.wo;this.Oo()&&(s*=-1);const Le=s*i,Oe=b(this.lo).Ch();Oe.Vh(Le),this.Bo(Oe,!0),this.mo=null}i_(){this.Do()||this.wo!==null&&(this.wo=null,this.lo=null)}ma(){return this.ba||this.Pa(),this.ba}Fi(t,i){switch(this.cn.mode){case 2:return this.n_(en(t,i));case 3:return this.ma().format(hn(t,i));default:return this.Fh(t)}}so(t){switch(this.cn.mode){case 2:return this.n_(t);case 3:return this.ma().format(t);default:return this.Fh(t)}}ql(t){return this.Fh(t,b(this.s_()).ma())}Yl(t,i){return t=en(t,i),this.n_(t,mn)}e_(){return this.vo}r_(t){this.ao={_o:t,oo:!1}}Vn(){this.vo.forEach(t=>t.Vn())}Pa(){this.mo=null;const t=this.s_();let i=100;t!==null&&(i=Math.round(1/t.pa())),this.ba=bn,this.gh()?(this.ba=mn,i=100):this.Vo()?(this.ba=new ft(100,1),i=100):t!==null&&(this.ba=t.ma()),this.yo=new fn(this,i,this.Co.bind(this),this.To.bind(this)),this.yo.Qa()}qo(){this.po=null}s_(){return this.vo[0]||null}Eo(){return this.Oo()?this.cn.scaleMargins.bottom*this.At()+this.co:this.cn.scaleMargins.top*this.At()+this.uo}No(){return this.Oo()?this.cn.scaleMargins.top*this.At()+this.uo:this.cn.scaleMargins.bottom*this.At()+this.co}Fo(){this.ao.oo||(this.ao.oo=!0,this.h_())}Ro(){this.ho=null}To(t,i){if(this.Fo(),this.Ni())return 0;t=this.eo()&&t?an(t,this.Mo):t;const s=b(this.zh()),Le=this.No()+(this.Lo()-1)*(t-s.Th())/s.Rh();return this.Wo(Le)}Co(t,i){if(this.Fo(),this.Ni())return 0;const s=this.Wo(t),Le=b(this.zh()),Oe=Le.Th()+Le.Rh()*((s-this.No())/(this.Lo()-1));return this.eo()?on(Oe,this.Mo):Oe}Ao(){this.mo=null,this.yo.Qa()}h_(){const t=this.ao._o;if(t===null)return;let i=null;const s=this.e_();let Le=0,Oe=0;for(const $e of s){if(!$e.yt())continue;const Ie=$e.Ct();if(Ie===null)continue;const Fe=$e.Al(t.Vs(),t.ui());let He=Fe&&Fe.zh();if(He!==null){switch(this.cn.mode){case 1:He=_n(He,this.Mo);break;case 2:He=rn(He,Ie.Vt);break;case 3:He=ln(He,Ie.Vt)}if(i=i===null?He:i.ts(b(He)),Fe!==null){const ze=Fe.Lh();ze!==null&&(Le=Math.max(Le,ze.above),Oe=Math.max(Oe,ze.below))}}}if(Le===this.uo&&Oe===this.co||(this.uo=Le,this.co=Oe,this.mo=null,this.Ro()),i!==null){if(i.Th()===i.Ph()){const $e=this.s_(),Ie=5*($e===null||this.gh()||this.Vo()?1:$e.pa());this.eo()&&(i=un(i,this.Mo)),i=new Ri(i.Th()-Ie,i.Ph()+Ie),this.eo()&&(i=_n(i,this.Mo))}if(this.eo()){const $e=un(i,this.Mo),Ie=cn($e);if(Ae=Ie,Ee=this.Mo,Ae.Ha!==Ee.Ha||Ae.$a!==Ee.$a){const Fe=this.lo!==null?un(this.lo,this.Mo):null;this.Mo=Ie,i=_n($e,Ie),Fe!==null&&(this.lo=_n(Fe,Ie))}}this.Bo(i)}else this.Ah===null&&(this.Bo(new Ri(-.5,.5)),this.Mo=cn(null));var Ae,Ee;this.ao.oo=!0}jo(){return this.gh()?en:this.Vo()?hn:this.eo()?t=>an(t,this.Mo):null}l_(t,i,s){return i===void 0?(s===void 0&&(s=this.ma()),s.format(t)):i(t)}Fh(t,i){return this.l_(t,this.ko.priceFormatter,i)}n_(t,i){return this.l_(t,this.ko.percentageFormatter,i)}}class gn{constructor(t,i){this.vo=[],this.a_=new Map,this.ro=0,this.o_=0,this.__=1e3,this.po=null,this.u_=new D,this.kl=t,this.$i=i,this.c_=new nn(this);const s=i.W();this.d_=this.f_("left",s.leftPriceScale),this.v_=this.f_("right",s.rightPriceScale),this.d_.Io().l(this.p_.bind(this,this.d_),this),this.v_.Io().l(this.p_.bind(this,this.v_),this),this.m_(s)}m_(t){if(t.leftPriceScale&&this.d_.Hh(t.leftPriceScale),t.rightPriceScale&&this.v_.Hh(t.rightPriceScale),t.localization&&(this.d_.Pa(),this.v_.Pa()),t.overlayPriceScales){const i=Array.from(this.a_.values());for(const s of i){const Le=b(s[0].Dt());Le.Hh(t.overlayPriceScales),t.localization&&Le.Pa()}}}b_(t){switch(t){case"left":return this.d_;case"right":return this.v_}return this.a_.has(t)?m(this.a_.get(t))[0].Dt():null}S(){this.$t().w_().p(this),this.d_.Io().p(this),this.v_.Io().p(this),this.vo.forEach(t=>{t.S&&t.S()}),this.u_.m()}g_(){return this.__}M_(t){this.__=t}$t(){return this.$i}Hi(){return this.o_}At(){return this.ro}x_(t){this.o_=t,this.S_()}zo(t){this.ro=t,this.d_.zo(t),this.v_.zo(t),this.vo.forEach(i=>{if(this.dr(i)){const s=i.Dt();s!==null&&s.zo(t)}}),this.S_()}Oa(){return this.vo}dr(t){const i=t.Dt();return i===null||this.d_!==i&&this.v_!==i}Uo(t,i,s){const Le=s!==void 0?s:this.y_().k_+1;this.C_(t,i,Le)}Yo(t){const i=this.vo.indexOf(t);p(i!==-1,"removeDataSource: invalid data source"),this.vo.splice(i,1);const s=b(t.Dt()).Ta();if(this.a_.has(s)){const Oe=m(this.a_.get(s)),Ae=Oe.indexOf(t);Ae!==-1&&(Oe.splice(Ae,1),Oe.length===0&&this.a_.delete(s))}const Le=t.Dt();Le&&Le.Oa().indexOf(t)>=0&&Le.Yo(t),Le!==null&&(Le.qo(),this.T_(Le)),this.po=null}pr(t){return t===this.d_?"left":t===this.v_?"right":"overlay"}P_(){return this.d_}R_(){return this.v_}D_(t,i){t.Ko(i)}V_(t,i){t.Go(i),this.S_()}O_(t){t.Jo()}B_(t,i){t.Qo(i)}A_(t,i){t.t_(i),this.S_()}I_(t){t.i_()}S_(){this.vo.forEach(t=>{t.Vn()})}vn(){let t=null;return this.$i.W().rightPriceScale.visible&&this.v_.Oa().length!==0?t=this.v_:this.$i.W().leftPriceScale.visible&&this.d_.Oa().length!==0?t=this.d_:this.vo.length!==0&&(t=this.vo[0].Dt()),t===null&&(t=this.v_),t}vr(){let t=null;return this.$i.W().rightPriceScale.visible?t=this.v_:this.$i.W().leftPriceScale.visible&&(t=this.d_),t}T_(t){t!==null&&t.Do()&&this.z_(t)}L_(t){const i=this.kl.Zs();t.Po({Wn:!0}),i!==null&&t.r_(i),this.S_()}E_(){this.z_(this.d_),this.z_(this.v_)}N_(){this.T_(this.d_),this.T_(this.v_),this.vo.forEach(t=>{this.dr(t)&&this.T_(t.Dt())}),this.S_(),this.$i.$h()}$o(){return this.po===null&&(this.po=vn(this.vo)),this.po}F_(){return this.u_}W_(){return this.c_}z_(t){const i=t.e_();if(i&&i.length>0&&!this.kl.Ni()){const s=this.kl.Zs();s!==null&&t.r_(s)}t.Vn()}y_(){const t=this.$o();if(t.length===0)return{j_:0,k_:0};let i=0,s=0;for(let Le=0;Le<t.length;Le++){const Oe=t[Le].Xi();Oe!==null&&(Oe<i&&(i=Oe),Oe>s&&(s=Oe))}return{j_:i,k_:s}}C_(t,i,s){let Le=this.b_(i);if(Le===null&&(Le=this.f_(i,this.$i.W().overlayPriceScales)),this.vo.push(t),!_t(i)){const Oe=this.a_.get(i)||[];Oe.push(t),this.a_.set(i,Oe)}Le.Uo(t),t.Gi(Le),t.Ki(s),this.T_(Le),this.po=null}p_(t,i,s){i.yr!==s.yr&&this.z_(t)}f_(t,i){const s=Object.assign({visible:!0,autoScale:!0},z(i)),Le=new wn(t,s,this.$i.W().layout,this.$i.W().localization);return Le.zo(this.At()),Le}}class Mn{constructor(t,i,s=50){this.Xe=0,this.Ke=1,this.Ge=1,this.Qe=new Map,this.Je=new Map,this.H_=t,this.U_=i,this.tr=s}q_(t){const i=t.time,s=this.U_.cacheKey(i),Le=this.Qe.get(s);if(Le!==void 0)return Le.Y_;if(this.Xe===this.tr){const Ae=this.Je.get(this.Ge);this.Je.delete(this.Ge),this.Qe.delete(m(Ae)),this.Ge++,this.Xe--}const Oe=this.H_(t);return this.Qe.set(s,{Y_:Oe,er:this.Ke}),this.Je.set(this.Ke,s),this.Xe++,this.Ke++,Oe}}class xn{constructor(t,i){p(t<=i,"right should be >= left"),this.Z_=t,this.X_=i}Vs(){return this.Z_}ui(){return this.X_}K_(){return this.X_-this.Z_+1}Xr(t){return this.Z_<=t&&t<=this.X_}yh(t){return this.Z_===t.Vs()&&this.X_===t.ui()}}function Sn(n,t){return n===null||t===null?n===t:n.yh(t)}class kn{constructor(){this.G_=new Map,this.Qe=null,this.J_=!1}Q_(t){this.J_=t,this.Qe=null}tu(t,i){this.iu(i),this.Qe=null;for(let s=i;s<t.length;++s){const Le=t[s];let Oe=this.G_.get(Le.timeWeight);Oe===void 0&&(Oe=[],this.G_.set(Le.timeWeight,Oe)),Oe.push({index:s,time:Le.time,weight:Le.timeWeight,originalTime:Le.originalTime})}}nu(t,i){const s=Math.ceil(i/t);return this.Qe!==null&&this.Qe.su===s||(this.Qe={ja:this.eu(s),su:s}),this.Qe.ja}iu(t){if(t===0)return void this.G_.clear();const i=[];this.G_.forEach((s,Le)=>{t<=s[0].index?i.push(Le):s.splice(Bt(s,t,Oe=>Oe.index<t),1/0)});for(const s of i)this.G_.delete(s)}eu(t){let i=[];for(const s of Array.from(this.G_.keys()).sort((Le,Oe)=>Oe-Le)){if(!this.G_.get(s))continue;const Le=i;i=[];const Oe=Le.length;let Ae=0;const Ee=m(this.G_.get(s)),$e=Ee.length;let Ie=1/0,Fe=-1/0;for(let He=0;He<$e;He++){const ze=Ee[He],je=ze.index;for(;Ae<Oe;){const Ne=Le[Ae],Ke=Ne.index;if(!(Ke<je)){Ie=Ke;break}Ae++,i.push(Ne),Fe=Ke,Ie=1/0}if(Ie-je>=t&&je-Fe>=t)i.push(ze),Fe=je;else if(this.J_)return Le}for(;Ae<Oe;Ae++)i.push(Le[Ae])}return i}}class yn{constructor(t){this.ru=t}hu(){return this.ru===null?null:new xn(Math.floor(this.ru.Vs()),Math.ceil(this.ru.ui()))}lu(){return this.ru}static au(){return new yn(null)}}function Cn(n,t){return n.weight>t.weight?n:t}class Tn{constructor(t,i,s,Le){this.o_=0,this.ou=null,this._u=[],this.wo=null,this.bo=null,this.uu=new kn,this.cu=new Map,this.du=yn.au(),this.fu=!0,this.vu=new D,this.pu=new D,this.mu=new D,this.bu=null,this.wu=null,this.gu=[],this.cn=i,this.ko=s,this.Mu=i.rightOffset,this.xu=i.barSpacing,this.$i=t,this.U_=Le,this.Su(),this.uu.Q_(i.uniformDistribution)}W(){return this.cn}ku(t){V(this.ko,t),this.yu(),this.Su()}Hh(t,i){var s;V(this.cn,t),this.cn.fixLeftEdge&&this.Cu(),this.cn.fixRightEdge&&this.Tu(),t.barSpacing!==void 0&&this.$i.Gn(t.barSpacing),t.rightOffset!==void 0&&this.$i.Jn(t.rightOffset),t.minBarSpacing!==void 0&&this.$i.Gn((s=t.barSpacing)!==null&&s!==void 0?s:this.xu),this.yu(),this.Su(),this.mu.m()}mn(t){var i,s;return(s=(i=this._u[t])===null||i===void 0?void 0:i.time)!==null&&s!==void 0?s:null}Ui(t){var i;return(i=this._u[t])!==null&&i!==void 0?i:null}Da(t,i){if(this._u.length<1)return null;if(this.U_.key(t)>this.U_.key(this._u[this._u.length-1].time))return i?this._u.length-1:null;const s=Bt(this._u,this.U_.key(t),(Le,Oe)=>this.U_.key(Le.time)<Oe);return this.U_.key(t)<this.U_.key(this._u[s].time)?i?s:null:s}Ni(){return this.o_===0||this._u.length===0||this.ou===null}Ra(){return this._u.length>0}Zs(){return this.Pu(),this.du.hu()}Ru(){return this.Pu(),this.du.lu()}Du(){const t=this.Zs();if(t===null)return null;const i={from:t.Vs(),to:t.ui()};return this.Vu(i)}Vu(t){const i=Math.round(t.from),s=Math.round(t.to),Le=b(this.Ou()),Oe=b(this.Bu());return{from:b(this.Ui(Math.max(Le,i))),to:b(this.Ui(Math.min(Oe,s)))}}Au(t){return{from:b(this.Da(t.from,!0)),to:b(this.Da(t.to,!0))}}Hi(){return this.o_}x_(t){if(!isFinite(t)||t<=0||this.o_===t)return;const i=this.Ru(),s=this.o_;if(this.o_=t,this.fu=!0,this.cn.lockVisibleTimeRangeOnResize&&s!==0){const Le=this.xu*t/s;this.xu=Le}if(this.cn.fixLeftEdge&&i!==null&&i.Vs()<=0){const Le=s-t;this.Mu-=Math.round(Le/this.xu)+1,this.fu=!0}this.Iu(),this.zu()}It(t){if(this.Ni()||!B(t))return 0;const i=this.Lu()+this.Mu-t;return this.o_-(i+.5)*this.xu-1}Js(t,i){const s=this.Lu(),Le=i===void 0?0:i.from,Oe=i===void 0?t.length:i.to;for(let Ae=Le;Ae<Oe;Ae++){const Ee=t[Ae].ot,$e=s+this.Mu-Ee,Ie=this.o_-($e+.5)*this.xu-1;t[Ae].nt=Ie}}Eu(t){return Math.ceil(this.Nu(t))}Jn(t){this.fu=!0,this.Mu=t,this.zu(),this.$i.Fu(),this.$i.$h()}he(){return this.xu}Gn(t){this.Wu(t),this.zu(),this.$i.Fu(),this.$i.$h()}ju(){return this.Mu}ja(){if(this.Ni())return null;if(this.wu!==null)return this.wu;const t=this.xu,i=5*(this.$i.W().layout.fontSize+4)/8*(this.cn.tickMarkMaxCharacterLength||8),s=Math.round(i/t),Le=b(this.Zs()),Oe=Math.max(Le.Vs(),Le.Vs()-s),Ae=Math.max(Le.ui(),Le.ui()-s),Ee=this.uu.nu(t,i),$e=this.Ou()+s,Ie=this.Bu()-s,Fe=this.Hu(),He=this.cn.fixLeftEdge||Fe,ze=this.cn.fixRightEdge||Fe;let je=0;for(const Ne of Ee){if(!(Oe<=Ne.index&&Ne.index<=Ae))continue;let Ke;je<this.gu.length?(Ke=this.gu[je],Ke.coord=this.It(Ne.index),Ke.label=this.$u(Ne),Ke.weight=Ne.weight):(Ke={needAlignCoordinate:!1,coord:this.It(Ne.index),label:this.$u(Ne),weight:Ne.weight},this.gu.push(Ke)),this.xu>i/2&&!Fe?Ke.needAlignCoordinate=!1:Ke.needAlignCoordinate=He&&Ne.index<=$e||ze&&Ne.index>=Ie,je++}return this.gu.length=je,this.wu=this.gu,this.gu}Uu(){this.fu=!0,this.Gn(this.cn.barSpacing),this.Jn(this.cn.rightOffset)}qu(t){this.fu=!0,this.ou=t,this.zu(),this.Cu()}Yu(t,i){const s=this.Nu(t),Le=this.he(),Oe=Le+i*(Le/10);this.Gn(Oe),this.cn.rightBarStaysOnScroll||this.Jn(this.ju()+(s-this.Nu(t)))}Ko(t){this.wo&&this.i_(),this.bo===null&&this.bu===null&&(this.Ni()||(this.bo=t,this.Zu()))}Go(t){if(this.bu===null)return;const i=kt(this.o_-t,0,this.o_),s=kt(this.o_-b(this.bo),0,this.o_);i!==0&&s!==0&&this.Gn(this.bu.he*i/s)}Jo(){this.bo!==null&&(this.bo=null,this.Xu())}Qo(t){this.wo===null&&this.bu===null&&(this.Ni()||(this.wo=t,this.Zu()))}t_(t){if(this.wo===null)return;const i=(this.wo-t)/this.he();this.Mu=b(this.bu).ju+i,this.fu=!0,this.zu()}i_(){this.wo!==null&&(this.wo=null,this.Xu())}Ku(){this.Gu(this.cn.rightOffset)}Gu(t,i=400){if(!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(i)||i<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const s=this.Mu,Le=performance.now();this.$i.Zn({Ju:Oe=>(Oe-Le)/i>=1,Qu:Oe=>{const Ae=(Oe-Le)/i;return Ae>=1?t:s+(t-s)*Ae}})}bt(t,i){this.fu=!0,this._u=t,this.uu.tu(t,i),this.zu()}tc(){return this.vu}nc(){return this.pu}sc(){return this.mu}Lu(){return this.ou||0}ec(t){const i=t.K_();this.Wu(this.o_/i),this.Mu=t.ui()-this.Lu(),this.zu(),this.fu=!0,this.$i.Fu(),this.$i.$h()}rc(){const t=this.Ou(),i=this.Bu();t!==null&&i!==null&&this.ec(new xn(t,i+this.cn.rightOffset))}hc(t){const i=new xn(t.from,t.to);this.ec(i)}qi(t){return this.ko.timeFormatter!==void 0?this.ko.timeFormatter(t.originalTime):this.U_.formatHorzItem(t.time)}Hu(){const{handleScroll:t,handleScale:i}=this.$i.W();return!(t.horzTouchDrag||t.mouseWheel||t.pressedMouseMove||t.vertTouchDrag||i.axisDoubleClickReset.time||i.axisPressedMouseMove.time||i.mouseWheel||i.pinch)}Ou(){return this._u.length===0?null:0}Bu(){return this._u.length===0?null:this._u.length-1}lc(t){return(this.o_-1-t)/this.xu}Nu(t){const i=this.lc(t),s=this.Lu()+this.Mu-i;return Math.round(1e6*s)/1e6}Wu(t){const i=this.xu;this.xu=t,this.Iu(),i!==this.xu&&(this.fu=!0,this.ac())}Pu(){if(!this.fu)return;if(this.fu=!1,this.Ni())return void this.oc(yn.au());const t=this.Lu(),i=this.o_/this.xu,s=this.Mu+t,Le=new xn(s-i+1,s);this.oc(new yn(Le))}Iu(){const t=this._c();if(this.xu<t&&(this.xu=t,this.fu=!0),this.o_!==0){const i=.5*this.o_;this.xu>i&&(this.xu=i,this.fu=!0)}}_c(){return this.cn.fixLeftEdge&&this.cn.fixRightEdge&&this._u.length!==0?this.o_/this._u.length:this.cn.minBarSpacing}zu(){const t=this.uc();this.Mu>t&&(this.Mu=t,this.fu=!0);const i=this.cc();i!==null&&this.Mu<i&&(this.Mu=i,this.fu=!0)}cc(){const t=this.Ou(),i=this.ou;return t===null||i===null?null:t-i-1+(this.cn.fixLeftEdge?this.o_/this.xu:Math.min(2,this._u.length))}uc(){return this.cn.fixRightEdge?0:this.o_/this.xu-Math.min(2,this._u.length)}Zu(){this.bu={he:this.he(),ju:this.ju()}}Xu(){this.bu=null}$u(t){let i=this.cu.get(t.weight);return i===void 0&&(i=new Mn(s=>this.dc(s),this.U_),this.cu.set(t.weight,i)),i.q_(t)}dc(t){return this.U_.formatTickmark(t,this.ko)}oc(t){const i=this.du;this.du=t,Sn(i.hu(),this.du.hu())||this.vu.m(),Sn(i.lu(),this.du.lu())||this.pu.m(),this.ac()}ac(){this.wu=null}yu(){this.ac(),this.cu.clear()}Su(){this.U_.updateFormatter(this.ko)}Cu(){if(!this.cn.fixLeftEdge)return;const t=this.Ou();if(t===null)return;const i=this.Zs();if(i===null)return;const s=i.Vs()-t;if(s<0){const Le=this.Mu-s-1;this.Jn(Le)}this.Iu()}Tu(){this.zu(),this.Iu()}}class Pn{X(t,i,s){t.useMediaCoordinateSpace(Le=>this.K(Le,i,s))}wl(t,i,s){t.useMediaCoordinateSpace(Le=>this.fc(Le,i,s))}fc(t,i,s){}}class Rn extends Pn{constructor(t){super(),this.vc=new Map,this.zt=t}K(t){}fc(t){if(!this.zt.yt)return;const{context:i,mediaSize:s}=t;let Le=0;for(const Ae of this.zt.mc){if(Ae.Kt.length===0)continue;i.font=Ae.R;const Ee=this.bc(i,Ae.Kt);Ee>s.width?Ae.Yu=s.width/Ee:Ae.Yu=1,Le+=Ae.wc*Ae.Yu}let Oe=0;switch(this.zt.gc){case"top":Oe=0;break;case"center":Oe=Math.max((s.height-Le)/2,0);break;case"bottom":Oe=Math.max(s.height-Le,0)}i.fillStyle=this.zt.V;for(const Ae of this.zt.mc){i.save();let Ee=0;switch(this.zt.Mc){case"left":i.textAlign="left",Ee=Ae.wc/2;break;case"center":i.textAlign="center",Ee=s.width/2;break;case"right":i.textAlign="right",Ee=s.width-1-Ae.wc/2}i.translate(Ee,Oe),i.textBaseline="top",i.font=Ae.R,i.scale(Ae.Yu,Ae.Yu),i.fillText(Ae.Kt,0,Ae.xc),i.restore(),Oe+=Ae.wc*Ae.Yu}}bc(t,i){const s=this.Sc(t.font);let Le=s.get(i);return Le===void 0&&(Le=t.measureText(i).width,s.set(i,Le)),Le}Sc(t){let i=this.vc.get(t);return i===void 0&&(i=new Map,this.vc.set(t,i)),i}}class Dn{constructor(t){this.ft=!0,this.Ft={yt:!1,V:"",mc:[],gc:"center",Mc:"center"},this.Wt=new Rn(this.Ft),this.jt=t}bt(){this.ft=!0}gt(){return this.ft&&(this.Mt(),this.ft=!1),this.Wt}Mt(){const t=this.jt.W(),i=this.Ft;i.yt=t.visible,i.yt&&(i.V=t.color,i.Mc=t.horzAlign,i.gc=t.vertAlign,i.mc=[{Kt:t.text,R:F(t.fontSize,t.fontFamily,t.fontStyle),wc:1.2*t.fontSize,xc:0,Yu:0}])}}class Vn extends lt{constructor(t,i){super(),this.cn=i,this.wn=new Dn(this)}Rn(){return[]}Pn(){return[this.wn]}W(){return this.cn}Vn(){this.wn.bt()}}var On,Bn,An,In,zn;(function(n){n[n.OnTouchEnd=0]="OnTouchEnd",n[n.OnNextTap=1]="OnNextTap"})(On||(On={}));class Ln{constructor(t,i,s){this.kc=[],this.yc=[],this.o_=0,this.Cc=null,this.Tc=new D,this.Pc=new D,this.Rc=null,this.Dc=t,this.cn=i,this.U_=s,this.Vc=new W(this),this.kl=new Tn(this,i.timeScale,this.cn.localization,s),this.vt=new ot(this,i.crosshair),this.Oc=new Ji(i.crosshair),this.Bc=new Vn(this,i.watermark),this.Ac(),this.kc[0].M_(2e3),this.Ic=this.zc(0),this.Lc=this.zc(1)}Xl(){this.Ec(ut.es())}$h(){this.Ec(ut.ss())}aa(){this.Ec(new ut(1))}Kl(t){const i=this.Nc(t);this.Ec(i)}Fc(){return this.Cc}Wc(t){const i=this.Cc;this.Cc=t,i!==null&&this.Kl(i.jc),t!==null&&this.Kl(t.jc)}W(){return this.cn}Hh(t){V(this.cn,t),this.kc.forEach(i=>i.m_(t)),t.timeScale!==void 0&&this.kl.Hh(t.timeScale),t.localization!==void 0&&this.kl.ku(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.Tc.m(),this.Ic=this.zc(0),this.Lc=this.zc(1),this.Xl()}Hc(t,i){if(t==="left")return void this.Hh({leftPriceScale:i});if(t==="right")return void this.Hh({rightPriceScale:i});const s=this.$c(t);s!==null&&(s.Dt.Hh(i),this.Tc.m())}$c(t){for(const i of this.kc){const s=i.b_(t);if(s!==null)return{Ht:i,Dt:s}}return null}St(){return this.kl}Uc(){return this.kc}qc(){return this.Bc}Yc(){return this.vt}Zc(){return this.Pc}Xc(t,i){t.zo(i),this.Fu()}x_(t){this.o_=t,this.kl.x_(this.o_),this.kc.forEach(i=>i.x_(t)),this.Fu()}Ac(t){const i=new gn(this.kl,this);t!==void 0?this.kc.splice(t,0,i):this.kc.push(i);const s=t===void 0?this.kc.length-1:t,Le=ut.es();return Le.Nn(s,{Fn:0,Wn:!0}),this.Ec(Le),i}D_(t,i,s){t.D_(i,s)}V_(t,i,s){t.V_(i,s),this.Gl(),this.Ec(this.Kc(t,2))}O_(t,i){t.O_(i),this.Ec(this.Kc(t,2))}B_(t,i,s){i.Do()||t.B_(i,s)}A_(t,i,s){i.Do()||(t.A_(i,s),this.Gl(),this.Ec(this.Kc(t,2)))}I_(t,i){i.Do()||(t.I_(i),this.Ec(this.Kc(t,2)))}L_(t,i){t.L_(i),this.Ec(this.Kc(t,2))}Gc(t){this.kl.Ko(t)}Jc(t,i){const s=this.St();if(s.Ni()||i===0)return;const Le=s.Hi();t=Math.max(1,Math.min(t,Le)),s.Yu(t,i),this.Fu()}Qc(t){this.td(0),this.nd(t),this.sd()}ed(t){this.kl.Go(t),this.Fu()}rd(){this.kl.Jo(),this.$h()}td(t){this.kl.Qo(t)}nd(t){this.kl.t_(t),this.Fu()}sd(){this.kl.i_(),this.$h()}wt(){return this.yc}hd(t,i,s,Le,Oe){this.vt.gn(t,i);let Ae=NaN,Ee=this.kl.Eu(t);const $e=this.kl.Zs();$e!==null&&(Ee=Math.min(Math.max($e.Vs(),Ee),$e.ui()));const Ie=Le.vn(),Fe=Ie.Ct();Fe!==null&&(Ae=Ie.pn(i,Fe)),Ae=this.Oc.Va(Ae,Ee,Le),this.vt.kn(Ee,Ae,Le),this.aa(),Oe||this.Pc.m(this.vt.xt(),{x:t,y:i},s)}ld(t,i,s){const Le=s.vn(),Oe=Le.Ct(),Ae=Le.Rt(t,b(Oe)),Ee=this.kl.Da(i,!0),$e=this.kl.It(b(Ee));this.hd($e,Ae,null,s,!0)}ad(t){this.Yc().Cn(),this.aa(),t||this.Pc.m(null,null,null)}Gl(){const t=this.vt.Ht();if(t!==null){const i=this.vt.xn(),s=this.vt.Sn();this.hd(i,s,null,t)}this.vt.Vn()}od(t,i,s){const Le=this.kl.mn(0);i!==void 0&&s!==void 0&&this.kl.bt(i,s);const Oe=this.kl.mn(0),Ae=this.kl.Lu(),Ee=this.kl.Zs();if(Ee!==null&&Le!==null&&Oe!==null){const $e=Ee.Xr(Ae),Ie=this.U_.key(Le)>this.U_.key(Oe),Fe=t!==null&&t>Ae&&!Ie,He=this.kl.W().allowShiftVisibleRangeOnWhitespaceReplacement,ze=$e&&(s!==void 0||He)&&this.kl.W().shiftVisibleRangeOnNewBar;if(Fe&&!ze){const je=t-Ae;this.kl.Jn(this.kl.ju()-je)}}this.kl.qu(t)}ta(t){t!==null&&t.N_()}cr(t){const i=this.kc.find(s=>s.$o().includes(t));return i===void 0?null:i}Fu(){this.Bc.Vn(),this.kc.forEach(t=>t.N_()),this.Gl()}S(){this.kc.forEach(t=>t.S()),this.kc.length=0,this.cn.localization.priceFormatter=void 0,this.cn.localization.percentageFormatter=void 0,this.cn.localization.timeFormatter=void 0}_d(){return this.Vc}mr(){return this.Vc.W()}w_(){return this.Tc}ud(t,i,s){const Le=this.kc[0],Oe=this.dd(i,t,Le,s);return this.yc.push(Oe),this.yc.length===1?this.Xl():this.$h(),Oe}fd(t){const i=this.cr(t),s=this.yc.indexOf(t);p(s!==-1,"Series not found"),this.yc.splice(s,1),b(i).Yo(t),t.S&&t.S()}Zl(t,i){const s=b(this.cr(t));s.Yo(t);const Le=this.$c(i);if(Le===null){const Oe=t.Xi();s.Uo(t,i,Oe)}else{const Oe=Le.Ht===s?t.Xi():void 0;Le.Ht.Uo(t,i,Oe)}}rc(){const t=ut.ss();t.$n(),this.Ec(t)}vd(t){const i=ut.ss();i.Yn(t),this.Ec(i)}Kn(){const t=ut.ss();t.Kn(),this.Ec(t)}Gn(t){const i=ut.ss();i.Gn(t),this.Ec(i)}Jn(t){const i=ut.ss();i.Jn(t),this.Ec(i)}Zn(t){const i=ut.ss();i.Zn(t),this.Ec(i)}Un(){const t=ut.ss();t.Un(),this.Ec(t)}pd(){return this.cn.rightPriceScale.visible?"right":"left"}md(){return this.Lc}q(){return this.Ic}Bt(t){const i=this.Lc,s=this.Ic;if(i===s)return i;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.Rc===null||this.Rc.Ts!==s||this.Rc.Ps!==i)this.Rc={Ts:s,Ps:i,bd:new Map};else{const Oe=this.Rc.bd.get(t);if(Oe!==void 0)return Oe}const Le=function(Oe,Ae,Ee){const[$e,Ie,Fe,He]=T(Oe),[ze,je,Ne,Ke]=T(Ae),Be=[M($e+Ee*(ze-$e)),M(Ie+Ee*(je-Ie)),M(Fe+Ee*(Ne-Fe)),x(He+Ee*(Ke-He))];return`rgba(${Be[0]}, ${Be[1]}, ${Be[2]}, ${Be[3]})`}(s,i,t/100);return this.Rc.bd.set(t,Le),Le}Kc(t,i){const s=new ut(i);if(t!==null){const Le=this.kc.indexOf(t);s.Nn(Le,{Fn:i})}return s}Nc(t,i){return i===void 0&&(i=2),this.Kc(this.cr(t),i)}Ec(t){this.Dc&&this.Dc(t),this.kc.forEach(i=>i.W_().Uh().bt())}dd(t,i,s,Le){const Oe=new Gi(this,t,i,s,Le),Ae=t.priceScaleId!==void 0?t.priceScaleId:this.pd();return s.Uo(Oe,Ae),_t(Ae)||Oe.Hh(t),Oe}zc(t){const i=this.cn.layout;return i.background.type==="gradient"?t===0?i.background.topColor:i.background.bottomColor:i.background.color}}function En(n){return!O(n)&&!A(n)}function Nn(n){return O(n)}(function(n){n[n.Disabled=0]="Disabled",n[n.Continuous=1]="Continuous",n[n.OnDataUpdate=2]="OnDataUpdate"})(Bn||(Bn={})),function(n){n[n.LastBar=0]="LastBar",n[n.LastVisible=1]="LastVisible"}(An||(An={})),function(n){n.Solid="solid",n.VerticalGradient="gradient"}(In||(In={})),function(n){n[n.Year=0]="Year",n[n.Month=1]="Month",n[n.DayOfMonth=2]="DayOfMonth",n[n.Time=3]="Time",n[n.TimeWithSeconds=4]="TimeWithSeconds"}(zn||(zn={}));const Fn=n=>n.getUTCFullYear();function Wn(n,t,i){return t.replace(/yyyy/g,(s=>dt(Fn(s),4))(n)).replace(/yy/g,(s=>dt(Fn(s)%100,2))(n)).replace(/MMMM/g,((s,Le)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(Le,{month:"long"}))(n,i)).replace(/MMM/g,((s,Le)=>new Date(s.getUTCFullYear(),s.getUTCMonth(),1).toLocaleString(Le,{month:"short"}))(n,i)).replace(/MM/g,(s=>dt((Le=>Le.getUTCMonth()+1)(s),2))(n)).replace(/dd/g,(s=>dt((Le=>Le.getUTCDate())(s),2))(n))}class jn{constructor(t="yyyy-MM-dd",i="default"){this.wd=t,this.gd=i}q_(t){return Wn(t,this.wd,this.gd)}}class Hn{constructor(t){this.Md=t||"%h:%m:%s"}q_(t){return this.Md.replace("%h",dt(t.getUTCHours(),2)).replace("%m",dt(t.getUTCMinutes(),2)).replace("%s",dt(t.getUTCSeconds(),2))}}const $n={xd:"yyyy-MM-dd",Sd:"%h:%m:%s",kd:" ",yd:"default"};class Un{constructor(t={}){const i=Object.assign(Object.assign({},$n),t);this.Cd=new jn(i.xd,i.yd),this.Td=new Hn(i.Sd),this.Pd=i.kd}q_(t){return`${this.Cd.q_(t)}${this.Pd}${this.Td.q_(t)}`}}function qn(n){return 60*n*60*1e3}function Yn(n){return 60*n*1e3}const Zn=[{Rd:(Xn=1,1e3*Xn),Dd:10},{Rd:Yn(1),Dd:20},{Rd:Yn(5),Dd:21},{Rd:Yn(30),Dd:22},{Rd:qn(1),Dd:30},{Rd:qn(3),Dd:31},{Rd:qn(6),Dd:32},{Rd:qn(12),Dd:33}];var Xn;function Kn(n,t){if(n.getUTCFullYear()!==t.getUTCFullYear())return 70;if(n.getUTCMonth()!==t.getUTCMonth())return 60;if(n.getUTCDate()!==t.getUTCDate())return 50;for(let i=Zn.length-1;i>=0;--i)if(Math.floor(t.getTime()/Zn[i].Rd)!==Math.floor(n.getTime()/Zn[i].Rd))return Zn[i].Dd;return 0}function Gn(n){let t=n;if(A(n)&&(t=Qn(n)),!En(t))throw new Error("time must be of type BusinessDay");const i=new Date(Date.UTC(t.year,t.month-1,t.day,0,0,0,0));return{Vd:Math.round(i.getTime()/1e3),Od:t}}function Jn(n){if(!Nn(n))throw new Error("time must be of type isUTCTimestamp");return{Vd:n}}function Qn(n){const t=new Date(n);if(isNaN(t.getTime()))throw new Error(`Invalid date string=${n}, expected format=yyyy-mm-dd`);return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function ts(n){A(n.time)&&(n.time=Qn(n.time))}class is{options(){return this.cn}setOptions(t){this.cn=t,this.updateFormatter(t.localization)}preprocessData(t){Array.isArray(t)?function(i){i.forEach(ts)}(t):ts(t)}createConverterToInternalObj(t){return b(function(i){return i.length===0?null:En(i[0].time)||A(i[0].time)?Gn:Jn}(t))}key(t){return typeof t=="object"&&"Vd"in t?t.Vd:this.key(this.convertHorzItemToInternal(t))}cacheKey(t){const i=t;return i.Od===void 0?new Date(1e3*i.Vd).getTime():new Date(Date.UTC(i.Od.year,i.Od.month-1,i.Od.day)).getTime()}convertHorzItemToInternal(t){return Nn(i=t)?Jn(i):En(i)?Gn(i):Gn(Qn(i));var i}updateFormatter(t){if(!this.cn)return;const i=t.dateFormat;this.cn.timeScale.timeVisible?this.Bd=new Un({xd:i,Sd:this.cn.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",kd:"   ",yd:t.locale}):this.Bd=new jn(i,t.locale)}formatHorzItem(t){const i=t;return this.Bd.q_(new Date(1e3*i.Vd))}formatTickmark(t,i){const s=function(Oe,Ae,Ee){switch(Oe){case 0:case 10:return Ae?Ee?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return Ae?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(t.weight,this.cn.timeScale.timeVisible,this.cn.timeScale.secondsVisible),Le=this.cn.timeScale;if(Le.tickMarkFormatter!==void 0){const Oe=Le.tickMarkFormatter(t.originalTime,s,i.locale);if(Oe!==null)return Oe}return function(Oe,Ae,Ee){const $e={};switch(Ae){case 0:$e.year="numeric";break;case 1:$e.month="short";break;case 2:$e.day="numeric";break;case 3:$e.hour12=!1,$e.hour="2-digit",$e.minute="2-digit";break;case 4:$e.hour12=!1,$e.hour="2-digit",$e.minute="2-digit",$e.second="2-digit"}const Ie=Oe.Od===void 0?new Date(1e3*Oe.Vd):new Date(Date.UTC(Oe.Od.year,Oe.Od.month-1,Oe.Od.day));return new Date(Ie.getUTCFullYear(),Ie.getUTCMonth(),Ie.getUTCDate(),Ie.getUTCHours(),Ie.getUTCMinutes(),Ie.getUTCSeconds(),Ie.getUTCMilliseconds()).toLocaleString(Ee,$e)}(t.time,s,i.locale)}maxTickMarkWeight(t){let i=t.reduce(Cn,t[0]).weight;return i>30&&i<50&&(i=30),i}fillWeightsForPoints(t,i){(function(s,Le=0){if(s.length===0)return;let Oe=Le===0?null:s[Le-1].time.Vd,Ae=Oe!==null?new Date(1e3*Oe):null,Ee=0;for(let $e=Le;$e<s.length;++$e){const Ie=s[$e],Fe=new Date(1e3*Ie.time.Vd);Ae!==null&&(Ie.timeWeight=Kn(Fe,Ae)),Ee+=Ie.time.Vd-(Oe||Ie.time.Vd),Oe=Ie.time.Vd,Ae=Fe}if(Le===0&&s.length>1){const $e=Math.ceil(Ee/(s.length-1)),Ie=new Date(1e3*(s[0].time.Vd-$e));s[0].timeWeight=Kn(new Date(1e3*s[0].time.Vd),Ie)}})(t,i)}static Ad(t){return V({localization:{dateFormat:"dd MMM 'yy"}},t??{})}}const ns=typeof window<"u";function ss(){return!!ns&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function es(){return!!ns&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function rs(n){return n+n%2}function hs(n,t){return n.Id-t.Id}function ls(n,t,i){const s=(n.Id-t.Id)/(n.ot-t.ot);return Math.sign(s)*Math.min(Math.abs(s),i)}class as{constructor(t,i,s,Le){this.zd=null,this.Ld=null,this.Ed=null,this.Nd=null,this.Fd=null,this.Wd=0,this.jd=0,this.Hd=t,this.$d=i,this.Ud=s,this.rs=Le}qd(t,i){if(this.zd!==null){if(this.zd.ot===i)return void(this.zd.Id=t);if(Math.abs(this.zd.Id-t)<this.rs)return}this.Nd=this.Ed,this.Ed=this.Ld,this.Ld=this.zd,this.zd={ot:i,Id:t}}Dr(t,i){if(this.zd===null||this.Ld===null||i-this.zd.ot>50)return;let s=0;const Le=ls(this.zd,this.Ld,this.$d),Oe=hs(this.zd,this.Ld),Ae=[Le],Ee=[Oe];if(s+=Oe,this.Ed!==null){const Ie=ls(this.Ld,this.Ed,this.$d);if(Math.sign(Ie)===Math.sign(Le)){const Fe=hs(this.Ld,this.Ed);if(Ae.push(Ie),Ee.push(Fe),s+=Fe,this.Nd!==null){const He=ls(this.Ed,this.Nd,this.$d);if(Math.sign(He)===Math.sign(Le)){const ze=hs(this.Ed,this.Nd);Ae.push(He),Ee.push(ze),s+=ze}}}}let $e=0;for(let Ie=0;Ie<Ae.length;++Ie)$e+=Ee[Ie]/s*Ae[Ie];Math.abs($e)<this.Hd||(this.Fd={Id:t,ot:i},this.jd=$e,this.Wd=function(Ie,Fe){const He=Math.log(Fe);return Math.log(1*He/-Ie)/He}(Math.abs($e),this.Ud))}Qu(t){const i=b(this.Fd),s=t-i.ot;return i.Id+this.jd*(Math.pow(this.Ud,s)-1)/Math.log(this.Ud)}Ju(t){return this.Fd===null||this.Yd(t)===this.Wd}Yd(t){const i=t-b(this.Fd).ot;return Math.min(i,this.Wd)}}class os{constructor(t,i){this.Zd=void 0,this.Xd=void 0,this.Kd=void 0,this.en=!1,this.Gd=t,this.Jd=i,this.Qd()}bt(){this.Qd()}tf(){this.Zd&&this.Gd.removeChild(this.Zd),this.Xd&&this.Gd.removeChild(this.Xd),this.Zd=void 0,this.Xd=void 0}if(){return this.en!==this.nf()||this.Kd!==this.sf()}sf(){return P(T(this.Jd.W().layout.textColor))>160?"dark":"light"}nf(){return this.Jd.W().layout.attributionLogo}ef(){const t=new URL(location.href);return t.hostname?"&utm_source="+t.hostname+t.pathname:""}Qd(){this.if()&&(this.tf(),this.en=this.nf(),this.en&&(this.Kd=this.sf(),this.Xd=document.createElement("style"),this.Xd.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.Zd=document.createElement("a"),this.Zd.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.ef()}`,this.Zd.title="Charting by TradingView",this.Zd.id="tv-attr-logo",this.Zd.target="_blank",this.Zd.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 19" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.Zd.toggleAttribute("data-dark",this.Kd==="dark"),this.Gd.appendChild(this.Xd),this.Gd.appendChild(this.Zd)))}}function _s(n,t){const i=b(n.ownerDocument).createElement("canvas");n.appendChild(i);const s=bindTo(i,{type:"device-pixel-content-box",options:{allowResizeObserver:!1},transform:(Le,Oe)=>({width:Math.max(Le.width,Oe.width),height:Math.max(Le.height,Oe.height)})});return s.resizeCanvasElement(t),s}function us(n){var t;n.width=1,n.height=1,(t=n.getContext("2d"))===null||t===void 0||t.clearRect(0,0,1,1)}function cs(n,t,i,s){n.wl&&n.wl(t,i,s)}function ds(n,t,i,s){n.X(t,i,s)}function fs(n,t,i,s){const Le=n(i,s);for(const Oe of Le){const Ae=Oe.gt();Ae!==null&&t(Ae)}}function vs(n){ns&&window.chrome!==void 0&&n.addEventListener("mousedown",t=>{if(t.button===1)return t.preventDefault(),!1})}class ps{constructor(t,i,s){this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY},this.cf=null,this.df=!1,this.ff=null,this.vf=null,this.pf=!1,this.mf=!1,this.bf=!1,this.wf=null,this.gf=null,this.Mf=null,this.xf=null,this.Sf=null,this.kf=null,this.yf=null,this.Cf=0,this.Tf=!1,this.Pf=!1,this.Rf=!1,this.Df=0,this.Vf=null,this.Of=!es(),this.Bf=Le=>{this.Af(Le)},this.If=Le=>{if(this.zf(Le)){const Oe=this.Lf(Le);if(++this.af,this._f&&this.af>1){const{Ef:Ae}=this.Nf(ws(Le),this.uf);Ae<30&&!this.bf&&this.Ff(Oe,this.jf.Wf),this.Hf()}}else{const Oe=this.Lf(Le);if(++this.rf,this.hf&&this.rf>1){const{Ef:Ae}=this.Nf(ws(Le),this.lf);Ae<5&&!this.mf&&this.$f(Oe,this.jf.Uf),this.qf()}}},this.Yf=t,this.jf=i,this.cn=s,this.Zf()}S(){this.wf!==null&&(this.wf(),this.wf=null),this.gf!==null&&(this.gf(),this.gf=null),this.xf!==null&&(this.xf(),this.xf=null),this.Sf!==null&&(this.Sf(),this.Sf=null),this.kf!==null&&(this.kf(),this.kf=null),this.Mf!==null&&(this.Mf(),this.Mf=null),this.Xf(),this.qf()}Kf(t){this.xf&&this.xf();const i=this.Gf.bind(this);if(this.xf=()=>{this.Yf.removeEventListener("mousemove",i)},this.Yf.addEventListener("mousemove",i),this.zf(t))return;const s=this.Lf(t);this.$f(s,this.jf.Jf),this.Of=!0}qf(){this.hf!==null&&clearTimeout(this.hf),this.rf=0,this.hf=null,this.lf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Hf(){this._f!==null&&clearTimeout(this._f),this.af=0,this._f=null,this.uf={nt:Number.NEGATIVE_INFINITY,st:Number.POSITIVE_INFINITY}}Gf(t){if(this.Rf||this.vf!==null||this.zf(t))return;const i=this.Lf(t);this.$f(i,this.jf.Qf),this.Of=!0}tv(t){const i=Ms(t.changedTouches,b(this.Vf));if(i===null||(this.Df=gs(t),this.yf!==null)||this.Pf)return;this.Tf=!0;const s=this.Nf(ws(i),b(this.vf)),{iv:Le,nv:Oe,Ef:Ae}=s;if(this.pf||!(Ae<5)){if(!this.pf){const Ee=.5*Le,$e=Oe>=Ee&&!this.cn.sv(),Ie=Ee>Oe&&!this.cn.ev();$e||Ie||(this.Pf=!0),this.pf=!0,this.bf=!0,this.Xf(),this.Hf()}if(!this.Pf){const Ee=this.Lf(t,i);this.Ff(Ee,this.jf.rv),bs(t)}}}hv(t){if(t.button!==0)return;const i=this.Nf(ws(t),b(this.ff)),{Ef:s}=i;if(s>=5&&(this.mf=!0,this.qf()),this.mf){const Le=this.Lf(t);this.$f(Le,this.jf.lv)}}Nf(t,i){const s=Math.abs(i.nt-t.nt),Le=Math.abs(i.st-t.st);return{iv:s,nv:Le,Ef:s+Le}}av(t){let i=Ms(t.changedTouches,b(this.Vf));if(i===null&&t.touches.length===0&&(i=t.changedTouches[0]),i===null)return;this.Vf=null,this.Df=gs(t),this.Xf(),this.vf=null,this.kf&&(this.kf(),this.kf=null);const s=this.Lf(t,i);if(this.Ff(s,this.jf.ov),++this.af,this._f&&this.af>1){const{Ef:Le}=this.Nf(ws(i),this.uf);Le<30&&!this.bf&&this.Ff(s,this.jf.Wf),this.Hf()}else this.bf||(this.Ff(s,this.jf._v),this.jf._v&&bs(t));this.af===0&&bs(t),t.touches.length===0&&this.df&&(this.df=!1,bs(t))}Af(t){if(t.button!==0)return;const i=this.Lf(t);if(this.ff=null,this.Rf=!1,this.Sf&&(this.Sf(),this.Sf=null),ss()&&this.Yf.ownerDocument.documentElement.removeEventListener("mouseleave",this.Bf),!this.zf(t))if(this.$f(i,this.jf.uv),++this.rf,this.hf&&this.rf>1){const{Ef:s}=this.Nf(ws(t),this.lf);s<5&&!this.mf&&this.$f(i,this.jf.Uf),this.qf()}else this.mf||this.$f(i,this.jf.cv)}Xf(){this.cf!==null&&(clearTimeout(this.cf),this.cf=null)}dv(t){if(this.Vf!==null)return;const i=t.changedTouches[0];this.Vf=i.identifier,this.Df=gs(t);const s=this.Yf.ownerDocument.documentElement;this.bf=!1,this.pf=!1,this.Pf=!1,this.vf=ws(i),this.kf&&(this.kf(),this.kf=null);{const Oe=this.tv.bind(this),Ae=this.av.bind(this);this.kf=()=>{s.removeEventListener("touchmove",Oe),s.removeEventListener("touchend",Ae)},s.addEventListener("touchmove",Oe,{passive:!1}),s.addEventListener("touchend",Ae,{passive:!1}),this.Xf(),this.cf=setTimeout(this.fv.bind(this,t),240)}const Le=this.Lf(t,i);this.Ff(Le,this.jf.vv),this._f||(this.af=0,this._f=setTimeout(this.Hf.bind(this),500),this.uf=ws(i))}pv(t){if(t.button!==0)return;const i=this.Yf.ownerDocument.documentElement;ss()&&i.addEventListener("mouseleave",this.Bf),this.mf=!1,this.ff=ws(t),this.Sf&&(this.Sf(),this.Sf=null);{const Le=this.hv.bind(this),Oe=this.Af.bind(this);this.Sf=()=>{i.removeEventListener("mousemove",Le),i.removeEventListener("mouseup",Oe)},i.addEventListener("mousemove",Le),i.addEventListener("mouseup",Oe)}if(this.Rf=!0,this.zf(t))return;const s=this.Lf(t);this.$f(s,this.jf.mv),this.hf||(this.rf=0,this.hf=setTimeout(this.qf.bind(this),500),this.lf=ws(t))}Zf(){this.Yf.addEventListener("mouseenter",this.Kf.bind(this)),this.Yf.addEventListener("touchcancel",this.Xf.bind(this));{const t=this.Yf.ownerDocument,i=s=>{this.jf.bv&&(s.composed&&this.Yf.contains(s.composedPath()[0])||s.target&&this.Yf.contains(s.target)||this.jf.bv())};this.gf=()=>{t.removeEventListener("touchstart",i)},this.wf=()=>{t.removeEventListener("mousedown",i)},t.addEventListener("mousedown",i),t.addEventListener("touchstart",i,{passive:!0})}es()&&(this.Mf=()=>{this.Yf.removeEventListener("dblclick",this.If)},this.Yf.addEventListener("dblclick",this.If)),this.Yf.addEventListener("mouseleave",this.wv.bind(this)),this.Yf.addEventListener("touchstart",this.dv.bind(this),{passive:!0}),vs(this.Yf),this.Yf.addEventListener("mousedown",this.pv.bind(this)),this.gv(),this.Yf.addEventListener("touchmove",()=>{},{passive:!1})}gv(){this.jf.Mv===void 0&&this.jf.xv===void 0&&this.jf.Sv===void 0||(this.Yf.addEventListener("touchstart",t=>this.kv(t.touches),{passive:!0}),this.Yf.addEventListener("touchmove",t=>{if(t.touches.length===2&&this.yf!==null&&this.jf.xv!==void 0){const i=ms(t.touches[0],t.touches[1])/this.Cf;this.jf.xv(this.yf,i),bs(t)}},{passive:!1}),this.Yf.addEventListener("touchend",t=>{this.kv(t.touches)}))}kv(t){t.length===1&&(this.Tf=!1),t.length!==2||this.Tf||this.df?this.yv():this.Cv(t)}Cv(t){const i=this.Yf.getBoundingClientRect()||{left:0,top:0};this.yf={nt:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,st:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this.Cf=ms(t[0],t[1]),this.jf.Mv!==void 0&&this.jf.Mv(),this.Xf()}yv(){this.yf!==null&&(this.yf=null,this.jf.Sv!==void 0&&this.jf.Sv())}wv(t){if(this.xf&&this.xf(),this.zf(t)||!this.Of)return;const i=this.Lf(t);this.$f(i,this.jf.Tv),this.Of=!es()}fv(t){const i=Ms(t.touches,b(this.Vf));if(i===null)return;const s=this.Lf(t,i);this.Ff(s,this.jf.Pv),this.bf=!0,this.df=!0}zf(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:gs(t)<this.Df+500}Ff(t,i){i&&i.call(this.jf,t)}$f(t,i){i&&i.call(this.jf,t)}Lf(t,i){const s=i||t,Le=this.Yf.getBoundingClientRect()||{left:0,top:0};return{clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,screenX:s.screenX,screenY:s.screenY,localX:s.clientX-Le.left,localY:s.clientY-Le.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,Rv:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Dv:t.type,Vv:s.target,Ov:t.view,Bv:()=>{t.type!=="touchstart"&&bs(t)}}}}function ms(n,t){const i=n.clientX-t.clientX,s=n.clientY-t.clientY;return Math.sqrt(i*i+s*s)}function bs(n){n.cancelable&&n.preventDefault()}function ws(n){return{nt:n.pageX,st:n.pageY}}function gs(n){return n.timeStamp||performance.now()}function Ms(n,t){for(let i=0;i<n.length;++i)if(n[i].identifier===t)return n[i];return null}function xs(n){return{jc:n.jc,Av:{wr:n.Iv.externalId},zv:n.Iv.cursorStyle}}function Ss(n,t,i){for(const s of n){const Le=s.gt();if(Le!==null&&Le.br){const Oe=Le.br(t,i);if(Oe!==null)return{Ov:s,Av:Oe}}}return null}function ks(n,t){return i=>{var s,Le,Oe,Ae;return((Le=(s=i.Dt())===null||s===void 0?void 0:s.Ta())!==null&&Le!==void 0?Le:"")!==t?[]:(Ae=(Oe=i.ca)===null||Oe===void 0?void 0:Oe.call(i,n))!==null&&Ae!==void 0?Ae:[]}}function ys(n,t,i,s){if(!n.length)return;let Le=0;const Oe=i/2,Ae=n[0].At(s,!0);let Ee=t===1?Oe-(n[0].Vi()-Ae/2):n[0].Vi()-Ae/2-Oe;Ee=Math.max(0,Ee);for(let $e=1;$e<n.length;$e++){const Ie=n[$e],Fe=n[$e-1],He=Fe.At(s,!1),ze=Ie.Vi(),je=Fe.Vi();if(t===1?ze>je-He:ze<je+He){const Ne=je-He*t;Ie.Oi(Ne);const Ke=Ne-t*He/2;if((t===1?Ke<0:Ke>i)&&Ee>0){const Be=t===1?-1-Ke:Ke-i,Ue=Math.min(Be,Ee);for(let We=Le;We<n.length;We++)n[We].Oi(n[We].Vi()+t*Ue);Ee-=Ue}}else Le=$e,Ee=t===1?je-He-ze:ze-(je+He)}}class Cs{constructor(t,i,s,Le){this.Li=null,this.Lv=null,this.Ev=!1,this.Nv=new ni(200),this.Jr=null,this.Fv=0,this.Wv=!1,this.jv=()=>{this.Wv||this.tn.Hv().$t().$h()},this.$v=()=>{this.Wv||this.tn.Hv().$t().$h()},this.tn=t,this.cn=i,this.So=i.layout,this.Vc=s,this.Uv=Le==="left",this.qv=ks("normal",Le),this.Yv=ks("top",Le),this.Zv=ks("bottom",Le),this.Xv=document.createElement("div"),this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Xv.style.width="25px",this.Xv.style.left="0",this.Xv.style.position="relative",this.Kv=_s(this.Xv,size$2({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const Oe=this.Kv.canvasElement;Oe.style.position="absolute",Oe.style.zIndex="1",Oe.style.left="0",Oe.style.top="0",this.Gv=_s(this.Xv,size$2({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const Ae=this.Gv.canvasElement;Ae.style.position="absolute",Ae.style.zIndex="2",Ae.style.left="0",Ae.style.top="0";const Ee={mv:this.Jv.bind(this),vv:this.Jv.bind(this),lv:this.Qv.bind(this),rv:this.Qv.bind(this),bv:this.tp.bind(this),uv:this.ip.bind(this),ov:this.ip.bind(this),Uf:this.np.bind(this),Wf:this.np.bind(this),Jf:this.sp.bind(this),Tv:this.ep.bind(this)};this.rp=new ps(this.Gv.canvasElement,Ee,{sv:()=>!this.cn.handleScroll.vertTouchDrag,ev:()=>!0})}S(){this.rp.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),us(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),us(this.Kv.canvasElement),this.Kv.dispose(),this.Li!==null&&this.Li.Xo().p(this),this.Li=null}hp(){return this.Xv}P(){return this.So.fontSize}lp(){const t=this.Vc.W();return this.Jr!==t.R&&(this.Nv.ir(),this.Jr=t.R),t}ap(){if(this.Li===null)return 0;let t=0;const i=this.lp(),s=b(this.Kv.canvasElement.getContext("2d"));s.save();const Le=this.Li.ja();s.font=this.op(),Le.length>0&&(t=Math.max(this.Nv.xi(s,Le[0].no),this.Nv.xi(s,Le[Le.length-1].no)));const Oe=this._p();for(let $e=Oe.length;$e--;){const Ie=this.Nv.xi(s,Oe[$e].Kt());Ie>t&&(t=Ie)}const Ae=this.Li.Ct();if(Ae!==null&&this.Lv!==null){const $e=this.Li.pn(1,Ae),Ie=this.Li.pn(this.Lv.height-2,Ae);t=Math.max(t,this.Nv.xi(s,this.Li.Fi(Math.floor(Math.min($e,Ie))+.11111111111111,Ae)),this.Nv.xi(s,this.Li.Fi(Math.ceil(Math.max($e,Ie))-.11111111111111,Ae)))}s.restore();const Ee=t||34;return rs(Math.ceil(i.C+i.T+i.A+i.I+5+Ee))}up(t){this.Lv!==null&&equalSizes(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`)}cp(){return b(this.Lv).width}Gi(t){this.Li!==t&&(this.Li!==null&&this.Li.Xo().p(this),this.Li=t,t.Xo().l(this.do.bind(this),this))}Dt(){return this.Li}ir(){const t=this.tn.dp();this.tn.Hv().$t().L_(t,b(this.Dt()))}fp(t){if(this.Lv===null)return;if(t!==1){this.vp(),this.Kv.applySuggestedBitmapSize();const s=tryCreateCanvasRenderingTarget2D(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(Le=>{this.pp(Le),this.Ae(Le)}),this.tn.mp(s,this.Zv),this.bp(s),this.tn.mp(s,this.qv),this.wp(s))}this.Gv.applySuggestedBitmapSize();const i=tryCreateCanvasRenderingTarget2D(this.Gv);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:Le})=>{s.clearRect(0,0,Le.width,Le.height)}),this.gp(i),this.tn.mp(i,this.Yv))}Mp(){return this.Kv.bitmapSize}xp(t,i,s){const Le=this.Mp();Le.width>0&&Le.height>0&&t.drawImage(this.Kv.canvasElement,i,s)}bt(){var t;(t=this.Li)===null||t===void 0||t.ja()}Jv(t){if(this.Li===null||this.Li.Ni()||!this.cn.handleScale.axisPressedMouseMove.price)return;const i=this.tn.Hv().$t(),s=this.tn.dp();this.Ev=!0,i.D_(s,this.Li,t.localY)}Qv(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const i=this.tn.Hv().$t(),s=this.tn.dp(),Le=this.Li;i.V_(s,Le,t.localY)}tp(){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const t=this.tn.Hv().$t(),i=this.tn.dp(),s=this.Li;this.Ev&&(this.Ev=!1,t.O_(i,s))}ip(t){if(this.Li===null||!this.cn.handleScale.axisPressedMouseMove.price)return;const i=this.tn.Hv().$t(),s=this.tn.dp();this.Ev=!1,i.O_(s,this.Li)}np(t){this.cn.handleScale.axisDoubleClickReset.price&&this.ir()}sp(t){this.Li!==null&&(!this.tn.Hv().$t().W().handleScale.axisPressedMouseMove.price||this.Li.gh()||this.Li.Vo()||this.Sp(1))}ep(t){this.Sp(0)}_p(){const t=[],i=this.Li===null?void 0:this.Li;return(s=>{for(let Le=0;Le<s.length;++Le){const Oe=s[Le].Rn(this.tn.dp(),i);for(let Ae=0;Ae<Oe.length;Ae++)t.push(Oe[Ae])}})(this.tn.dp().$o()),t}pp({context:t,bitmapSize:i}){const{width:s,height:Le}=i,Oe=this.tn.dp().$t(),Ae=Oe.q(),Ee=Oe.md();Ae===Ee?G(t,0,0,s,Le,Ae):tt(t,0,0,s,Le,Ae,Ee)}Ae({context:t,bitmapSize:i,horizontalPixelRatio:s}){if(this.Lv===null||this.Li===null||!this.Li.W().borderVisible)return;t.fillStyle=this.Li.W().borderColor;const Le=Math.max(1,Math.floor(this.lp().C*s));let Oe;Oe=this.Uv?i.width-Le:0,t.fillRect(Oe,0,Le,i.height)}bp(t){if(this.Lv===null||this.Li===null)return;const i=this.Li.ja(),s=this.Li.W(),Le=this.lp(),Oe=this.Uv?this.Lv.width-Le.T:0;s.borderVisible&&s.ticksVisible&&t.useBitmapCoordinateSpace(({context:Ae,horizontalPixelRatio:Ee,verticalPixelRatio:$e})=>{Ae.fillStyle=s.borderColor;const Ie=Math.max(1,Math.floor($e)),Fe=Math.floor(.5*$e),He=Math.round(Le.T*Ee);Ae.beginPath();for(const ze of i)Ae.rect(Math.floor(Oe*Ee),Math.round(ze.La*$e)-Fe,He,Ie);Ae.fill()}),t.useMediaCoordinateSpace(({context:Ae})=>{var Ee;Ae.font=this.op(),Ae.fillStyle=(Ee=s.textColor)!==null&&Ee!==void 0?Ee:this.So.textColor,Ae.textAlign=this.Uv?"right":"left",Ae.textBaseline="middle";const $e=this.Uv?Math.round(Oe-Le.A):Math.round(Oe+Le.T+Le.A),Ie=i.map(Fe=>this.Nv.Mi(Ae,Fe.no));for(let Fe=i.length;Fe--;){const He=i[Fe];Ae.fillText(He.no,$e,He.La+Ie[Fe])}})}vp(){if(this.Lv===null||this.Li===null)return;const t=[],i=this.Li.$o().slice(),s=this.tn.dp(),Le=this.lp();this.Li===s.vr()&&this.tn.dp().$o().forEach(Ae=>{s.dr(Ae)&&i.push(Ae)});const Oe=this.Li;i.forEach(Ae=>{Ae.Rn(s,Oe).forEach(Ee=>{Ee.Oi(null),Ee.Bi()&&t.push(Ee)})}),t.forEach(Ae=>Ae.Oi(Ae.ki())),this.Li.W().alignLabels&&this.kp(t,Le)}kp(t,i){if(this.Lv===null)return;const s=this.Lv.height/2,Le=t.filter(Ae=>Ae.ki()<=s),Oe=t.filter(Ae=>Ae.ki()>s);Le.sort((Ae,Ee)=>Ee.ki()-Ae.ki()),Oe.sort((Ae,Ee)=>Ae.ki()-Ee.ki());for(const Ae of t){const Ee=Math.floor(Ae.At(i)/2),$e=Ae.ki();$e>-Ee&&$e<Ee&&Ae.Oi(Ee),$e>this.Lv.height-Ee&&$e<this.Lv.height+Ee&&Ae.Oi(this.Lv.height-Ee)}ys(Le,1,this.Lv.height,i),ys(Oe,-1,this.Lv.height,i)}wp(t){if(this.Lv===null)return;const i=this._p(),s=this.lp(),Le=this.Uv?"right":"left";i.forEach(Oe=>{Oe.Ai()&&Oe.gt(b(this.Li)).X(t,s,this.Nv,Le)})}gp(t){if(this.Lv===null||this.Li===null)return;const i=this.tn.Hv().$t(),s=[],Le=this.tn.dp(),Oe=i.Yc().Rn(Le,this.Li);Oe.length&&s.push(Oe);const Ae=this.lp(),Ee=this.Uv?"right":"left";s.forEach($e=>{$e.forEach(Ie=>{Ie.gt(b(this.Li)).X(t,Ae,this.Nv,Ee)})})}Sp(t){this.Xv.style.cursor=t===1?"ns-resize":"default"}do(){const t=this.ap();this.Fv<t&&this.tn.Hv().$t().Xl(),this.Fv=t}op(){return F(this.So.fontSize,this.So.fontFamily)}}function Ts(n,t){var i,s;return(s=(i=n._a)===null||i===void 0?void 0:i.call(n,t))!==null&&s!==void 0?s:[]}function Ps(n,t){var i,s;return(s=(i=n.Pn)===null||i===void 0?void 0:i.call(n,t))!==null&&s!==void 0?s:[]}function Rs(n,t){var i,s;return(s=(i=n.Ji)===null||i===void 0?void 0:i.call(n,t))!==null&&s!==void 0?s:[]}function Ds(n,t){var i,s;return(s=(i=n.la)===null||i===void 0?void 0:i.call(n,t))!==null&&s!==void 0?s:[]}class Vs{constructor(t,i){this.Lv=size$2({width:0,height:0}),this.yp=null,this.Cp=null,this.Tp=null,this.Pp=null,this.Rp=!1,this.Dp=new D,this.Vp=new D,this.Op=0,this.Bp=!1,this.Ap=null,this.Ip=!1,this.zp=null,this.Lp=null,this.Wv=!1,this.jv=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.$v=()=>{this.Wv||this.Ep===null||this.$i().$h()},this.Jd=t,this.Ep=i,this.Ep.F_().l(this.Np.bind(this),this,!0),this.Fp=document.createElement("td"),this.Fp.style.padding="0",this.Fp.style.position="relative";const s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.Wp=document.createElement("td"),this.Wp.style.padding="0",this.jp=document.createElement("td"),this.jp.style.padding="0",this.Fp.appendChild(s),this.Kv=_s(s,size$2({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const Le=this.Kv.canvasElement;Le.style.position="absolute",Le.style.zIndex="1",Le.style.left="0",Le.style.top="0",this.Gv=_s(s,size$2({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const Oe=this.Gv.canvasElement;Oe.style.position="absolute",Oe.style.zIndex="2",Oe.style.left="0",Oe.style.top="0",this.Hp=document.createElement("tr"),this.Hp.appendChild(this.Wp),this.Hp.appendChild(this.Fp),this.Hp.appendChild(this.jp),this.$p(),this.rp=new ps(this.Gv.canvasElement,this,{sv:()=>this.Ap===null&&!this.Jd.W().handleScroll.vertTouchDrag,ev:()=>this.Ap===null&&!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.yp!==null&&this.yp.S(),this.Cp!==null&&this.Cp.S(),this.Tp=null,this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),us(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),us(this.Kv.canvasElement),this.Kv.dispose(),this.Ep!==null&&this.Ep.F_().p(this),this.rp.S()}dp(){return b(this.Ep)}Up(t){var i,s;this.Ep!==null&&this.Ep.F_().p(this),this.Ep=t,this.Ep!==null&&this.Ep.F_().l(Vs.prototype.Np.bind(this),this,!0),this.$p(),this.Jd.qp().indexOf(this)===this.Jd.qp().length-1?(this.Tp=(i=this.Tp)!==null&&i!==void 0?i:new os(this.Fp,this.Jd),this.Tp.bt()):((s=this.Tp)===null||s===void 0||s.tf(),this.Tp=null)}Hv(){return this.Jd}hp(){return this.Hp}$p(){if(this.Ep!==null&&(this.Yp(),this.$i().wt().length!==0)){if(this.yp!==null){const t=this.Ep.P_();this.yp.Gi(b(t))}if(this.Cp!==null){const t=this.Ep.R_();this.Cp.Gi(b(t))}}}Zp(){this.yp!==null&&this.yp.bt(),this.Cp!==null&&this.Cp.bt()}g_(){return this.Ep!==null?this.Ep.g_():0}M_(t){this.Ep&&this.Ep.M_(t)}Jf(t){if(!this.Ep)return;this.Xp();const i=t.localX,s=t.localY;this.Kp(i,s,t)}mv(t){this.Xp(),this.Gp(),this.Kp(t.localX,t.localY,t)}Qf(t){var i;if(!this.Ep)return;this.Xp();const s=t.localX,Le=t.localY;this.Kp(s,Le,t);const Oe=this.br(s,Le);this.Jd.Jp((i=Oe?.zv)!==null&&i!==void 0?i:null),this.$i().Wc(Oe&&{jc:Oe.jc,Av:Oe.Av})}cv(t){this.Ep!==null&&(this.Xp(),this.Qp(t))}Uf(t){this.Ep!==null&&this.tm(this.Vp,t)}Wf(t){this.Uf(t)}lv(t){this.Xp(),this.im(t),this.Kp(t.localX,t.localY,t)}uv(t){this.Ep!==null&&(this.Xp(),this.Bp=!1,this.nm(t))}_v(t){this.Ep!==null&&this.Qp(t)}Pv(t){if(this.Bp=!0,this.Ap===null){const i={x:t.localX,y:t.localY};this.sm(i,i,t)}}Tv(t){this.Ep!==null&&(this.Xp(),this.Ep.$t().Wc(null),this.rm())}hm(){return this.Dp}lm(){return this.Vp}Mv(){this.Op=1,this.$i().Un()}xv(t,i){if(!this.Jd.W().handleScale.pinch)return;const s=5*(i-this.Op);this.Op=i,this.$i().Jc(t.nt,s)}vv(t){this.Bp=!1,this.Ip=this.Ap!==null,this.Gp();const i=this.$i().Yc();this.Ap!==null&&i.yt()&&(this.zp={x:i.Yt(),y:i.Zt()},this.Ap={x:t.localX,y:t.localY})}rv(t){if(this.Ep===null)return;const i=t.localX,s=t.localY;if(this.Ap===null)this.im(t);else{this.Ip=!1;const Le=b(this.zp),Oe=Le.x+(i-this.Ap.x),Ae=Le.y+(s-this.Ap.y);this.Kp(Oe,Ae,t)}}ov(t){this.Hv().W().trackingMode.exitMode===0&&(this.Ip=!0),this.am(),this.nm(t)}br(t,i){const s=this.Ep;return s===null?null:function(Le,Oe,Ae){const Ee=Le.$o(),$e=function(Ie,Fe,He){var ze,je;let Ne,Ke;for(const We of Ie){const Ge=(je=(ze=We.fa)===null||ze===void 0?void 0:ze.call(We,Fe,He))!==null&&je!==void 0?je:[];for(const qe of Ge)Be=qe.zOrder,(!(Ue=Ne?.zOrder)||Be==="top"&&Ue!=="top"||Be==="normal"&&Ue==="bottom")&&(Ne=qe,Ke=We)}var Be,Ue;return Ne&&Ke?{Iv:Ne,jc:Ke}:null}(Ee,Oe,Ae);if($e?.Iv.zOrder==="top")return xs($e);for(const Ie of Ee){if($e&&$e.jc===Ie&&$e.Iv.zOrder!=="bottom"&&!$e.Iv.isBackground)return xs($e);const Fe=Ss(Ie.Pn(Le),Oe,Ae);if(Fe!==null)return{jc:Ie,Ov:Fe.Ov,Av:Fe.Av};if($e&&$e.jc===Ie&&$e.Iv.zOrder!=="bottom"&&$e.Iv.isBackground)return xs($e)}return $e?.Iv?xs($e):null}(s,t,i)}om(t,i){b(i==="left"?this.yp:this.Cp).up(size$2({width:t,height:this.Lv.height}))}_m(){return this.Lv}up(t){equalSizes(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Fp.style.width=t.width+"px",this.Fp.style.height=t.height+"px")}um(){const t=b(this.Ep);t.T_(t.P_()),t.T_(t.R_());for(const i of t.Oa())if(t.dr(i)){const s=i.Dt();s!==null&&t.T_(s),i.Vn()}}Mp(){return this.Kv.bitmapSize}xp(t,i,s){const Le=this.Mp();Le.width>0&&Le.height>0&&t.drawImage(this.Kv.canvasElement,i,s)}fp(t){if(t===0||this.Ep===null)return;if(t>1&&this.um(),this.yp!==null&&this.yp.fp(t),this.Cp!==null&&this.Cp.fp(t),t!==1){this.Kv.applySuggestedBitmapSize();const s=tryCreateCanvasRenderingTarget2D(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(Le=>{this.pp(Le)}),this.Ep&&(this.dm(s,Ts),this.fm(s),this.vm(s),this.dm(s,Ps),this.dm(s,Rs)))}this.Gv.applySuggestedBitmapSize();const i=tryCreateCanvasRenderingTarget2D(this.Gv);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:Le})=>{s.clearRect(0,0,Le.width,Le.height)}),this.pm(i),this.dm(i,Ds))}bm(){return this.yp}wm(){return this.Cp}mp(t,i){this.dm(t,i)}Np(){this.Ep!==null&&this.Ep.F_().p(this),this.Ep=null}Qp(t){this.tm(this.Dp,t)}tm(t,i){const s=i.localX,Le=i.localY;t.M()&&t.m(this.$i().St().Eu(s),{x:s,y:Le},i)}pp({context:t,bitmapSize:i}){const{width:s,height:Le}=i,Oe=this.$i(),Ae=Oe.q(),Ee=Oe.md();Ae===Ee?G(t,0,0,s,Le,Ee):tt(t,0,0,s,Le,Ae,Ee)}fm(t){const i=b(this.Ep).W_().Uh().gt();i!==null&&i.X(t,!1)}vm(t){const i=this.$i().qc();this.gm(t,Ps,cs,i),this.gm(t,Ps,ds,i)}pm(t){this.gm(t,Ps,ds,this.$i().Yc())}dm(t,i){const s=b(this.Ep).$o();for(const Le of s)this.gm(t,i,cs,Le);for(const Le of s)this.gm(t,i,ds,Le)}gm(t,i,s,Le){const Oe=b(this.Ep),Ae=Oe.$t().Fc(),Ee=Ae!==null&&Ae.jc===Le,$e=Ae!==null&&Ee&&Ae.Av!==void 0?Ae.Av.gr:void 0;fs(i,Ie=>s(Ie,t,Ee,$e),Le,Oe)}Yp(){if(this.Ep===null)return;const t=this.Jd,i=this.Ep.P_().W().visible,s=this.Ep.R_().W().visible;i||this.yp===null||(this.Wp.removeChild(this.yp.hp()),this.yp.S(),this.yp=null),s||this.Cp===null||(this.jp.removeChild(this.Cp.hp()),this.Cp.S(),this.Cp=null);const Le=t.$t()._d();i&&this.yp===null&&(this.yp=new Cs(this,t.W(),Le,"left"),this.Wp.appendChild(this.yp.hp())),s&&this.Cp===null&&(this.Cp=new Cs(this,t.W(),Le,"right"),this.jp.appendChild(this.Cp.hp()))}Mm(t){return t.Rv&&this.Bp||this.Ap!==null}xm(t){return Math.max(0,Math.min(t,this.Lv.width-1))}Sm(t){return Math.max(0,Math.min(t,this.Lv.height-1))}Kp(t,i,s){this.$i().hd(this.xm(t),this.Sm(i),s,b(this.Ep))}rm(){this.$i().ad()}am(){this.Ip&&(this.Ap=null,this.rm())}sm(t,i,s){this.Ap=t,this.Ip=!1,this.Kp(i.x,i.y,s);const Le=this.$i().Yc();this.zp={x:Le.Yt(),y:Le.Zt()}}$i(){return this.Jd.$t()}nm(t){if(!this.Rp)return;const i=this.$i(),s=this.dp();if(i.I_(s,s.vn()),this.Pp=null,this.Rp=!1,i.sd(),this.Lp!==null){const Le=performance.now(),Oe=i.St();this.Lp.Dr(Oe.ju(),Le),this.Lp.Ju(Le)||i.Zn(this.Lp)}}Xp(){this.Ap=null}Gp(){if(this.Ep){if(this.$i().Un(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)b(document.activeElement).blur();else{const t=document.getSelection();t!==null&&t.removeAllRanges()}!this.Ep.vn().Ni()&&this.$i().St().Ni()}}im(t){if(this.Ep===null)return;const i=this.$i(),s=i.St();if(s.Ni())return;const Le=this.Jd.W(),Oe=Le.handleScroll,Ae=Le.kineticScroll;if((!Oe.pressedMouseMove||t.Rv)&&(!Oe.horzTouchDrag&&!Oe.vertTouchDrag||!t.Rv))return;const Ee=this.Ep.vn(),$e=performance.now();if(this.Pp!==null||this.Mm(t)||(this.Pp={x:t.clientX,y:t.clientY,Vd:$e,km:t.localX,ym:t.localY}),this.Pp!==null&&!this.Rp&&(this.Pp.x!==t.clientX||this.Pp.y!==t.clientY)){if(t.Rv&&Ae.touch||!t.Rv&&Ae.mouse){const Ie=s.he();this.Lp=new as(.2/Ie,7/Ie,.997,15/Ie),this.Lp.qd(s.ju(),this.Pp.Vd)}else this.Lp=null;Ee.Ni()||i.B_(this.Ep,Ee,t.localY),i.td(t.localX),this.Rp=!0}this.Rp&&(Ee.Ni()||i.A_(this.Ep,Ee,t.localY),i.nd(t.localX),this.Lp!==null&&this.Lp.qd(s.ju(),$e))}}class Os{constructor(t,i,s,Le,Oe){this.ft=!0,this.Lv=size$2({width:0,height:0}),this.jv=()=>this.fp(3),this.Uv=t==="left",this.Vc=s._d,this.cn=i,this.Cm=Le,this.Tm=Oe,this.Xv=document.createElement("div"),this.Xv.style.width="25px",this.Xv.style.height="100%",this.Xv.style.overflow="hidden",this.Kv=_s(this.Xv,size$2({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv)}S(){this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),us(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Xv}_m(){return this.Lv}up(t){equalSizes(this.Lv,t)||(this.Lv=t,this.Kv.resizeCanvasElement(t),this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.ft=!0)}fp(t){if(t<3&&!this.ft||this.Lv.width===0||this.Lv.height===0)return;this.ft=!1,this.Kv.applySuggestedBitmapSize();const i=tryCreateCanvasRenderingTarget2D(this.Kv);i!==null&&i.useBitmapCoordinateSpace(s=>{this.pp(s),this.Ae(s)})}Mp(){return this.Kv.bitmapSize}xp(t,i,s){const Le=this.Mp();Le.width>0&&Le.height>0&&t.drawImage(this.Kv.canvasElement,i,s)}Ae({context:t,bitmapSize:i,horizontalPixelRatio:s,verticalPixelRatio:Le}){if(!this.Cm())return;t.fillStyle=this.cn.timeScale.borderColor;const Oe=Math.floor(this.Vc.W().C*s),Ae=Math.floor(this.Vc.W().C*Le),Ee=this.Uv?i.width-Oe:0;t.fillRect(Ee,0,Oe,Ae)}pp({context:t,bitmapSize:i}){G(t,0,0,i.width,i.height,this.Tm())}}function Bs(n){return t=>{var i,s;return(s=(i=t.da)===null||i===void 0?void 0:i.call(t,n))!==null&&s!==void 0?s:[]}}const As=Bs("normal"),Is=Bs("top"),zs=Bs("bottom");class Ls{constructor(t,i){this.Pm=null,this.Rm=null,this.k=null,this.Dm=!1,this.Lv=size$2({width:0,height:0}),this.Vm=new D,this.Nv=new ni(5),this.Wv=!1,this.jv=()=>{this.Wv||this.Jd.$t().$h()},this.$v=()=>{this.Wv||this.Jd.$t().$h()},this.Jd=t,this.U_=i,this.cn=t.W().layout,this.Zd=document.createElement("tr"),this.Om=document.createElement("td"),this.Om.style.padding="0",this.Bm=document.createElement("td"),this.Bm.style.padding="0",this.Xv=document.createElement("td"),this.Xv.style.height="25px",this.Xv.style.padding="0",this.Am=document.createElement("div"),this.Am.style.width="100%",this.Am.style.height="100%",this.Am.style.position="relative",this.Am.style.overflow="hidden",this.Xv.appendChild(this.Am),this.Kv=_s(this.Am,size$2({width:16,height:16})),this.Kv.subscribeSuggestedBitmapSizeChanged(this.jv);const s=this.Kv.canvasElement;s.style.position="absolute",s.style.zIndex="1",s.style.left="0",s.style.top="0",this.Gv=_s(this.Am,size$2({width:16,height:16})),this.Gv.subscribeSuggestedBitmapSizeChanged(this.$v);const Le=this.Gv.canvasElement;Le.style.position="absolute",Le.style.zIndex="2",Le.style.left="0",Le.style.top="0",this.Zd.appendChild(this.Om),this.Zd.appendChild(this.Xv),this.Zd.appendChild(this.Bm),this.Im(),this.Jd.$t().w_().l(this.Im.bind(this),this),this.rp=new ps(this.Gv.canvasElement,this,{sv:()=>!0,ev:()=>!this.Jd.W().handleScroll.horzTouchDrag})}S(){this.rp.S(),this.Pm!==null&&this.Pm.S(),this.Rm!==null&&this.Rm.S(),this.Gv.unsubscribeSuggestedBitmapSizeChanged(this.$v),us(this.Gv.canvasElement),this.Gv.dispose(),this.Kv.unsubscribeSuggestedBitmapSizeChanged(this.jv),us(this.Kv.canvasElement),this.Kv.dispose()}hp(){return this.Zd}zm(){return this.Pm}Lm(){return this.Rm}mv(t){if(this.Dm)return;this.Dm=!0;const i=this.Jd.$t();!i.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&i.Gc(t.localX)}vv(t){this.mv(t)}bv(){const t=this.Jd.$t();!t.St().Ni()&&this.Dm&&(this.Dm=!1,this.Jd.W().handleScale.axisPressedMouseMove.time&&t.rd())}lv(t){const i=this.Jd.$t();!i.St().Ni()&&this.Jd.W().handleScale.axisPressedMouseMove.time&&i.ed(t.localX)}rv(t){this.lv(t)}uv(){this.Dm=!1;const t=this.Jd.$t();t.St().Ni()&&!this.Jd.W().handleScale.axisPressedMouseMove.time||t.rd()}ov(){this.uv()}Uf(){this.Jd.W().handleScale.axisDoubleClickReset.time&&this.Jd.$t().Kn()}Wf(){this.Uf()}Jf(){this.Jd.$t().W().handleScale.axisPressedMouseMove.time&&this.Sp(1)}Tv(){this.Sp(0)}_m(){return this.Lv}Em(){return this.Vm}Nm(t,i,s){equalSizes(this.Lv,t)||(this.Lv=t,this.Wv=!0,this.Kv.resizeCanvasElement(t),this.Gv.resizeCanvasElement(t),this.Wv=!1,this.Xv.style.width=`${t.width}px`,this.Xv.style.height=`${t.height}px`,this.Vm.m(t)),this.Pm!==null&&this.Pm.up(size$2({width:i,height:t.height})),this.Rm!==null&&this.Rm.up(size$2({width:s,height:t.height}))}Fm(){const t=this.Wm();return Math.ceil(t.C+t.T+t.P+t.L+t.B+t.jm)}bt(){this.Jd.$t().St().ja()}Mp(){return this.Kv.bitmapSize}xp(t,i,s){const Le=this.Mp();Le.width>0&&Le.height>0&&t.drawImage(this.Kv.canvasElement,i,s)}fp(t){if(t===0)return;if(t!==1){this.Kv.applySuggestedBitmapSize();const s=tryCreateCanvasRenderingTarget2D(this.Kv);s!==null&&(s.useBitmapCoordinateSpace(Le=>{this.pp(Le),this.Ae(Le),this.Hm(s,zs)}),this.bp(s),this.Hm(s,As)),this.Pm!==null&&this.Pm.fp(t),this.Rm!==null&&this.Rm.fp(t)}this.Gv.applySuggestedBitmapSize();const i=tryCreateCanvasRenderingTarget2D(this.Gv);i!==null&&(i.useBitmapCoordinateSpace(({context:s,bitmapSize:Le})=>{s.clearRect(0,0,Le.width,Le.height)}),this.$m([...this.Jd.$t().wt(),this.Jd.$t().Yc()],i),this.Hm(i,Is))}Hm(t,i){const s=this.Jd.$t().wt();for(const Le of s)fs(i,Oe=>cs(Oe,t,!1,void 0),Le,void 0);for(const Le of s)fs(i,Oe=>ds(Oe,t,!1,void 0),Le,void 0)}pp({context:t,bitmapSize:i}){G(t,0,0,i.width,i.height,this.Jd.$t().md())}Ae({context:t,bitmapSize:i,verticalPixelRatio:s}){if(this.Jd.W().timeScale.borderVisible){t.fillStyle=this.Um();const Le=Math.max(1,Math.floor(this.Wm().C*s));t.fillRect(0,0,i.width,Le)}}bp(t){const i=this.Jd.$t().St(),s=i.ja();if(!s||s.length===0)return;const Le=this.U_.maxTickMarkWeight(s),Oe=this.Wm(),Ae=i.W();Ae.borderVisible&&Ae.ticksVisible&&t.useBitmapCoordinateSpace(({context:Ee,horizontalPixelRatio:$e,verticalPixelRatio:Ie})=>{Ee.strokeStyle=this.Um(),Ee.fillStyle=this.Um();const Fe=Math.max(1,Math.floor($e)),He=Math.floor(.5*$e);Ee.beginPath();const ze=Math.round(Oe.T*Ie);for(let je=s.length;je--;){const Ne=Math.round(s[je].coord*$e);Ee.rect(Ne-He,0,Fe,ze)}Ee.fill()}),t.useMediaCoordinateSpace(({context:Ee})=>{const $e=Oe.C+Oe.T+Oe.L+Oe.P/2;Ee.textAlign="center",Ee.textBaseline="middle",Ee.fillStyle=this.$(),Ee.font=this.op();for(const Ie of s)if(Ie.weight<Le){const Fe=Ie.needAlignCoordinate?this.qm(Ee,Ie.coord,Ie.label):Ie.coord;Ee.fillText(Ie.label,Fe,$e)}this.Jd.W().timeScale.allowBoldLabels&&(Ee.font=this.Ym());for(const Ie of s)if(Ie.weight>=Le){const Fe=Ie.needAlignCoordinate?this.qm(Ee,Ie.coord,Ie.label):Ie.coord;Ee.fillText(Ie.label,Fe,$e)}})}qm(t,i,s){const Le=this.Nv.xi(t,s),Oe=Le/2,Ae=Math.floor(i-Oe)+.5;return Ae<0?i+=Math.abs(0-Ae):Ae+Le>this.Lv.width&&(i-=Math.abs(this.Lv.width-(Ae+Le))),i}$m(t,i){const s=this.Wm();for(const Le of t)for(const Oe of Le.Qi())Oe.gt().X(i,s)}Um(){return this.Jd.W().timeScale.borderColor}$(){return this.cn.textColor}j(){return this.cn.fontSize}op(){return F(this.j(),this.cn.fontFamily)}Ym(){return F(this.j(),this.cn.fontFamily,"bold")}Wm(){this.k===null&&(this.k={C:1,N:NaN,L:NaN,B:NaN,ji:NaN,T:5,P:NaN,R:"",Wi:new ni,jm:0});const t=this.k,i=this.op();if(t.R!==i){const s=this.j();t.P=s,t.R=i,t.L=3*s/12,t.B=3*s/12,t.ji=9*s/12,t.N=0,t.jm=4*s/12,t.Wi.ir()}return this.k}Sp(t){this.Xv.style.cursor=t===1?"ew-resize":"default"}Im(){const t=this.Jd.$t(),i=t.W();i.leftPriceScale.visible||this.Pm===null||(this.Om.removeChild(this.Pm.hp()),this.Pm.S(),this.Pm=null),i.rightPriceScale.visible||this.Rm===null||(this.Bm.removeChild(this.Rm.hp()),this.Rm.S(),this.Rm=null);const s={_d:this.Jd.$t()._d()},Le=()=>i.leftPriceScale.borderVisible&&t.St().W().borderVisible,Oe=()=>t.md();i.leftPriceScale.visible&&this.Pm===null&&(this.Pm=new Os("left",i,s,Le,Oe),this.Om.appendChild(this.Pm.hp())),i.rightPriceScale.visible&&this.Rm===null&&(this.Rm=new Os("right",i,s,Le,Oe),this.Bm.appendChild(this.Rm.hp()))}}const Es=!!ns&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(n=>n.brand.includes("Chromium"))&&!!ns&&(!((Ns=navigator?.userAgentData)===null||Ns===void 0)&&Ns.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);var Ns;class Fs{constructor(t,i,s){var Le;this.Zm=[],this.Xm=0,this.ro=0,this.o_=0,this.Km=0,this.Gm=0,this.Jm=null,this.Qm=!1,this.Dp=new D,this.Vp=new D,this.Pc=new D,this.tb=null,this.ib=null,this.Gd=t,this.cn=i,this.U_=s,this.Zd=document.createElement("div"),this.Zd.classList.add("tv-lightweight-charts"),this.Zd.style.overflow="hidden",this.Zd.style.direction="ltr",this.Zd.style.width="100%",this.Zd.style.height="100%",(Le=this.Zd).style.userSelect="none",Le.style.webkitUserSelect="none",Le.style.msUserSelect="none",Le.style.MozUserSelect="none",Le.style.webkitTapHighlightColor="transparent",this.nb=document.createElement("table"),this.nb.setAttribute("cellspacing","0"),this.Zd.appendChild(this.nb),this.sb=this.eb.bind(this),Ws(this.cn)&&this.rb(!0),this.$i=new Ln(this.Dc.bind(this),this.cn,s),this.$t().Zc().l(this.hb.bind(this),this),this.lb=new Ls(this,this.U_),this.nb.appendChild(this.lb.hp());const Oe=i.autoSize&&this.ab();let Ae=this.cn.width,Ee=this.cn.height;if(Oe||Ae===0||Ee===0){const $e=t.getBoundingClientRect();Ae=Ae||$e.width,Ee=Ee||$e.height}this.ob(Ae,Ee),this._b(),t.appendChild(this.Zd),this.ub(),this.$i.St().sc().l(this.$i.Xl.bind(this.$i),this),this.$i.w_().l(this.$i.Xl.bind(this.$i),this)}$t(){return this.$i}W(){return this.cn}qp(){return this.Zm}cb(){return this.lb}S(){this.rb(!1),this.Xm!==0&&window.cancelAnimationFrame(this.Xm),this.$i.Zc().p(this),this.$i.St().sc().p(this),this.$i.w_().p(this),this.$i.S();for(const t of this.Zm)this.nb.removeChild(t.hp()),t.hm().p(this),t.lm().p(this),t.S();this.Zm=[],b(this.lb).S(),this.Zd.parentElement!==null&&this.Zd.parentElement.removeChild(this.Zd),this.Pc.S(),this.Dp.S(),this.Vp.S(),this.fb()}ob(t,i,s=!1){if(this.ro===i&&this.o_===t)return;const Le=function(Ee){const $e=Math.floor(Ee.width),Ie=Math.floor(Ee.height);return size$2({width:$e-$e%2,height:Ie-Ie%2})}(size$2({width:t,height:i}));this.ro=Le.height,this.o_=Le.width;const Oe=this.ro+"px",Ae=this.o_+"px";b(this.Zd).style.height=Oe,b(this.Zd).style.width=Ae,this.nb.style.height=Oe,this.nb.style.width=Ae,s?this.pb(ut.es(),performance.now()):this.$i.Xl()}fp(t){t===void 0&&(t=ut.es());for(let i=0;i<this.Zm.length;i++)this.Zm[i].fp(t.Hn(i).Fn);this.cn.timeScale.visible&&this.lb.fp(t.jn())}Hh(t){const i=Ws(this.cn);this.$i.Hh(t);const s=Ws(this.cn);s!==i&&this.rb(s),this.ub(),this.mb(t)}hm(){return this.Dp}lm(){return this.Vp}Zc(){return this.Pc}bb(){this.Jm!==null&&(this.pb(this.Jm,performance.now()),this.Jm=null);const t=this.wb(null),i=document.createElement("canvas");i.width=t.width,i.height=t.height;const s=b(i.getContext("2d"));return this.wb(s),i}gb(t){return t==="left"&&!this.Mb()||t==="right"&&!this.xb()||this.Zm.length===0?0:b(t==="left"?this.Zm[0].bm():this.Zm[0].wm()).cp()}Sb(){return this.cn.autoSize&&this.tb!==null}kb(){return this.Zd}Jp(t){this.ib=t,this.ib?this.kb().style.setProperty("cursor",t):this.kb().style.removeProperty("cursor")}yb(){return this.ib}Cb(){return m(this.Zm[0])._m()}mb(t){(t.autoSize!==void 0||!this.tb||t.width===void 0&&t.height===void 0)&&(t.autoSize&&!this.tb&&this.ab(),t.autoSize===!1&&this.tb!==null&&this.fb(),t.autoSize||t.width===void 0&&t.height===void 0||this.ob(t.width||this.o_,t.height||this.ro))}wb(t){let i=0,s=0;const Le=this.Zm[0],Oe=(Ee,$e)=>{let Ie=0;for(let Fe=0;Fe<this.Zm.length;Fe++){const He=this.Zm[Fe],ze=b(Ee==="left"?He.bm():He.wm()),je=ze.Mp();t!==null&&ze.xp(t,$e,Ie),Ie+=je.height}};this.Mb()&&(Oe("left",0),i+=b(Le.bm()).Mp().width);for(let Ee=0;Ee<this.Zm.length;Ee++){const $e=this.Zm[Ee],Ie=$e.Mp();t!==null&&$e.xp(t,i,s),s+=Ie.height}i+=Le.Mp().width,this.xb()&&(Oe("right",i),i+=b(Le.wm()).Mp().width);const Ae=(Ee,$e,Ie)=>{b(Ee==="left"?this.lb.zm():this.lb.Lm()).xp(b(t),$e,Ie)};if(this.cn.timeScale.visible){const Ee=this.lb.Mp();if(t!==null){let $e=0;this.Mb()&&(Ae("left",$e,s),$e=b(Le.bm()).Mp().width),this.lb.xp(t,$e,s),$e+=Ee.width,this.xb()&&Ae("right",$e,s)}s+=Ee.height}return size$2({width:i,height:s})}Tb(){let t=0,i=0,s=0;for(const Ne of this.Zm)this.Mb()&&(i=Math.max(i,b(Ne.bm()).ap(),this.cn.leftPriceScale.minimumWidth)),this.xb()&&(s=Math.max(s,b(Ne.wm()).ap(),this.cn.rightPriceScale.minimumWidth)),t+=Ne.g_();i=rs(i),s=rs(s);const Le=this.o_,Oe=this.ro,Ae=Math.max(Le-i-s,0),Ee=this.cn.timeScale.visible;let $e=Ee?Math.max(this.lb.Fm(),this.cn.timeScale.minimumHeight):0;var Ie;$e=(Ie=$e)+Ie%2;const Fe=0+$e,He=Oe<Fe?0:Oe-Fe,ze=He/t;let je=0;for(let Ne=0;Ne<this.Zm.length;++Ne){const Ke=this.Zm[Ne];Ke.Up(this.$i.Uc()[Ne]);let Be=0,Ue=0;Ue=Ne===this.Zm.length-1?He-je:Math.round(Ke.g_()*ze),Be=Math.max(Ue,2),je+=Be,Ke.up(size$2({width:Ae,height:Be})),this.Mb()&&Ke.om(i,"left"),this.xb()&&Ke.om(s,"right"),Ke.dp()&&this.$i.Xc(Ke.dp(),Be)}this.lb.Nm(size$2({width:Ee?Ae:0,height:$e}),Ee?i:0,Ee?s:0),this.$i.x_(Ae),this.Km!==i&&(this.Km=i),this.Gm!==s&&(this.Gm=s)}rb(t){t?this.Zd.addEventListener("wheel",this.sb,{passive:!1}):this.Zd.removeEventListener("wheel",this.sb)}Pb(t){switch(t.deltaMode){case t.DOM_DELTA_PAGE:return 120;case t.DOM_DELTA_LINE:return 32}return Es?1/window.devicePixelRatio:1}eb(t){if(!(t.deltaX!==0&&this.cn.handleScroll.mouseWheel||t.deltaY!==0&&this.cn.handleScale.mouseWheel))return;const i=this.Pb(t),s=i*t.deltaX/100,Le=-i*t.deltaY/100;if(t.cancelable&&t.preventDefault(),Le!==0&&this.cn.handleScale.mouseWheel){const Oe=Math.sign(Le)*Math.min(1,Math.abs(Le)),Ae=t.clientX-this.Zd.getBoundingClientRect().left;this.$t().Jc(Ae,Oe)}s!==0&&this.cn.handleScroll.mouseWheel&&this.$t().Qc(-80*s)}pb(t,i){var s;const Le=t.jn();Le===3&&this.Rb(),Le!==3&&Le!==2||(this.Db(t),this.Vb(t,i),this.lb.bt(),this.Zm.forEach(Oe=>{Oe.Zp()}),((s=this.Jm)===null||s===void 0?void 0:s.jn())===3&&(this.Jm.ts(t),this.Rb(),this.Db(this.Jm),this.Vb(this.Jm,i),t=this.Jm,this.Jm=null)),this.fp(t)}Vb(t,i){for(const s of t.Qn())this.ns(s,i)}Db(t){const i=this.$i.Uc();for(let s=0;s<i.length;s++)t.Hn(s).Wn&&i[s].E_()}ns(t,i){const s=this.$i.St();switch(t.qn){case 0:s.rc();break;case 1:s.hc(t.Vt);break;case 2:s.Gn(t.Vt);break;case 3:s.Jn(t.Vt);break;case 4:s.Uu();break;case 5:t.Vt.Ju(i)||s.Jn(t.Vt.Qu(i))}}Dc(t){this.Jm!==null?this.Jm.ts(t):this.Jm=t,this.Qm||(this.Qm=!0,this.Xm=window.requestAnimationFrame(i=>{if(this.Qm=!1,this.Xm=0,this.Jm!==null){const s=this.Jm;this.Jm=null,this.pb(s,i);for(const Le of s.Qn())if(Le.qn===5&&!Le.Vt.Ju(i)){this.$t().Zn(Le.Vt);break}}}))}Rb(){this._b()}_b(){const t=this.$i.Uc(),i=t.length,s=this.Zm.length;for(let Le=i;Le<s;Le++){const Oe=m(this.Zm.pop());this.nb.removeChild(Oe.hp()),Oe.hm().p(this),Oe.lm().p(this),Oe.S()}for(let Le=s;Le<i;Le++){const Oe=new Vs(this,t[Le]);Oe.hm().l(this.Ob.bind(this),this),Oe.lm().l(this.Bb.bind(this),this),this.Zm.push(Oe),this.nb.insertBefore(Oe.hp(),this.lb.hp())}for(let Le=0;Le<i;Le++){const Oe=t[Le],Ae=this.Zm[Le];Ae.dp()!==Oe?Ae.Up(Oe):Ae.$p()}this.ub(),this.Tb()}Ab(t,i,s){var Le;const Oe=new Map;t!==null&&this.$i.wt().forEach(Fe=>{const He=Fe.In().hl(t);He!==null&&Oe.set(Fe,He)});let Ae;if(t!==null){const Fe=(Le=this.$i.St().Ui(t))===null||Le===void 0?void 0:Le.originalTime;Fe!==void 0&&(Ae=Fe)}const Ee=this.$t().Fc(),$e=Ee!==null&&Ee.jc instanceof Gi?Ee.jc:void 0,Ie=Ee!==null&&Ee.Av!==void 0?Ee.Av.wr:void 0;return{Ib:Ae,se:t??void 0,zb:i??void 0,Lb:$e,Eb:Oe,Nb:Ie,Fb:s??void 0}}Ob(t,i,s){this.Dp.m(()=>this.Ab(t,i,s))}Bb(t,i,s){this.Vp.m(()=>this.Ab(t,i,s))}hb(t,i,s){this.Pc.m(()=>this.Ab(t,i,s))}ub(){const t=this.cn.timeScale.visible?"":"none";this.lb.hp().style.display=t}Mb(){return this.Zm[0].dp().P_().W().visible}xb(){return this.Zm[0].dp().R_().W().visible}ab(){return"ResizeObserver"in window&&(this.tb=new ResizeObserver(t=>{const i=t.find(s=>s.target===this.Gd);i&&this.ob(i.contentRect.width,i.contentRect.height)}),this.tb.observe(this.Gd,{box:"border-box"}),!0)}fb(){this.tb!==null&&this.tb.disconnect(),this.tb=null}}function Ws(n){return!!(n.handleScroll.mouseWheel||n.handleScale.mouseWheel)}function js(n){return function(t){return t.open!==void 0}(n)||function(t){return t.value!==void 0}(n)}function Hs(n,t){var i={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(i[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function"){var Le=0;for(s=Object.getOwnPropertySymbols(n);Le<s.length;Le++)t.indexOf(s[Le])<0&&Object.prototype.propertyIsEnumerable.call(n,s[Le])&&(i[s[Le]]=n[s[Le]])}return i}function $s(n,t,i,s){const Le=i.value,Oe={se:t,ot:n,Vt:[Le,Le,Le,Le],Ib:s};return i.color!==void 0&&(Oe.V=i.color),Oe}function Us(n,t,i,s){const Le=i.value,Oe={se:t,ot:n,Vt:[Le,Le,Le,Le],Ib:s};return i.lineColor!==void 0&&(Oe.lt=i.lineColor),i.topColor!==void 0&&(Oe.Ts=i.topColor),i.bottomColor!==void 0&&(Oe.Ps=i.bottomColor),Oe}function qs(n,t,i,s){const Le=i.value,Oe={se:t,ot:n,Vt:[Le,Le,Le,Le],Ib:s};return i.topLineColor!==void 0&&(Oe.Pe=i.topLineColor),i.bottomLineColor!==void 0&&(Oe.Re=i.bottomLineColor),i.topFillColor1!==void 0&&(Oe.Se=i.topFillColor1),i.topFillColor2!==void 0&&(Oe.ke=i.topFillColor2),i.bottomFillColor1!==void 0&&(Oe.ye=i.bottomFillColor1),i.bottomFillColor2!==void 0&&(Oe.Ce=i.bottomFillColor2),Oe}function Ys(n,t,i,s){const Le={se:t,ot:n,Vt:[i.open,i.high,i.low,i.close],Ib:s};return i.color!==void 0&&(Le.V=i.color),Le}function Zs(n,t,i,s){const Le={se:t,ot:n,Vt:[i.open,i.high,i.low,i.close],Ib:s};return i.color!==void 0&&(Le.V=i.color),i.borderColor!==void 0&&(Le.Ot=i.borderColor),i.wickColor!==void 0&&(Le.Zh=i.wickColor),Le}function Xs(n,t,i,s,Le){const Oe=m(Le)(i),Ae=Math.max(...Oe),Ee=Math.min(...Oe),$e=Oe[Oe.length-1],Ie=[$e,Ae,Ee,$e],Fe=i,{time:He,color:ze}=Fe;return{se:t,ot:n,Vt:Ie,Ib:s,He:Hs(Fe,["time","color"]),V:ze}}function Ks(n){return n.Vt!==void 0}function Gs(n,t){return t.customValues!==void 0&&(n.Wb=t.customValues),n}function Js(n){return(t,i,s,Le,Oe,Ae)=>function(Ee,$e){return $e?$e(Ee):(Ie=Ee).open===void 0&&Ie.value===void 0;var Ie}(s,Ae)?Gs({ot:t,se:i,Ib:Le},s):Gs(n(t,i,s,Le,Oe),s)}function Qs(n){return{Candlestick:Js(Zs),Bar:Js(Ys),Area:Js(Us),Baseline:Js(qs),Histogram:Js($s),Line:Js($s),Custom:Js(Xs)}[n]}function te(n){return{se:0,jb:new Map,ha:n}}function ie(n,t){if(n!==void 0&&n.length!==0)return{Hb:t.key(n[0].ot),$b:t.key(n[n.length-1].ot)}}function ne(n){let t;return n.forEach(i=>{t===void 0&&(t=i.Ib)}),m(t)}class se{constructor(t){this.Ub=new Map,this.qb=new Map,this.Yb=new Map,this.Zb=[],this.U_=t}S(){this.Ub.clear(),this.qb.clear(),this.Yb.clear(),this.Zb=[]}Xb(t,i){let s=this.Ub.size!==0,Le=!1;const Oe=this.qb.get(t);if(Oe!==void 0)if(this.qb.size===1)s=!1,Le=!0,this.Ub.clear();else for(const $e of this.Zb)$e.pointData.jb.delete(t)&&(Le=!0);let Ae=[];if(i.length!==0){const $e=i.map(je=>je.time),Ie=this.U_.createConverterToInternalObj(i),Fe=Qs(t.Jh()),He=t.ya(),ze=t.Ca();Ae=i.map((je,Ne)=>{const Ke=Ie(je.time),Be=this.U_.key(Ke);let Ue=this.Ub.get(Be);Ue===void 0&&(Ue=te(Ke),this.Ub.set(Be,Ue),Le=!0);const We=Fe(Ke,Ue.se,je,$e[Ne],He,ze);return Ue.jb.set(t,We),We})}s&&this.Kb(),this.Gb(t,Ae);let Ee=-1;if(Le){const $e=[];this.Ub.forEach(Ie=>{$e.push({timeWeight:0,time:Ie.ha,pointData:Ie,originalTime:ne(Ie.jb)})}),$e.sort((Ie,Fe)=>this.U_.key(Ie.time)-this.U_.key(Fe.time)),Ee=this.Jb($e)}return this.Qb(t,Ee,function($e,Ie,Fe){const He=ie($e,Fe),ze=ie(Ie,Fe);if(He!==void 0&&ze!==void 0)return{Ql:He.$b>=ze.$b&&He.Hb>=ze.Hb}}(this.qb.get(t),Oe,this.U_))}fd(t){return this.Xb(t,[])}tw(t,i){const s=i;(function(Ke){Ke.Ib===void 0&&(Ke.Ib=Ke.time)})(s),this.U_.preprocessData(i);const Le=this.U_.createConverterToInternalObj([i])(i.time),Oe=this.Yb.get(t);if(Oe!==void 0&&this.U_.key(Le)<this.U_.key(Oe))throw new Error(`Cannot update oldest data, last time=${Oe}, new time=${Le}`);let Ae=this.Ub.get(this.U_.key(Le));const Ee=Ae===void 0;Ae===void 0&&(Ae=te(Le),this.Ub.set(this.U_.key(Le),Ae));const $e=Qs(t.Jh()),Ie=t.ya(),Fe=t.Ca(),He=$e(Le,Ae.se,i,s.Ib,Ie,Fe);Ae.jb.set(t,He),this.iw(t,He);const ze={Ql:Ks(He)};if(!Ee)return this.Qb(t,-1,ze);const je={timeWeight:0,time:Ae.ha,pointData:Ae,originalTime:ne(Ae.jb)},Ne=Bt(this.Zb,this.U_.key(je.time),(Ke,Be)=>this.U_.key(Ke.time)<Be);this.Zb.splice(Ne,0,je);for(let Ke=Ne;Ke<this.Zb.length;++Ke)ee(this.Zb[Ke].pointData,Ke);return this.U_.fillWeightsForPoints(this.Zb,Ne),this.Qb(t,Ne,ze)}iw(t,i){let s=this.qb.get(t);s===void 0&&(s=[],this.qb.set(t,s));const Le=s.length!==0?s[s.length-1]:null;Le===null||this.U_.key(i.ot)>this.U_.key(Le.ot)?Ks(i)&&s.push(i):Ks(i)?s[s.length-1]=i:s.splice(-1,1),this.Yb.set(t,i.ot)}Gb(t,i){i.length!==0?(this.qb.set(t,i.filter(Ks)),this.Yb.set(t,i[i.length-1].ot)):(this.qb.delete(t),this.Yb.delete(t))}Kb(){for(const t of this.Zb)t.pointData.jb.size===0&&this.Ub.delete(this.U_.key(t.time))}Jb(t){let i=-1;for(let s=0;s<this.Zb.length&&s<t.length;++s){const Le=this.Zb[s],Oe=t[s];if(this.U_.key(Le.time)!==this.U_.key(Oe.time)){i=s;break}Oe.timeWeight=Le.timeWeight,ee(Oe.pointData,s)}if(i===-1&&this.Zb.length!==t.length&&(i=Math.min(this.Zb.length,t.length)),i===-1)return-1;for(let s=i;s<t.length;++s)ee(t[s].pointData,s);return this.U_.fillWeightsForPoints(t,i),this.Zb=t,i}nw(){if(this.qb.size===0)return null;let t=0;return this.qb.forEach(i=>{i.length!==0&&(t=Math.max(t,i[i.length-1].se))}),t}Qb(t,i,s){const Le={sw:new Map,St:{Lu:this.nw()}};if(i!==-1)this.qb.forEach((Oe,Ae)=>{Le.sw.set(Ae,{He:Oe,ew:Ae===t?s:void 0})}),this.qb.has(t)||Le.sw.set(t,{He:[],ew:s}),Le.St.rw=this.Zb,Le.St.hw=i;else{const Oe=this.qb.get(t);Le.sw.set(t,{He:Oe||[],ew:s})}return Le}}function ee(n,t){n.se=t,n.jb.forEach(i=>{i.se=t})}function re(n){const t={value:n.Vt[3],time:n.Ib};return n.Wb!==void 0&&(t.customValues=n.Wb),t}function he(n){const t=re(n);return n.V!==void 0&&(t.color=n.V),t}function le(n){const t=re(n);return n.lt!==void 0&&(t.lineColor=n.lt),n.Ts!==void 0&&(t.topColor=n.Ts),n.Ps!==void 0&&(t.bottomColor=n.Ps),t}function ae(n){const t=re(n);return n.Pe!==void 0&&(t.topLineColor=n.Pe),n.Re!==void 0&&(t.bottomLineColor=n.Re),n.Se!==void 0&&(t.topFillColor1=n.Se),n.ke!==void 0&&(t.topFillColor2=n.ke),n.ye!==void 0&&(t.bottomFillColor1=n.ye),n.Ce!==void 0&&(t.bottomFillColor2=n.Ce),t}function oe(n){const t={open:n.Vt[0],high:n.Vt[1],low:n.Vt[2],close:n.Vt[3],time:n.Ib};return n.Wb!==void 0&&(t.customValues=n.Wb),t}function _e(n){const t=oe(n);return n.V!==void 0&&(t.color=n.V),t}function ue(n){const t=oe(n),{V:i,Ot:s,Zh:Le}=n;return i!==void 0&&(t.color=i),s!==void 0&&(t.borderColor=s),Le!==void 0&&(t.wickColor=Le),t}function ce(n){return{Area:le,Line:he,Baseline:ae,Histogram:he,Bar:_e,Candlestick:ue,Custom:de}[n]}function de(n){const t=n.Ib;return Object.assign(Object.assign({},n.He),{time:t})}const fe={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},ve={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},pe={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:N,attributionLogo:!0},me={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0},be={rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0},we={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:N,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"};function ge(){return{width:0,height:0,autoSize:!1,layout:pe,crosshair:fe,grid:ve,overlayPriceScales:Object.assign({},me),leftPriceScale:Object.assign(Object.assign({},me),{visible:!1}),rightPriceScale:Object.assign(Object.assign({},me),{visible:!0}),timeScale:be,watermark:we,localization:{locale:ns?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class Me{constructor(t,i){this.lw=t,this.aw=i}applyOptions(t){this.lw.$t().Hc(this.aw,t)}options(){return this.Li().W()}width(){return _t(this.aw)?this.lw.gb(this.aw):0}Li(){return b(this.lw.$t().$c(this.aw)).Dt}}function xe(n,t,i){const s=Hs(n,["time","originalTime"]),Le=Object.assign({time:t},s);return i!==void 0&&(Le.originalTime=i),Le}const Se={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class ke{constructor(t){this.Eh=t}applyOptions(t){this.Eh.Hh(t)}options(){return this.Eh.W()}ow(){return this.Eh}}class ye{constructor(t,i,s,Le,Oe){this._w=new D,this.Ls=t,this.uw=i,this.cw=s,this.U_=Oe,this.dw=Le}S(){this._w.S()}priceFormatter(){return this.Ls.ma()}priceToCoordinate(t){const i=this.Ls.Ct();return i===null?null:this.Ls.Dt().Rt(t,i.Vt)}coordinateToPrice(t){const i=this.Ls.Ct();return i===null?null:this.Ls.Dt().pn(t,i.Vt)}barsInLogicalRange(t){if(t===null)return null;const i=new yn(new xn(t.from,t.to)).hu(),s=this.Ls.In();if(s.Ni())return null;const Le=s.hl(i.Vs(),1),Oe=s.hl(i.ui(),-1),Ae=b(s.sl()),Ee=b(s.An());if(Le!==null&&Oe!==null&&Le.se>Oe.se)return{barsBefore:t.from-Ae,barsAfter:Ee-t.to};const $e={barsBefore:Le===null||Le.se===Ae?t.from-Ae:Le.se-Ae,barsAfter:Oe===null||Oe.se===Ee?Ee-t.to:Ee-Oe.se};return Le!==null&&Oe!==null&&($e.from=Le.Ib,$e.to=Oe.Ib),$e}setData(t){this.U_,this.Ls.Jh(),this.uw.fw(this.Ls,t),this.pw("full")}update(t){this.Ls.Jh(),this.uw.mw(this.Ls,t),this.pw("update")}dataByIndex(t,i){const s=this.Ls.In().hl(t,i);return s===null?null:ce(this.seriesType())(s)}data(){const t=ce(this.seriesType());return this.Ls.In().ie().map(i=>t(i))}subscribeDataChanged(t){this._w.l(t)}unsubscribeDataChanged(t){this._w.v(t)}setMarkers(t){this.U_;const i=t.map(s=>xe(s,this.U_.convertHorzItemToInternal(s.time),s.time));this.Ls.ia(i)}markers(){return this.Ls.na().map(t=>xe(t,t.originalTime,void 0))}applyOptions(t){this.Ls.Hh(t)}options(){return z(this.Ls.W())}priceScale(){return this.cw.priceScale(this.Ls.Dt().Ta())}createPriceLine(t){const i=V(z(Se),t),s=this.Ls.sa(i);return new ke(s)}removePriceLine(t){this.Ls.ea(t.ow())}seriesType(){return this.Ls.Jh()}attachPrimitive(t){this.Ls.Sa(t),t.attached&&t.attached({chart:this.dw,series:this,requestUpdate:()=>this.Ls.$t().Xl()})}detachPrimitive(t){this.Ls.ka(t),t.detached&&t.detached()}pw(t){this._w.M()&&this._w.m(t)}}class Ce{constructor(t,i,s){this.bw=new D,this.pu=new D,this.Vm=new D,this.$i=t,this.kl=t.St(),this.lb=i,this.kl.tc().l(this.ww.bind(this)),this.kl.nc().l(this.gw.bind(this)),this.lb.Em().l(this.Mw.bind(this)),this.U_=s}S(){this.kl.tc().p(this),this.kl.nc().p(this),this.lb.Em().p(this),this.bw.S(),this.pu.S(),this.Vm.S()}scrollPosition(){return this.kl.ju()}scrollToPosition(t,i){i?this.kl.Gu(t,1e3):this.$i.Jn(t)}scrollToRealTime(){this.kl.Ku()}getVisibleRange(){const t=this.kl.Du();return t===null?null:{from:t.from.originalTime,to:t.to.originalTime}}setVisibleRange(t){const i={from:this.U_.convertHorzItemToInternal(t.from),to:this.U_.convertHorzItemToInternal(t.to)},s=this.kl.Au(i);this.$i.vd(s)}getVisibleLogicalRange(){const t=this.kl.Ru();return t===null?null:{from:t.Vs(),to:t.ui()}}setVisibleLogicalRange(t){p(t.from<=t.to,"The from index cannot be after the to index."),this.$i.vd(t)}resetTimeScale(){this.$i.Kn()}fitContent(){this.$i.rc()}logicalToCoordinate(t){const i=this.$i.St();return i.Ni()?null:i.It(t)}coordinateToLogical(t){return this.kl.Ni()?null:this.kl.Eu(t)}timeToCoordinate(t){const i=this.U_.convertHorzItemToInternal(t),s=this.kl.Da(i,!1);return s===null?null:this.kl.It(s)}coordinateToTime(t){const i=this.$i.St(),s=i.Eu(t),Le=i.Ui(s);return Le===null?null:Le.originalTime}width(){return this.lb._m().width}height(){return this.lb._m().height}subscribeVisibleTimeRangeChange(t){this.bw.l(t)}unsubscribeVisibleTimeRangeChange(t){this.bw.v(t)}subscribeVisibleLogicalRangeChange(t){this.pu.l(t)}unsubscribeVisibleLogicalRangeChange(t){this.pu.v(t)}subscribeSizeChange(t){this.Vm.l(t)}unsubscribeSizeChange(t){this.Vm.v(t)}applyOptions(t){this.kl.Hh(t)}options(){return Object.assign(Object.assign({},z(this.kl.W())),{barSpacing:this.kl.he()})}ww(){this.bw.M()&&this.bw.m(this.getVisibleRange())}gw(){this.pu.M()&&this.pu.m(this.getVisibleLogicalRange())}Mw(t){this.Vm.m(t.width,t.height)}}function Te(n){if(n===void 0||n.type==="custom")return;const t=n;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(i){if(i>=1)return 0;let s=0;for(;s<8;s++){const Le=Math.round(i);if(Math.abs(Le-i)<1e-8)return s;i*=10}return s}(t.minMove))}function Pe(n){return function(t){if(I(t.handleScale)){const s=t.handleScale;t.handleScale={axisDoubleClickReset:{time:s,price:s},axisPressedMouseMove:{time:s,price:s},mouseWheel:s,pinch:s}}else if(t.handleScale!==void 0){const{axisPressedMouseMove:s,axisDoubleClickReset:Le}=t.handleScale;I(s)&&(t.handleScale.axisPressedMouseMove={time:s,price:s}),I(Le)&&(t.handleScale.axisDoubleClickReset={time:Le,price:Le})}const i=t.handleScroll;I(i)&&(t.handleScroll={horzTouchDrag:i,vertTouchDrag:i,mouseWheel:i,pressedMouseMove:i})}(n),n}class Re{constructor(t,i,s){this.xw=new Map,this.Sw=new Map,this.kw=new D,this.yw=new D,this.Cw=new D,this.Tw=new se(i);const Le=s===void 0?z(ge()):V(z(ge()),Pe(s));this.U_=i,this.lw=new Fs(t,Le,i),this.lw.hm().l(Ae=>{this.kw.M()&&this.kw.m(this.Pw(Ae()))},this),this.lw.lm().l(Ae=>{this.yw.M()&&this.yw.m(this.Pw(Ae()))},this),this.lw.Zc().l(Ae=>{this.Cw.M()&&this.Cw.m(this.Pw(Ae()))},this);const Oe=this.lw.$t();this.Rw=new Ce(Oe,this.lw.cb(),this.U_)}remove(){this.lw.hm().p(this),this.lw.lm().p(this),this.lw.Zc().p(this),this.Rw.S(),this.lw.S(),this.xw.clear(),this.Sw.clear(),this.kw.S(),this.yw.S(),this.Cw.S(),this.Tw.S()}resize(t,i,s){this.autoSizeActive()||this.lw.ob(t,i,s)}addCustomSeries(t,i){const s=w(t),Le=Object.assign(Object.assign({},_),s.defaultOptions());return this.Dw("Custom",Le,i,s)}addAreaSeries(t){return this.Dw("Area",l,t)}addBaselineSeries(t){return this.Dw("Baseline",a,t)}addBarSeries(t){return this.Dw("Bar",r,t)}addCandlestickSeries(t={}){return function(i){i.borderColor!==void 0&&(i.borderUpColor=i.borderColor,i.borderDownColor=i.borderColor),i.wickColor!==void 0&&(i.wickUpColor=i.wickColor,i.wickDownColor=i.wickColor)}(t),this.Dw("Candlestick",e,t)}addHistogramSeries(t){return this.Dw("Histogram",o,t)}addLineSeries(t){return this.Dw("Line",h,t)}removeSeries(t){const i=m(this.xw.get(t)),s=this.Tw.fd(i);this.lw.$t().fd(i),this.Vw(s),this.xw.delete(t),this.Sw.delete(i)}fw(t,i){this.Vw(this.Tw.Xb(t,i))}mw(t,i){this.Vw(this.Tw.tw(t,i))}subscribeClick(t){this.kw.l(t)}unsubscribeClick(t){this.kw.v(t)}subscribeCrosshairMove(t){this.Cw.l(t)}unsubscribeCrosshairMove(t){this.Cw.v(t)}subscribeDblClick(t){this.yw.l(t)}unsubscribeDblClick(t){this.yw.v(t)}priceScale(t){return new Me(this.lw,t)}timeScale(){return this.Rw}applyOptions(t){this.lw.Hh(Pe(t))}options(){return this.lw.W()}takeScreenshot(){return this.lw.bb()}autoSizeActive(){return this.lw.Sb()}chartElement(){return this.lw.kb()}paneSize(){const t=this.lw.Cb();return{height:t.height,width:t.width}}setCrosshairPosition(t,i,s){const Le=this.xw.get(s);if(Le===void 0)return;const Oe=this.lw.$t().cr(Le);Oe!==null&&this.lw.$t().ld(t,i,Oe)}clearCrosshairPosition(){this.lw.$t().ad(!0)}Dw(t,i,s={},Le){Te(s.priceFormat);const Oe=V(z(u),z(i),s),Ae=this.lw.$t().ud(t,Oe,Le),Ee=new ye(Ae,this,this,this,this.U_);return this.xw.set(Ee,Ae),this.Sw.set(Ae,Ee),Ee}Vw(t){const i=this.lw.$t();i.od(t.St.Lu,t.St.rw,t.St.hw),t.sw.forEach((s,Le)=>Le.J(s.He,s.ew)),i.Fu()}Ow(t){return m(this.Sw.get(t))}Pw(t){const i=new Map;t.Eb.forEach((Le,Oe)=>{const Ae=Oe.Jh(),Ee=ce(Ae)(Le);if(Ae!=="Custom")p(js(Ee));else{const $e=Oe.Ca();p(!$e||$e(Ee)===!1)}i.set(this.Ow(Oe),Ee)});const s=t.Lb!==void 0&&this.Sw.has(t.Lb)?this.Ow(t.Lb):void 0;return{time:t.Ib,logical:t.se,point:t.zb,hoveredSeries:s,hoveredObjectId:t.Nb,seriesData:i,sourceEvent:t.Fb}}}function De(n,t,i){let s;if(A(n)){const Oe=document.getElementById(n);p(Oe!==null,`Cannot find element in DOM with id=${n}`),s=Oe}else s=n;const Le=new Re(s,t,i);return t.setOptions(Le.options()),Le}function Ve(n,t){return De(n,new is,is.Ad(t))}Object.assign(Object.assign({},u),_);var _tmpl$$d=template("<div>");const badgeVariants=cva("inline-flex items-center border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),Badge=n=>{const[t,i]=splitProps(n,["class","variant","round"]);return(()=>{var s=_tmpl$$d();return spread(s,mergeProps({get class(){return cn$1(badgeVariants({variant:t.variant}),t.round?"rounded-full":"rounded-md",t.class)}},i),!1,!1),s})()};var _tmpl$$c=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M12 5l0 14"></path><path d="M18 11l-6 -6"></path><path d="M6 11l6 -6">'),_tmpl$2$7=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M17 7l-10 10"></path><path d="M8 7l9 0l0 9">'),_tmpl$3$4=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M5 12l14 0"></path><path d="M13 18l6 -6"></path><path d="M13 6l6 6">'),_tmpl$4$2=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M7 7l10 10"></path><path d="M17 8l0 9l-9 0">'),_tmpl$5$2=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round><path d="M12 5l0 14"></path><path d="M18 13l-6 6"></path><path d="M6 13l6 6">'),_tmpl$6$2=template('<span class="flex gap-1">');const badgeDeltaVariants=cva("",{variants:{variant:{success:"bg-success text-success-foreground hover:bg-success",warning:"bg-warning text-warning-foreground hover:bg-warning",error:"bg-error text-error-foreground hover:bg-error"}}}),iconMap={increase:n=>(()=>{var t=_tmpl$$c();return createRenderEffect(()=>setAttribute(t,"class",n.class)),t})(),moderateIncrease:n=>(()=>{var t=_tmpl$2$7();return createRenderEffect(()=>setAttribute(t,"class",n.class)),t})(),unchanged:n=>(()=>{var t=_tmpl$3$4();return createRenderEffect(()=>setAttribute(t,"class",n.class)),t})(),moderateDecrease:n=>(()=>{var t=_tmpl$4$2();return createRenderEffect(()=>setAttribute(t,"class",n.class)),t})(),decrease:n=>(()=>{var t=_tmpl$5$2();return createRenderEffect(()=>setAttribute(t,"class",n.class)),t})()},variantMap={increase:"success",moderateIncrease:"success",unchanged:"warning",moderateDecrease:"error",decrease:"error"},BadgeDelta=n=>{const[t,i]=splitProps(n,["class","children","deltaType"]);let s=iconMap[t.deltaType];return createEffect(on$1(()=>t.deltaType,()=>{s=iconMap[t.deltaType]})),createComponent(Badge,mergeProps({get class(){return cn$1(badgeDeltaVariants({variant:variantMap[t.deltaType]}),t.class)}},i,{get children(){var Le=_tmpl$6$2();return insert(Le,createComponent(s,{class:"size-4"}),null),insert(Le,()=>t.children,null),Le}}))};var _tmpl$$b=template('<div class="relative w-full overflow-auto"><table>'),_tmpl$2$6=template("<thead>"),_tmpl$3$3=template("<tbody>"),_tmpl$5$1=template("<tr>"),_tmpl$6$1=template("<th>"),_tmpl$7$1=template("<td>"),_tmpl$8$1=template("<caption>");const Table=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$$b(),Le=s.firstChild;return spread(Le,mergeProps({get class(){return cn$1("w-full caption-bottom text-sm",t.class)}},i),!1,!1),s})()},TableHeader=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$2$6();return spread(s,mergeProps({get class(){return cn$1("[&_tr]:border-b",t.class)}},i),!1,!1),s})()},TableBody=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$3$3();return spread(s,mergeProps({get class(){return cn$1("[&_tr:last-child]:border-0",t.class)}},i),!1,!1),s})()},TableRow=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$5$1();return spread(s,mergeProps({get class(){return cn$1("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t.class)}},i),!1,!1),s})()},TableHead=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$6$1();return spread(s,mergeProps({get class(){return cn$1("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t.class)}},i),!1,!1),s})()},TableCell=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$7$1();return spread(s,mergeProps({get class(){return cn$1("p-4 align-middle [&:has([role=checkbox])]:pr-0",t.class)}},i),!1,!1),s})()},TableCaption=n=>{const[t,i]=splitProps(n,["class"]);return(()=>{var s=_tmpl$8$1();return spread(s,mergeProps({get class(){return cn$1("mt-4 text-sm text-muted-foreground",t.class)}},i),!1,!1),s})()},btcUsdData=[{Date:"2021-01-01",Open:28994.009766,High:29600.626953,Low:28803.585938,Close:29374.152344,"Adj Close":29374.152344,Volume:40730301359},{Date:"2021-01-02",Open:29376.455078,High:33155.117188,Low:29091.181641,Close:32127.267578,"Adj Close":32127.267578,Volume:67865420765},{Date:"2021-01-03",Open:32129.408203,High:34608.558594,Low:32052.316406,Close:32782.023438,"Adj Close":32782.023438,Volume:78665235202},{Date:"2021-01-04",Open:32810.949219,High:33440.21875,Low:28722.755859,Close:31971.914063,"Adj Close":31971.914063,Volume:81163475344},{Date:"2021-01-05",Open:31977.041016,High:34437.589844,Low:30221.1875,Close:33992.429688,"Adj Close":33992.429688,Volume:67547324782},{Date:"2021-01-06",Open:34013.613281,High:36879.699219,Low:33514.035156,Close:36824.363281,"Adj Close":36824.363281,Volume:75289433811},{Date:"2021-01-07",Open:36833.875,High:40180.367188,Low:36491.191406,Close:39371.042969,"Adj Close":39371.042969,Volume:84762141031},{Date:"2021-01-08",Open:39381.765625,High:41946.738281,Low:36838.636719,Close:40797.609375,"Adj Close":40797.609375,Volume:88107519480},{Date:"2021-01-09",Open:40788.640625,High:41436.351563,Low:38980.875,Close:40254.546875,"Adj Close":40254.546875,Volume:61984162837},{Date:"2021-01-10",Open:40254.21875,High:41420.191406,Low:35984.628906,Close:38356.441406,"Adj Close":38356.441406,Volume:79980747690},{Date:"2021-01-11",Open:38346.53125,High:38346.53125,Low:30549.599609,Close:35566.65625,"Adj Close":35566.65625,Volume:123320567399},{Date:"2021-01-12",Open:35516.359375,High:36568.527344,Low:32697.976563,Close:33922.960938,"Adj Close":33922.960938,Volume:74773277909},{Date:"2021-01-13",Open:33915.121094,High:37599.960938,Low:32584.667969,Close:37316.359375,"Adj Close":37316.359375,Volume:69364315979},{Date:"2021-01-14",Open:37325.109375,High:39966.40625,Low:36868.5625,Close:39187.328125,"Adj Close":39187.328125,Volume:63615990033},{Date:"2021-01-15",Open:39156.707031,High:39577.710938,Low:34659.589844,Close:36825.367188,"Adj Close":36825.367188,Volume:67760757881},{Date:"2021-01-16",Open:36821.648438,High:37864.367188,Low:35633.554688,Close:36178.140625,"Adj Close":36178.140625,Volume:57706187875},{Date:"2021-01-17",Open:36163.648438,High:36722.351563,Low:34069.320313,Close:35791.277344,"Adj Close":35791.277344,Volume:52359854336},{Date:"2021-01-18",Open:35792.238281,High:37299.285156,Low:34883.84375,Close:36630.074219,"Adj Close":36630.074219,Volume:49511702429},{Date:"2021-01-19",Open:36642.234375,High:37755.890625,Low:36069.804688,Close:36069.804688,"Adj Close":36069.804688,Volume:57244195486},{Date:"2021-01-20",Open:36050.113281,High:36378.328125,Low:33570.476563,Close:35547.75,"Adj Close":35547.75,Volume:66834573161},{Date:"2021-01-21",Open:35549.398438,High:35552.679688,Low:30250.75,Close:30825.699219,"Adj Close":30825.699219,Volume:75643067688},{Date:"2021-01-22",Open:30817.625,High:33811.851563,Low:28953.373047,Close:33005.761719,"Adj Close":33005.761719,Volume:77207272511},{Date:"2021-01-23",Open:32985.757813,High:33360.976563,Low:31493.160156,Close:32067.642578,"Adj Close":32067.642578,Volume:48354737975},{Date:"2021-01-24",Open:32064.376953,High:32944.007813,Low:31106.685547,Close:32289.378906,"Adj Close":32289.378906,Volume:48643830599},{Date:"2021-01-25",Open:32285.798828,High:34802.742188,Low:32087.787109,Close:32366.392578,"Adj Close":32366.392578,Volume:59897054838},{Date:"2021-01-26",Open:32358.613281,High:32794.550781,Low:31030.265625,Close:32569.849609,"Adj Close":32569.849609,Volume:60255421470},{Date:"2021-01-27",Open:32564.029297,High:32564.029297,Low:29367.138672,Close:30432.546875,"Adj Close":30432.546875,Volume:62576762015},{Date:"2021-01-28",Open:30441.041016,High:33858.3125,Low:30023.207031,Close:33466.097656,"Adj Close":33466.097656,Volume:76517157706},{Date:"2021-01-29",Open:34318.671875,High:38406.261719,Low:32064.814453,Close:34316.386719,"Adj Close":34316.386719,Volume:117894572511},{Date:"2021-01-30",Open:34295.933594,High:34834.707031,Low:32940.1875,Close:34269.523438,"Adj Close":34269.523438,Volume:65141828798},{Date:"2021-01-31",Open:34270.878906,High:34288.332031,Low:32270.175781,Close:33114.359375,"Adj Close":33114.359375,Volume:52754542671},{Date:"2021-02-01",Open:33114.578125,High:34638.214844,Low:32384.228516,Close:33537.175781,"Adj Close":33537.175781,Volume:61400400660},{Date:"2021-02-02",Open:33533.199219,High:35896.882813,Low:33489.21875,Close:35510.289063,"Adj Close":35510.289063,Volume:63088585433},{Date:"2021-02-03",Open:35510.820313,High:37480.1875,Low:35443.984375,Close:37472.089844,"Adj Close":37472.089844,Volume:61166818159},{Date:"2021-02-04",Open:37475.105469,High:38592.175781,Low:36317.5,Close:36926.066406,"Adj Close":36926.066406,Volume:68838074392},{Date:"2021-02-05",Open:36931.546875,High:38225.90625,Low:36658.761719,Close:38144.308594,"Adj Close":38144.308594,Volume:58598066402},{Date:"2021-02-06",Open:38138.386719,High:40846.546875,Low:38138.386719,Close:39266.011719,"Adj Close":39266.011719,Volume:71326033653},{Date:"2021-02-07",Open:39250.191406,High:39621.835938,Low:37446.152344,Close:38903.441406,"Adj Close":38903.441406,Volume:65500641143},{Date:"2021-02-08",Open:38886.828125,High:46203.929688,Low:38076.324219,Close:46196.464844,"Adj Close":46196.464844,Volume:101467222687},{Date:"2021-02-09",Open:46184.992188,High:48003.722656,Low:45166.960938,Close:46481.105469,"Adj Close":46481.105469,Volume:91809846886},{Date:"2021-02-10",Open:46469.761719,High:47145.566406,Low:43881.152344,Close:44918.183594,"Adj Close":44918.183594,Volume:87301089896},{Date:"2021-02-11",Open:44898.710938,High:48463.46875,Low:44187.761719,Close:47909.332031,"Adj Close":47909.332031,Volume:81388911810},{Date:"2021-02-12",Open:47877.035156,High:48745.734375,Low:46424.976563,Close:47504.851563,"Adj Close":47504.851563,Volume:76555041196},{Date:"2021-02-13",Open:47491.203125,High:48047.746094,Low:46392.28125,Close:47105.515625,"Adj Close":47105.515625,Volume:70250456155},{Date:"2021-02-14",Open:47114.507813,High:49487.640625,Low:47114.507813,Close:48717.289063,"Adj Close":48717.289063,Volume:71248675228},{Date:"2021-02-15",Open:48696.535156,High:48875.570313,Low:46347.476563,Close:47945.058594,"Adj Close":47945.058594,Volume:77069903166},{Date:"2021-02-16",Open:47944.457031,High:50341.101563,Low:47201.304688,Close:49199.871094,"Adj Close":49199.871094,Volume:77049582886},{Date:"2021-02-17",Open:49207.277344,High:52533.914063,Low:49072.378906,Close:52149.007813,"Adj Close":52149.007813,Volume:80820545404},{Date:"2021-02-18",Open:52140.972656,High:52474.105469,Low:51015.765625,Close:51679.796875,"Adj Close":51679.796875,Volume:52054723579},{Date:"2021-02-19",Open:51675.980469,High:56113.652344,Low:50937.277344,Close:55888.132813,"Adj Close":55888.132813,Volume:63495496918},{Date:"2021-02-20",Open:55887.335938,High:57505.226563,Low:54626.558594,Close:56099.519531,"Adj Close":56099.519531,Volume:68145460026},{Date:"2021-02-21",Open:56068.566406,High:58330.570313,Low:55672.609375,Close:57539.945313,"Adj Close":57539.945313,Volume:51897585191},{Date:"2021-02-22",Open:57532.738281,High:57533.390625,Low:48967.566406,Close:54207.320313,"Adj Close":54207.320313,Volume:92052420332},{Date:"2021-02-23",Open:54204.929688,High:54204.929688,Low:45290.589844,Close:48824.425781,"Adj Close":48824.425781,Volume:106102492824},{Date:"2021-02-24",Open:48835.085938,High:51290.136719,Low:47213.5,Close:49705.332031,"Adj Close":49705.332031,Volume:63695521388},{Date:"2021-02-25",Open:49709.082031,High:51948.96875,Low:47093.851563,Close:47093.851563,"Adj Close":47093.851563,Volume:54506565949},{Date:"2021-02-26",Open:47180.464844,High:48370.785156,Low:44454.84375,Close:46339.761719,"Adj Close":46339.761719,Volume:350967941479},{Date:"2021-02-27",Open:46344.773438,High:48253.269531,Low:45269.027344,Close:46188.453125,"Adj Close":46188.453125,Volume:45910946382},{Date:"2021-02-28",Open:46194.015625,High:46716.429688,Low:43241.617188,Close:45137.769531,"Adj Close":45137.769531,Volume:53443887451},{Date:"2021-03-01",Open:45159.503906,High:49784.015625,Low:45115.09375,Close:49631.242188,"Adj Close":49631.242188,Volume:53891300112},{Date:"2021-03-02",Open:49612.105469,High:50127.511719,Low:47228.84375,Close:48378.988281,"Adj Close":48378.988281,Volume:47530897720},{Date:"2021-03-03",Open:48415.816406,High:52535.136719,Low:48274.320313,Close:50538.242188,"Adj Close":50538.242188,Volume:53220811975},{Date:"2021-03-04",Open:50522.304688,High:51735.089844,Low:47656.929688,Close:48561.167969,"Adj Close":48561.167969,Volume:52343816680},{Date:"2021-03-05",Open:48527.03125,High:49396.429688,Low:46542.515625,Close:48927.304688,"Adj Close":48927.304688,Volume:48625928883},{Date:"2021-03-06",Open:48899.230469,High:49147.21875,Low:47257.527344,Close:48912.382813,"Adj Close":48912.382813,Volume:34363564661},{Date:"2021-03-07",Open:48918.679688,High:51384.367188,Low:48918.679688,Close:51206.691406,"Adj Close":51206.691406,Volume:43137459378},{Date:"2021-03-08",Open:51174.117188,High:52314.070313,Low:49506.054688,Close:52246.523438,"Adj Close":52246.523438,Volume:48597428048},{Date:"2021-03-09",Open:52272.96875,High:54824.117188,Low:51981.832031,Close:54824.117188,"Adj Close":54824.117188,Volume:50912227385},{Date:"2021-03-10",Open:54824.011719,High:57258.253906,Low:53290.890625,Close:56008.550781,"Adj Close":56008.550781,Volume:57295577614},{Date:"2021-03-11",Open:55963.179688,High:58091.0625,Low:54484.59375,Close:57805.121094,"Adj Close":57805.121094,Volume:56772343595},{Date:"2021-03-12",Open:57821.21875,High:57996.621094,Low:55376.648438,Close:57332.089844,"Adj Close":57332.089844,Volume:55689944702},{Date:"2021-03-13",Open:57343.371094,High:61683.863281,Low:56217.972656,Close:61243.085938,"Adj Close":61243.085938,Volume:60669829814},{Date:"2021-03-14",Open:61221.132813,High:61597.917969,Low:59302.316406,Close:59302.316406,"Adj Close":59302.316406,Volume:43901225564},{Date:"2021-03-15",Open:59267.429688,High:60540.992188,Low:55393.164063,Close:55907.199219,"Adj Close":55907.199219,Volume:66419369890},{Date:"2021-03-16",Open:55840.785156,High:56833.179688,Low:53555.027344,Close:56804.902344,"Adj Close":56804.902344,Volume:59749798599},{Date:"2021-03-17",Open:56825.828125,High:58969.816406,Low:54528.628906,Close:58870.894531,"Adj Close":58870.894531,Volume:60258313191},{Date:"2021-03-18",Open:58893.078125,High:60116.25,Low:54253.578125,Close:57858.921875,"Adj Close":57858.921875,Volume:55746041e3},{Date:"2021-03-19",Open:57850.441406,High:59498.375,Low:56643.703125,Close:58346.652344,"Adj Close":58346.652344,Volume:49063873786},{Date:"2021-03-20",Open:58332.261719,High:60031.285156,Low:58213.296875,Close:58313.644531,"Adj Close":58313.644531,Volume:50361731222},{Date:"2021-03-21",Open:58309.914063,High:58767.898438,Low:56005.617188,Close:57523.421875,"Adj Close":57523.421875,Volume:51943414539},{Date:"2021-03-22",Open:57517.890625,High:58471.480469,Low:54288.15625,Close:54529.144531,"Adj Close":54529.144531,Volume:56521454974},{Date:"2021-03-23",Open:54511.660156,High:55985.441406,Low:53470.695313,Close:54738.945313,"Adj Close":54738.945313,Volume:56435023914},{Date:"2021-03-24",Open:54710.488281,High:57262.382813,Low:52514.332031,Close:52774.265625,"Adj Close":52774.265625,Volume:70567223787},{Date:"2021-03-25",Open:52726.746094,High:53392.386719,Low:50856.570313,Close:51704.160156,"Adj Close":51704.160156,Volume:67999812841},{Date:"2021-03-26",Open:51683.011719,High:55137.3125,Low:51579.855469,Close:55137.3125,"Adj Close":55137.3125,Volume:56652197978},{Date:"2021-03-27",Open:55137.566406,High:56568.214844,Low:54242.910156,Close:55973.511719,"Adj Close":55973.511719,Volume:47266542233},{Date:"2021-03-28",Open:55974.941406,High:56610.3125,Low:55071.113281,Close:55950.746094,"Adj Close":55950.746094,Volume:47686580918},{Date:"2021-03-29",Open:55947.898438,High:58342.097656,Low:55139.339844,Close:57750.199219,"Adj Close":57750.199219,Volume:57625587027},{Date:"2021-03-30",Open:57750.132813,High:59447.222656,Low:57251.550781,Close:58917.691406,"Adj Close":58917.691406,Volume:54414116432},{Date:"2021-03-31",Open:58930.277344,High:59930.027344,Low:57726.417969,Close:58918.832031,"Adj Close":58918.832031,Volume:65520826225},{Date:"2021-04-01",Open:58926.5625,High:59586.070313,Low:58505.277344,Close:59095.808594,"Adj Close":59095.808594,Volume:61669163792},{Date:"2021-04-02",Open:59098.878906,High:60267.1875,Low:58869.28125,Close:59384.3125,"Adj Close":59384.3125,Volume:58727860620},{Date:"2021-04-03",Open:59397.410156,High:60110.269531,Low:57603.890625,Close:57603.890625,"Adj Close":57603.890625,Volume:59641344484},{Date:"2021-04-04",Open:57604.839844,High:58913.746094,Low:57168.675781,Close:58758.554688,"Adj Close":58758.554688,Volume:50749662970},{Date:"2021-04-05",Open:58760.875,High:59891.296875,Low:57694.824219,Close:59057.878906,"Adj Close":59057.878906,Volume:60706272115},{Date:"2021-04-06",Open:59171.933594,High:59479.578125,Low:57646.808594,Close:58192.359375,"Adj Close":58192.359375,Volume:66058027988},{Date:"2021-04-07",Open:58186.507813,High:58731.144531,Low:55604.023438,Close:56048.9375,"Adj Close":56048.9375,Volume:75645303584},{Date:"2021-04-08",Open:56099.914063,High:58338.738281,Low:55879.085938,Close:58323.953125,"Adj Close":58323.953125,Volume:53053855641},{Date:"2021-04-09",Open:58326.5625,High:58937.046875,Low:57807.863281,Close:58245.003906,"Adj Close":58245.003906,Volume:46655208546},{Date:"2021-04-10",Open:58253.777344,High:61276.664063,Low:58038.707031,Close:59793.234375,"Adj Close":59793.234375,Volume:58238470525},{Date:"2021-04-11",Open:59846.230469,High:60790.554688,Low:59289.796875,Close:60204.964844,"Adj Close":60204.964844,Volume:46280252580},{Date:"2021-04-12",Open:60175.945313,High:61253.035156,Low:59589.875,Close:59893.453125,"Adj Close":59893.453125,Volume:51828688519},{Date:"2021-04-13",Open:59890.019531,High:63742.285156,Low:59869.957031,Close:63503.457031,"Adj Close":63503.457031,Volume:69983454362},{Date:"2021-04-14",Open:63523.753906,High:64863.097656,Low:61554.796875,Close:63109.695313,"Adj Close":63109.695313,Volume:77451779687},{Date:"2021-04-15",Open:63075.195313,High:63821.671875,Low:62208.964844,Close:63314.011719,"Adj Close":63314.011719,Volume:60954381579},{Date:"2021-04-16",Open:63258.503906,High:63594.722656,Low:60222.53125,Close:61572.789063,"Adj Close":61572.789063,Volume:84293007468},{Date:"2021-04-17",Open:61529.921875,High:62572.175781,Low:60361.351563,Close:60683.820313,"Adj Close":60683.820313,Volume:66138759198},{Date:"2021-04-18",Open:60701.886719,High:61057.457031,Low:52829.535156,Close:56216.183594,"Adj Close":56216.183594,Volume:97468872758},{Date:"2021-04-19",Open:56191.585938,High:57520.054688,Low:54368.59375,Close:55724.265625,"Adj Close":55724.265625,Volume:65344865159},{Date:"2021-04-20",Open:55681.792969,High:57062.148438,Low:53448.046875,Close:56473.03125,"Adj Close":56473.03125,Volume:67849323955},{Date:"2021-04-21",Open:56471.128906,High:56757.972656,Low:53695.46875,Close:53906.089844,"Adj Close":53906.089844,Volume:54926612466},{Date:"2021-04-22",Open:53857.105469,High:55410.230469,Low:50583.8125,Close:51762.273438,"Adj Close":51762.273438,Volume:74798630778},{Date:"2021-04-23",Open:51739.808594,High:52120.792969,Low:47714.664063,Close:51093.652344,"Adj Close":51093.652344,Volume:86668667320},{Date:"2021-04-24",Open:51143.226563,High:51167.5625,Low:48805.285156,Close:50050.867188,"Adj Close":50050.867188,Volume:49014494781},{Date:"2021-04-25",Open:50052.832031,High:50506.019531,Low:47159.484375,Close:49004.253906,"Adj Close":49004.253906,Volume:46117114240},{Date:"2021-04-26",Open:49077.792969,High:54288.003906,Low:48852.796875,Close:54021.753906,"Adj Close":54021.753906,Volume:58284039825},{Date:"2021-04-27",Open:54030.304688,High:55416.964844,Low:53319.1875,Close:55033.117188,"Adj Close":55033.117188,Volume:49448222757},{Date:"2021-04-28",Open:55036.636719,High:56227.207031,Low:53887.917969,Close:54824.703125,"Adj Close":54824.703125,Volume:48000572955},{Date:"2021-04-29",Open:54858.089844,High:55115.84375,Low:52418.027344,Close:53555.109375,"Adj Close":53555.109375,Volume:46088929780},{Date:"2021-04-30",Open:53568.664063,High:57900.71875,Low:53129.601563,Close:57750.175781,"Adj Close":57750.175781,Volume:52395931985},{Date:"2021-05-01",Open:57714.664063,High:58448.339844,Low:57052.273438,Close:57828.050781,"Adj Close":57828.050781,Volume:42836427360},{Date:"2021-05-02",Open:57825.863281,High:57902.59375,Low:56141.90625,Close:56631.078125,"Adj Close":56631.078125,Volume:38177405335},{Date:"2021-05-03",Open:56620.273438,High:58973.308594,Low:56590.871094,Close:57200.292969,"Adj Close":57200.292969,Volume:51713139031},{Date:"2021-05-04",Open:57214.179688,High:57214.179688,Low:53191.425781,Close:53333.539063,"Adj Close":53333.539063,Volume:68564706967},{Date:"2021-05-05",Open:53252.164063,High:57911.363281,Low:52969.054688,Close:57424.007813,"Adj Close":57424.007813,Volume:69241316747},{Date:"2021-05-06",Open:57441.308594,High:58363.316406,Low:55382.507813,Close:56396.515625,"Adj Close":56396.515625,Volume:69523285106},{Date:"2021-05-07",Open:56413.953125,High:58606.632813,Low:55321.847656,Close:57356.402344,"Adj Close":57356.402344,Volume:68434023376},{Date:"2021-05-08",Open:57352.765625,High:59464.613281,Low:56975.210938,Close:58803.777344,"Adj Close":58803.777344,Volume:65382980634},{Date:"2021-05-09",Open:58877.390625,High:59210.882813,Low:56482.003906,Close:58232.316406,"Adj Close":58232.316406,Volume:65906690347},{Date:"2021-05-10",Open:58250.871094,High:59519.355469,Low:54071.457031,Close:55859.796875,"Adj Close":55859.796875,Volume:71776546298},{Date:"2021-05-11",Open:55847.242188,High:56872.542969,Low:54608.652344,Close:56704.574219,"Adj Close":56704.574219,Volume:61308396325},{Date:"2021-05-12",Open:56714.53125,High:57939.363281,Low:49150.535156,Close:49150.535156,"Adj Close":49150.535156,Volume:75215403907},{Date:"2021-05-13",Open:49735.433594,High:51330.84375,Low:46980.019531,Close:49716.191406,"Adj Close":49716.191406,Volume:96721152926},{Date:"2021-05-14",Open:49682.980469,High:51438.117188,Low:48868.578125,Close:49880.535156,"Adj Close":49880.535156,Volume:55737497453},{Date:"2021-05-15",Open:49855.496094,High:50639.664063,Low:46664.140625,Close:46760.1875,"Adj Close":46760.1875,Volume:59161047474},{Date:"2021-05-16",Open:46716.636719,High:49720.042969,Low:43963.351563,Close:46456.058594,"Adj Close":46456.058594,Volume:64047871555},{Date:"2021-05-17",Open:46415.898438,High:46623.558594,Low:42207.289063,Close:43537.511719,"Adj Close":43537.511719,Volume:74903638450},{Date:"2021-05-18",Open:43488.058594,High:45812.457031,Low:42367.832031,Close:42909.402344,"Adj Close":42909.402344,Volume:56187365084},{Date:"2021-05-19",Open:42944.976563,High:43546.117188,Low:30681.496094,Close:37002.441406,"Adj Close":37002.441406,Volume:126358098747},{Date:"2021-05-20",Open:36753.667969,High:42462.984375,Low:35050.617188,Close:40782.738281,"Adj Close":40782.738281,Volume:88281943359},{Date:"2021-05-21",Open:40596.949219,High:42172.171875,Low:33616.453125,Close:37304.691406,"Adj Close":37304.691406,Volume:82051616861},{Date:"2021-05-22",Open:37371.03125,High:38831.054688,Low:35383.683594,Close:37536.632813,"Adj Close":37536.632813,Volume:57377273240},{Date:"2021-05-23",Open:37531.449219,High:38289.21875,Low:31227.339844,Close:34770.582031,"Adj Close":34770.582031,Volume:78469274361},{Date:"2021-05-24",Open:34700.363281,High:39835.140625,Low:34551.082031,Close:38705.980469,"Adj Close":38705.980469,Volume:67359584098},{Date:"2021-05-25",Open:38795.78125,High:39776.351563,Low:36581.429688,Close:38402.222656,"Adj Close":38402.222656,Volume:56211915803},{Date:"2021-05-26",Open:38392.625,High:40782.078125,Low:37905.835938,Close:39294.199219,"Adj Close":39294.199219,Volume:51346735160},{Date:"2021-05-27",Open:39316.890625,High:40379.617188,Low:37247.902344,Close:38436.96875,"Adj Close":38436.96875,Volume:43210968721},{Date:"2021-05-28",Open:38507.082031,High:38856.96875,Low:34779.039063,Close:35697.605469,"Adj Close":35697.605469,Volume:55200191952},{Date:"2021-05-29",Open:35684.15625,High:37234.5,Low:33693.929688,Close:34616.066406,"Adj Close":34616.066406,Volume:45231013335},{Date:"2021-05-30",Open:34607.40625,High:36400.667969,Low:33520.738281,Close:35678.128906,"Adj Close":35678.128906,Volume:31646080921},{Date:"2021-05-31",Open:35658.59375,High:37468.25,Low:34241.945313,Close:37332.855469,"Adj Close":37332.855469,Volume:39009847639},{Date:"2021-06-01",Open:37293.792969,High:37896.734375,Low:35787.085938,Close:36684.925781,"Adj Close":36684.925781,Volume:34639423297},{Date:"2021-06-02",Open:36699.921875,High:38231.339844,Low:35966.308594,Close:37575.179688,"Adj Close":37575.179688,Volume:33070867190},{Date:"2021-06-03",Open:37599.410156,High:39478.953125,Low:37243.972656,Close:39208.765625,"Adj Close":39208.765625,Volume:35460750427},{Date:"2021-06-04",Open:39242.484375,High:39242.484375,Low:35717.722656,Close:36894.40625,"Adj Close":36894.40625,Volume:41831090187},{Date:"2021-06-05",Open:36880.15625,High:37917.714844,Low:34900.414063,Close:35551.957031,"Adj Close":35551.957031,Volume:35959473399},{Date:"2021-06-06",Open:35538.609375,High:36436.421875,Low:35304.578125,Close:35862.378906,"Adj Close":35862.378906,Volume:28913440585},{Date:"2021-06-07",Open:35835.265625,High:36790.570313,Low:33480.640625,Close:33560.707031,"Adj Close":33560.707031,Volume:33683936663},{Date:"2021-06-08",Open:33589.519531,High:34017.386719,Low:31114.443359,Close:33472.632813,"Adj Close":33472.632813,Volume:49902050442},{Date:"2021-06-09",Open:33416.976563,High:37537.371094,Low:32475.865234,Close:37345.121094,"Adj Close":37345.121094,Volume:53972919008},{Date:"2021-06-10",Open:37389.515625,High:38334.324219,Low:35847.59375,Close:36702.597656,"Adj Close":36702.597656,Volume:43576032854},{Date:"2021-06-11",Open:36697.03125,High:37608.695313,Low:36044.449219,Close:37334.398438,"Adj Close":37334.398438,Volume:38699736985},{Date:"2021-06-12",Open:37340.144531,High:37408.925781,Low:34728.191406,Close:35552.515625,"Adj Close":35552.515625,Volume:37924228550},{Date:"2021-06-13",Open:35555.789063,High:39322.78125,Low:34864.109375,Close:39097.859375,"Adj Close":39097.859375,Volume:40669112838},{Date:"2021-06-14",Open:39016.96875,High:40978.363281,Low:38757.285156,Close:40218.476563,"Adj Close":40218.476563,Volume:43148914673},{Date:"2021-06-15",Open:40427.167969,High:41295.269531,Low:39609.46875,Close:40406.269531,"Adj Close":40406.269531,Volume:46420149185},{Date:"2021-06-16",Open:40168.691406,High:40516.777344,Low:38176.035156,Close:38347.0625,"Adj Close":38347.0625,Volume:39211635100},{Date:"2021-06-17",Open:38341.421875,High:39513.671875,Low:37439.675781,Close:38053.503906,"Adj Close":38053.503906,Volume:37096670047},{Date:"2021-06-18",Open:38099.476563,High:38187.261719,Low:35255.855469,Close:35787.246094,"Adj Close":35787.246094,Volume:36200887275},{Date:"2021-06-19",Open:35854.527344,High:36457.796875,Low:34933.0625,Close:35615.871094,"Adj Close":35615.871094,Volume:31207279719},{Date:"2021-06-20",Open:35563.140625,High:36059.484375,Low:33432.074219,Close:35698.296875,"Adj Close":35698.296875,Volume:36664034054},{Date:"2021-06-21",Open:35641.144531,High:35721.640625,Low:31295.935547,Close:31676.693359,"Adj Close":31676.693359,Volume:52809038594},{Date:"2021-06-22",Open:31622.376953,High:33292.453125,Low:28893.621094,Close:32505.660156,"Adj Close":32505.660156,Volume:58964353058},{Date:"2021-06-23",Open:32515.714844,High:34753.410156,Low:31772.632813,Close:33723.027344,"Adj Close":33723.027344,Volume:46317108925},{Date:"2021-06-24",Open:33682.800781,High:35228.851563,Low:32385.214844,Close:34662.4375,"Adj Close":34662.4375,Volume:33123368116},{Date:"2021-06-25",Open:34659.105469,High:35487.246094,Low:31350.884766,Close:31637.779297,"Adj Close":31637.779297,Volume:40230904226},{Date:"2021-06-26",Open:31594.664063,High:32637.587891,Low:30184.501953,Close:32186.277344,"Adj Close":32186.277344,Volume:38585385521},{Date:"2021-06-27",Open:32287.523438,High:34656.128906,Low:32071.757813,Close:34649.644531,"Adj Close":34649.644531,Volume:35511640894},{Date:"2021-06-28",Open:34679.121094,High:35219.890625,Low:33902.074219,Close:34434.335938,"Adj Close":34434.335938,Volume:33892523752},{Date:"2021-06-29",Open:34475.558594,High:36542.109375,Low:34252.484375,Close:35867.777344,"Adj Close":35867.777344,Volume:37901460044},{Date:"2021-06-30",Open:35908.386719,High:36074.757813,Low:34086.152344,Close:35040.835938,"Adj Close":35040.835938,Volume:34059036099},{Date:"2021-07-01",Open:35035.984375,High:35035.984375,Low:32883.78125,Close:33572.117188,"Adj Close":33572.117188,Volume:37838957079},{Date:"2021-07-02",Open:33549.601563,High:33939.589844,Low:32770.679688,Close:33897.046875,"Adj Close":33897.046875,Volume:38728974942},{Date:"2021-07-03",Open:33854.421875,High:34909.261719,Low:33402.695313,Close:34668.546875,"Adj Close":34668.546875,Volume:24383958643},{Date:"2021-07-04",Open:34665.566406,High:35937.566406,Low:34396.476563,Close:35287.78125,"Adj Close":35287.78125,Volume:24924307911},{Date:"2021-07-05",Open:35284.34375,High:35284.34375,Low:33213.660156,Close:33746.003906,"Adj Close":33746.003906,Volume:26721554282},{Date:"2021-07-06",Open:33723.507813,High:35038.535156,Low:33599.917969,Close:34235.195313,"Adj Close":34235.195313,Volume:26501259870},{Date:"2021-07-07",Open:34225.679688,High:34997.664063,Low:33839.289063,Close:33855.328125,"Adj Close":33855.328125,Volume:24796027477},{Date:"2021-07-08",Open:33889.605469,High:33907.90625,Low:32133.183594,Close:32877.371094,"Adj Close":32877.371094,Volume:29910396946},{Date:"2021-07-09",Open:32861.671875,High:34042.292969,Low:32318.880859,Close:33798.011719,"Adj Close":33798.011719,Volume:27436021028},{Date:"2021-07-10",Open:33811.242188,High:34209.070313,Low:33116.011719,Close:33520.519531,"Adj Close":33520.519531,Volume:22971873468},{Date:"2021-07-11",Open:33509.078125,High:34584.703125,Low:33346.738281,Close:34240.1875,"Adj Close":34240.1875,Volume:20108729370},{Date:"2021-07-12",Open:34254.015625,High:34592.15625,Low:32697.308594,Close:33155.847656,"Adj Close":33155.847656,Volume:24321499537},{Date:"2021-07-13",Open:33125.46875,High:33327.101563,Low:32261.419922,Close:32702.025391,"Adj Close":32702.025391,Volume:19120856669},{Date:"2021-07-14",Open:32723.845703,High:33061.398438,Low:31639.125,Close:32822.347656,"Adj Close":32822.347656,Volume:21376531210},{Date:"2021-07-15",Open:32827.875,High:33159.640625,Low:31175.708984,Close:31780.730469,"Adj Close":31780.730469,Volume:21300524237},{Date:"2021-07-16",Open:31841.550781,High:32218.40625,Low:31100.673828,Close:31421.539063,"Adj Close":31421.539063,Volume:23699476918},{Date:"2021-07-17",Open:31397.308594,High:31935.945313,Low:31223.990234,Close:31533.068359,"Adj Close":31533.068359,Volume:18895018942},{Date:"2021-07-18",Open:31533.884766,High:32398.996094,Low:31215.492188,Close:31796.810547,"Adj Close":31796.810547,Volume:18787986667},{Date:"2021-07-19",Open:31800.011719,High:31885.859375,Low:30563.734375,Close:30817.832031,"Adj Close":30817.832031,Volume:20434789545},{Date:"2021-07-20",Open:30838.285156,High:31006.1875,Low:29360.955078,Close:29807.347656,"Adj Close":29807.347656,Volume:23148267245},{Date:"2021-07-21",Open:29796.285156,High:32752.326172,Low:29526.183594,Close:32110.693359,"Adj Close":32110.693359,Volume:28203024559},{Date:"2021-07-22",Open:32138.873047,High:32576.400391,Low:31745.298828,Close:32313.105469,"Adj Close":32313.105469,Volume:19555230518},{Date:"2021-07-23",Open:32305.958984,High:33581.550781,Low:32057.892578,Close:33581.550781,"Adj Close":33581.550781,Volume:22552046192},{Date:"2021-07-24",Open:33593.730469,High:34490.390625,Low:33424.859375,Close:34292.445313,"Adj Close":34292.445313,Volume:21664706865},{Date:"2021-07-25",Open:34290.292969,High:35364.925781,Low:33881.835938,Close:35350.1875,"Adj Close":35350.1875,Volume:20856685287},{Date:"2021-07-26",Open:35384.03125,High:40499.675781,Low:35287.3125,Close:37337.535156,"Adj Close":37337.535156,Volume:51022126212},{Date:"2021-07-27",Open:37276.035156,High:39406.941406,Low:36441.726563,Close:39406.941406,"Adj Close":39406.941406,Volume:35097370560},{Date:"2021-07-28",Open:39503.1875,High:40816.070313,Low:38862.4375,Close:39995.90625,"Adj Close":39995.90625,Volume:38702404695},{Date:"2021-07-29",Open:39995.453125,High:40593.070313,Low:39352.058594,Close:40008.421875,"Adj Close":40008.421875,Volume:27167146027},{Date:"2021-07-30",Open:40027.484375,High:42235.546875,Low:38397.355469,Close:42235.546875,"Adj Close":42235.546875,Volume:33072782960},{Date:"2021-07-31",Open:42196.304688,High:42231.449219,Low:41110.832031,Close:41626.195313,"Adj Close":41626.195313,Volume:25802845343},{Date:"2021-08-01",Open:41460.84375,High:42541.679688,Low:39540.941406,Close:39974.894531,"Adj Close":39974.894531,Volume:26688438115},{Date:"2021-08-02",Open:39907.261719,High:40419.179688,Low:38746.347656,Close:39201.945313,"Adj Close":39201.945313,Volume:25595265436},{Date:"2021-08-03",Open:39178.402344,High:39750.03125,Low:37782.050781,Close:38152.980469,"Adj Close":38152.980469,Volume:26189830450},{Date:"2021-08-04",Open:38213.332031,High:39952.296875,Low:37589.164063,Close:39747.503906,"Adj Close":39747.503906,Volume:25372562724},{Date:"2021-08-05",Open:39744.515625,High:41341.933594,Low:37458.003906,Close:40869.554688,"Adj Close":40869.554688,Volume:35185031017},{Date:"2021-08-06",Open:40865.867188,High:43271.660156,Low:39932.179688,Close:42816.5,"Adj Close":42816.5,Volume:38226483046},{Date:"2021-08-07",Open:42832.796875,High:44689.859375,Low:42618.566406,Close:44555.800781,"Adj Close":44555.800781,Volume:40030862141},{Date:"2021-08-08",Open:44574.4375,High:45282.351563,Low:43331.910156,Close:43798.117188,"Adj Close":43798.117188,Volume:36302664750},{Date:"2021-08-09",Open:43791.925781,High:46456.832031,Low:42848.6875,Close:46365.402344,"Adj Close":46365.402344,Volume:38734079049},{Date:"2021-08-10",Open:46280.847656,High:46637.988281,Low:44705.554688,Close:45585.03125,"Adj Close":45585.03125,Volume:33546019517},{Date:"2021-08-11",Open:45599.703125,High:46735.632813,Low:45351.710938,Close:45593.636719,"Adj Close":45593.636719,Volume:34319709073},{Date:"2021-08-12",Open:45576.878906,High:46228.910156,Low:43861.445313,Close:44428.289063,"Adj Close":44428.289063,Volume:33723620826},{Date:"2021-08-13",Open:44439.691406,High:47831.976563,Low:44282.417969,Close:47793.320313,"Adj Close":47793.320313,Volume:31744259539},{Date:"2021-08-14",Open:47810.6875,High:48098.683594,Low:46177.632813,Close:47096.945313,"Adj Close":47096.945313,Volume:31211354442},{Date:"2021-08-15",Open:47096.667969,High:47357.105469,Low:45579.589844,Close:47047.003906,"Adj Close":47047.003906,Volume:30988958446},{Date:"2021-08-16",Open:47019.960938,High:47998.097656,Low:45700.320313,Close:46004.484375,"Adj Close":46004.484375,Volume:32776876610},{Date:"2021-08-17",Open:45936.457031,High:47139.570313,Low:44512.417969,Close:44695.359375,"Adj Close":44695.359375,Volume:33451362600},{Date:"2021-08-18",Open:44686.75,High:45952.0625,Low:44364.027344,Close:44801.1875,"Adj Close":44801.1875,Volume:32194123075},{Date:"2021-08-19",Open:44741.882813,High:46970.761719,Low:43998.316406,Close:46717.578125,"Adj Close":46717.578125,Volume:37204312299},{Date:"2021-08-20",Open:46723.121094,High:49342.152344,Low:46650.707031,Close:49339.175781,"Adj Close":49339.175781,Volume:34706867452},{Date:"2021-08-21",Open:49327.074219,High:49717.019531,Low:48312.199219,Close:48905.492188,"Adj Close":48905.492188,Volume:40585205312},{Date:"2021-08-22",Open:48869.105469,High:49471.609375,Low:48199.941406,Close:49321.652344,"Adj Close":49321.652344,Volume:25370975378},{Date:"2021-08-23",Open:49291.675781,High:50482.078125,Low:49074.605469,Close:49546.148438,"Adj Close":49546.148438,Volume:34305053719},{Date:"2021-08-24",Open:49562.347656,High:49878.769531,Low:47687.117188,Close:47706.117188,"Adj Close":47706.117188,Volume:35361168834},{Date:"2021-08-25",Open:47727.257813,High:49202.878906,Low:47163.613281,Close:48960.789063,"Adj Close":48960.789063,Volume:32646349931},{Date:"2021-08-26",Open:49002.640625,High:49347.582031,Low:46405.78125,Close:46942.21875,"Adj Close":46942.21875,Volume:32666549568},{Date:"2021-08-27",Open:46894.554688,High:49112.785156,Low:46394.28125,Close:49058.667969,"Adj Close":49058.667969,Volume:34511076995},{Date:"2021-08-28",Open:49072.585938,High:49283.503906,Low:48499.238281,Close:48902.402344,"Adj Close":48902.402344,Volume:28568103401},{Date:"2021-08-29",Open:48911.25,High:49644.113281,Low:47925.855469,Close:48829.832031,"Adj Close":48829.832031,Volume:25889650240},{Date:"2021-08-30",Open:48834.851563,High:48925.605469,Low:46950.273438,Close:47054.984375,"Adj Close":47054.984375,Volume:31847007016},{Date:"2021-08-31",Open:47024.339844,High:48189.550781,Low:46750.09375,Close:47166.6875,"Adj Close":47166.6875,Volume:34730363427},{Date:"2021-09-01",Open:47099.773438,High:49111.089844,Low:46562.4375,Close:48847.027344,"Adj Close":48847.027344,Volume:39139399125},{Date:"2021-09-02",Open:48807.847656,High:50343.421875,Low:48652.320313,Close:49327.722656,"Adj Close":49327.722656,Volume:39508070319},{Date:"2021-09-03",Open:49288.25,High:50982.273438,Low:48386.085938,Close:50025.375,"Adj Close":50025.375,Volume:43206179619},{Date:"2021-09-04",Open:50009.324219,High:50545.582031,Low:49548.78125,Close:49944.625,"Adj Close":49944.625,Volume:37471327794},{Date:"2021-09-05",Open:49937.859375,High:51868.679688,Low:49538.597656,Close:51753.410156,"Adj Close":51753.410156,Volume:30322676319},{Date:"2021-09-06",Open:51769.003906,High:52700.941406,Low:51053.679688,Close:52633.535156,"Adj Close":52633.535156,Volume:38884105426},{Date:"2021-09-07",Open:52660.480469,High:52853.765625,Low:43285.207031,Close:46811.128906,"Adj Close":46811.128906,Volume:65210059683},{Date:"2021-09-08",Open:46827.761719,High:47334.054688,Low:44561.394531,Close:46091.390625,"Adj Close":46091.390625,Volume:49007762488},{Date:"2021-09-09",Open:45774.742188,High:47261.949219,Low:45669.738281,Close:46391.421875,"Adj Close":46391.421875,Volume:38672657013},{Date:"2021-09-10",Open:46396.664063,High:47031.742188,Low:44344.484375,Close:44883.910156,"Adj Close":44883.910156,Volume:39154666597},{Date:"2021-09-11",Open:44869.839844,High:45969.292969,Low:44818.265625,Close:45201.457031,"Adj Close":45201.457031,Volume:34499835245},{Date:"2021-09-12",Open:45206.628906,High:46364.878906,Low:44790.460938,Close:46063.269531,"Adj Close":46063.269531,Volume:27881980161},{Date:"2021-09-13",Open:46057.214844,High:46598.679688,Low:43591.320313,Close:44963.074219,"Adj Close":44963.074219,Volume:40969943253},{Date:"2021-09-14",Open:44960.050781,High:47218.125,Low:44752.332031,Close:47092.492188,"Adj Close":47092.492188,Volume:38652152880},{Date:"2021-09-15",Open:47098,High:48450.46875,Low:46773.328125,Close:48176.347656,"Adj Close":48176.347656,Volume:30484496466},{Date:"2021-09-16",Open:48158.90625,High:48486.828125,Low:47079.558594,Close:47783.359375,"Adj Close":47783.359375,Volume:31764293754},{Date:"2021-09-17",Open:47771.003906,High:48160.921875,Low:46832.523438,Close:47267.519531,"Adj Close":47267.519531,Volume:28727713711},{Date:"2021-09-18",Open:47273.527344,High:48791.78125,Low:47087.285156,Close:48278.363281,"Adj Close":48278.363281,Volume:28575630451},{Date:"2021-09-19",Open:48268.855469,High:48328.367188,Low:46919.804688,Close:47260.21875,"Adj Close":47260.21875,Volume:26967722648},{Date:"2021-09-20",Open:47261.40625,High:47328.199219,Low:42598.914063,Close:42843.800781,"Adj Close":42843.800781,Volume:43909845642},{Date:"2021-09-21",Open:43012.234375,High:43607.609375,Low:39787.609375,Close:40693.675781,"Adj Close":40693.675781,Volume:48701090088},{Date:"2021-09-22",Open:40677.953125,High:43978.621094,Low:40625.632813,Close:43574.507813,"Adj Close":43574.507813,Volume:38139709246},{Date:"2021-09-23",Open:43560.296875,High:44942.175781,Low:43109.339844,Close:44895.097656,"Adj Close":44895.097656,Volume:34244064430},{Date:"2021-09-24",Open:44894.300781,High:45080.492188,Low:40936.558594,Close:42839.75,"Adj Close":42839.75,Volume:42839345714},{Date:"2021-09-25",Open:42840.890625,High:42996.257813,Low:41759.921875,Close:42716.59375,"Adj Close":42716.59375,Volume:31604717236},{Date:"2021-09-26",Open:42721.628906,High:43919.300781,Low:40848.460938,Close:43208.539063,"Adj Close":43208.539063,Volume:30661222077},{Date:"2021-09-27",Open:43234.183594,High:44313.246094,Low:42190.632813,Close:42235.730469,"Adj Close":42235.730469,Volume:30980029059},{Date:"2021-09-28",Open:42200.898438,High:42775.144531,Low:40931.664063,Close:41034.542969,"Adj Close":41034.542969,Volume:30214940550},{Date:"2021-09-29",Open:41064.984375,High:42545.257813,Low:40829.667969,Close:41564.363281,"Adj Close":41564.363281,Volume:30602359905},{Date:"2021-09-30",Open:41551.269531,High:44092.601563,Low:41444.582031,Close:43790.894531,"Adj Close":43790.894531,Volume:31141681925},{Date:"2021-10-01",Open:43816.742188,High:48436.011719,Low:43320.023438,Close:48116.941406,"Adj Close":48116.941406,Volume:42850641582},{Date:"2021-10-02",Open:48137.46875,High:48282.0625,Low:47465.496094,Close:47711.488281,"Adj Close":47711.488281,Volume:30614346492},{Date:"2021-10-03",Open:47680.027344,High:49130.691406,Low:47157.289063,Close:48199.953125,"Adj Close":48199.953125,Volume:26638115879},{Date:"2021-10-04",Open:48208.90625,High:49456.777344,Low:47045.003906,Close:49112.902344,"Adj Close":49112.902344,Volume:33383173002},{Date:"2021-10-05",Open:49174.960938,High:51839.984375,Low:49072.839844,Close:51514.8125,"Adj Close":51514.8125,Volume:35873904236},{Date:"2021-10-06",Open:51486.664063,High:55568.464844,Low:50488.191406,Close:55361.449219,"Adj Close":55361.449219,Volume:49034730168},{Date:"2021-10-07",Open:55338.625,High:55338.625,Low:53525.46875,Close:53805.984375,"Adj Close":53805.984375,Volume:36807860413},{Date:"2021-10-08",Open:53802.144531,High:55922.980469,Low:53688.054688,Close:53967.847656,"Adj Close":53967.847656,Volume:34800873924},{Date:"2021-10-09",Open:53929.78125,High:55397.945313,Low:53735.144531,Close:54968.222656,"Adj Close":54968.222656,Volume:32491211414},{Date:"2021-10-10",Open:54952.820313,High:56401.304688,Low:54264.257813,Close:54771.578125,"Adj Close":54771.578125,Volume:39527792364},{Date:"2021-10-11",Open:54734.125,High:57793.039063,Low:54519.765625,Close:57484.789063,"Adj Close":57484.789063,Volume:42637331698},{Date:"2021-10-12",Open:57526.832031,High:57627.878906,Low:54477.972656,Close:56041.058594,"Adj Close":56041.058594,Volume:41083758949},{Date:"2021-10-13",Open:56038.257813,High:57688.660156,Low:54370.972656,Close:57401.097656,"Adj Close":57401.097656,Volume:41684252783},{Date:"2021-10-14",Open:57372.832031,High:58478.734375,Low:56957.074219,Close:57321.523438,"Adj Close":57321.523438,Volume:36615791366},{Date:"2021-10-15",Open:57345.902344,High:62757.128906,Low:56868.144531,Close:61593.949219,"Adj Close":61593.949219,Volume:51780081801},{Date:"2021-10-16",Open:61609.527344,High:62274.476563,Low:60206.121094,Close:60892.179688,"Adj Close":60892.179688,Volume:34250964237},{Date:"2021-10-17",Open:60887.652344,High:61645.523438,Low:59164.46875,Close:61553.617188,"Adj Close":61553.617188,Volume:29032367511},{Date:"2021-10-18",Open:61548.804688,High:62614.660156,Low:60012.757813,Close:62026.078125,"Adj Close":62026.078125,Volume:38055562075},{Date:"2021-10-19",Open:62043.164063,High:64434.535156,Low:61622.933594,Close:64261.992188,"Adj Close":64261.992188,Volume:40471196346},{Date:"2021-10-20",Open:64284.585938,High:66930.390625,Low:63610.675781,Close:65992.835938,"Adj Close":65992.835938,Volume:40788955582},{Date:"2021-10-21",Open:66002.234375,High:66600.546875,Low:62117.410156,Close:62210.171875,"Adj Close":62210.171875,Volume:45908121370},{Date:"2021-10-22",Open:62237.890625,High:63715.023438,Low:60122.796875,Close:60692.265625,"Adj Close":60692.265625,Volume:38434082775},{Date:"2021-10-23",Open:60694.628906,High:61743.878906,Low:59826.523438,Close:61393.617188,"Adj Close":61393.617188,Volume:26882546034},{Date:"2021-10-24",Open:61368.34375,High:61505.804688,Low:59643.34375,Close:60930.835938,"Adj Close":60930.835938,Volume:27316183882},{Date:"2021-10-25",Open:60893.925781,High:63729.324219,Low:60691.800781,Close:63039.824219,"Adj Close":63039.824219,Volume:31064911614},{Date:"2021-10-26",Open:63032.761719,High:63229.027344,Low:59991.160156,Close:60363.792969,"Adj Close":60363.792969,Volume:34878965587},{Date:"2021-10-27",Open:60352,High:61435.183594,Low:58208.1875,Close:58482.386719,"Adj Close":58482.386719,Volume:43657076893},{Date:"2021-10-28",Open:58470.730469,High:62128.632813,Low:58206.917969,Close:60622.136719,"Adj Close":60622.136719,Volume:45257083247},{Date:"2021-10-29",Open:60624.871094,High:62927.609375,Low:60329.964844,Close:62227.964844,"Adj Close":62227.964844,Volume:36856881767},{Date:"2021-10-30",Open:62239.363281,High:62330.144531,Low:60918.386719,Close:61888.832031,"Adj Close":61888.832031,Volume:32157938616},{Date:"2021-10-31",Open:61850.488281,High:62406.171875,Low:60074.328125,Close:61318.957031,"Adj Close":61318.957031,Volume:32241199927},{Date:"2021-11-01",Open:61320.449219,High:62419.003906,Low:59695.183594,Close:61004.40625,"Adj Close":61004.40625,Volume:36150572843},{Date:"2021-11-02",Open:60963.253906,High:64242.792969,Low:60673.054688,Close:63226.402344,"Adj Close":63226.402344,Volume:37746665647},{Date:"2021-11-03",Open:63254.335938,High:63516.9375,Low:61184.238281,Close:62970.046875,"Adj Close":62970.046875,Volume:36124731509},{Date:"2021-11-04",Open:62941.804688,High:63123.289063,Low:60799.664063,Close:61452.230469,"Adj Close":61452.230469,Volume:32615846901},{Date:"2021-11-05",Open:61460.078125,High:62541.46875,Low:60844.609375,Close:61125.675781,"Adj Close":61125.675781,Volume:30605102446},{Date:"2021-11-06",Open:61068.875,High:61590.683594,Low:60163.78125,Close:61527.480469,"Adj Close":61527.480469,Volume:29094934221},{Date:"2021-11-07",Open:61554.921875,High:63326.988281,Low:61432.488281,Close:63326.988281,"Adj Close":63326.988281,Volume:24726754302},{Date:"2021-11-08",Open:63344.066406,High:67673.742188,Low:63344.066406,Close:67566.828125,"Adj Close":67566.828125,Volume:41125608330},{Date:"2021-11-09",Open:67549.734375,High:68530.335938,Low:66382.0625,Close:66971.828125,"Adj Close":66971.828125,Volume:42357991721},{Date:"2021-11-10",Open:66953.335938,High:68789.625,Low:63208.113281,Close:64995.230469,"Adj Close":64995.230469,Volume:48730828378},{Date:"2021-11-11",Open:64978.890625,High:65579.015625,Low:64180.488281,Close:64949.960938,"Adj Close":64949.960938,Volume:35880633236},{Date:"2021-11-12",Open:64863.980469,High:65460.816406,Low:62333.914063,Close:64155.941406,"Adj Close":64155.941406,Volume:36084893887},{Date:"2021-11-13",Open:64158.121094,High:64915.675781,Low:63303.734375,Close:64469.527344,"Adj Close":64469.527344,Volume:30474228777},{Date:"2021-11-14",Open:64455.371094,High:65495.179688,Low:63647.808594,Close:65466.839844,"Adj Close":65466.839844,Volume:25122092191},{Date:"2021-11-15",Open:65521.289063,High:66281.570313,Low:63548.144531,Close:63557.871094,"Adj Close":63557.871094,Volume:30558763548},{Date:"2021-11-16",Open:63721.195313,High:63721.195313,Low:59016.335938,Close:60161.246094,"Adj Close":60161.246094,Volume:46844335592},{Date:"2021-11-17",Open:60139.621094,High:60823.609375,Low:58515.410156,Close:60368.011719,"Adj Close":60368.011719,Volume:39178392930},{Date:"2021-11-18",Open:60360.136719,High:60948.5,Low:56550.792969,Close:56942.136719,"Adj Close":56942.136719,Volume:41388338699},{Date:"2021-11-19",Open:56896.128906,High:58351.113281,Low:55705.179688,Close:58119.578125,"Adj Close":58119.578125,Volume:38702407772},{Date:"2021-11-20",Open:58115.082031,High:59859.878906,Low:57469.726563,Close:59697.195313,"Adj Close":59697.195313,Volume:30624264863},{Date:"2021-11-21",Open:59730.507813,High:60004.425781,Low:58618.929688,Close:58730.476563,"Adj Close":58730.476563,Volume:26123447605},{Date:"2021-11-22",Open:58706.847656,High:59266.359375,Low:55679.839844,Close:56289.289063,"Adj Close":56289.289063,Volume:35036121783},{Date:"2021-11-23",Open:56304.554688,High:57875.515625,Low:55632.761719,Close:57569.074219,"Adj Close":57569.074219,Volume:37485803899},{Date:"2021-11-24",Open:57565.851563,High:57803.066406,Low:55964.222656,Close:56280.425781,"Adj Close":56280.425781,Volume:36635566789},{Date:"2021-11-25",Open:57165.417969,High:59367.96875,Low:57146.683594,Close:57274.679688,"Adj Close":57274.679688,Volume:34284016248},{Date:"2021-11-26",Open:58960.285156,High:59183.480469,Low:53569.765625,Close:53569.765625,"Adj Close":53569.765625,Volume:41810748221},{Date:"2021-11-27",Open:53736.429688,High:55329.257813,Low:53668.355469,Close:54815.078125,"Adj Close":54815.078125,Volume:30560857714},{Date:"2021-11-28",Open:54813.023438,High:57393.84375,Low:53576.734375,Close:57248.457031,"Adj Close":57248.457031,Volume:28116886357},{Date:"2021-11-29",Open:57291.90625,High:58872.878906,Low:56792.527344,Close:57806.566406,"Adj Close":57806.566406,Volume:32370840356},{Date:"2021-11-30",Open:57830.113281,High:59113.402344,Low:56057.28125,Close:57005.425781,"Adj Close":57005.425781,Volume:36708594618},{Date:"2021-12-01",Open:56907.964844,High:59041.683594,Low:56553.082031,Close:57229.828125,"Adj Close":57229.828125,Volume:36858195307},{Date:"2021-12-02",Open:57217.371094,High:57349.234375,Low:55895.132813,Close:56477.816406,"Adj Close":56477.816406,Volume:32379968686},{Date:"2021-12-03",Open:56509.164063,High:57482.167969,Low:52496.585938,Close:53598.246094,"Adj Close":53598.246094,Volume:39789134215},{Date:"2021-12-04",Open:53727.878906,High:53904.679688,Low:42874.617188,Close:49200.703125,"Adj Close":49200.703125,Volume:61385677469},{Date:"2021-12-05",Open:49201.519531,High:49768.148438,Low:47857.496094,Close:49368.847656,"Adj Close":49368.847656,Volume:37198201161},{Date:"2021-12-06",Open:49413.480469,High:50929.519531,Low:47281.035156,Close:50582.625,"Adj Close":50582.625,Volume:37707308001},{Date:"2021-12-07",Open:50581.828125,High:51934.78125,Low:50175.808594,Close:50700.085938,"Adj Close":50700.085938,Volume:33676814852},{Date:"2021-12-08",Open:50667.648438,High:51171.375,Low:48765.988281,Close:50504.796875,"Adj Close":50504.796875,Volume:28479699446},{Date:"2021-12-09",Open:50450.082031,High:50797.164063,Low:47358.351563,Close:47672.121094,"Adj Close":47672.121094,Volume:29603577251},{Date:"2021-12-10",Open:47642.144531,High:50015.253906,Low:47023.699219,Close:47243.304688,"Adj Close":47243.304688,Volume:30966005122},{Date:"2021-12-11",Open:47264.632813,High:49458.210938,Low:46942.347656,Close:49362.507813,"Adj Close":49362.507813,Volume:25775869261},{Date:"2021-12-12",Open:49354.855469,High:50724.867188,Low:48725.851563,Close:50098.335938,"Adj Close":50098.335938,Volume:21939223599},{Date:"2021-12-13",Open:50114.742188,High:50205,Low:45894.847656,Close:46737.480469,"Adj Close":46737.480469,Volume:32166727776},{Date:"2021-12-14",Open:46709.824219,High:48431.398438,Low:46424.496094,Close:46612.632813,"Adj Close":46612.632813,Volume:34638619079},{Date:"2021-12-15",Open:48379.753906,High:49473.957031,Low:46671.964844,Close:48896.722656,"Adj Close":48896.722656,Volume:36541828520},{Date:"2021-12-16",Open:48900.464844,High:49425.574219,Low:47529.878906,Close:47665.425781,"Adj Close":47665.425781,Volume:27268150947},{Date:"2021-12-17",Open:47653.730469,High:48004.894531,Low:45618.214844,Close:46202.144531,"Adj Close":46202.144531,Volume:32902725329},{Date:"2021-12-18",Open:46219.253906,High:47313.828125,Low:45598.441406,Close:46848.777344,"Adj Close":46848.777344,Volume:26098292690},{Date:"2021-12-19",Open:46853.867188,High:48089.664063,Low:46502.953125,Close:46707.015625,"Adj Close":46707.015625,Volume:25154053861},{Date:"2021-12-20",Open:46707.0625,High:47401.71875,Low:45579.808594,Close:46880.277344,"Adj Close":46880.277344,Volume:30961902129},{Date:"2021-12-21",Open:46886.078125,High:49300.917969,Low:46698.773438,Close:48936.613281,"Adj Close":48936.613281,Volume:27055803928},{Date:"2021-12-22",Open:48937.097656,High:49544.796875,Low:48450.941406,Close:48628.511719,"Adj Close":48628.511719,Volume:24447979559},{Date:"2021-12-23",Open:48626.34375,High:51332.339844,Low:48065.835938,Close:50784.539063,"Adj Close":50784.539063,Volume:28223878108},{Date:"2021-12-24",Open:50806.050781,High:51814.027344,Low:50514.496094,Close:50822.195313,"Adj Close":50822.195313,Volume:24367912228},{Date:"2021-12-25",Open:50854.917969,High:51176.597656,Low:50236.707031,Close:50429.859375,"Adj Close":50429.859375,Volume:19030650914},{Date:"2021-12-26",Open:50428.691406,High:51196.378906,Low:49623.105469,Close:50809.515625,"Adj Close":50809.515625,Volume:20964372926},{Date:"2021-12-27",Open:50802.609375,High:51956.328125,Low:50499.46875,Close:50640.417969,"Adj Close":50640.417969,Volume:24324345758},{Date:"2021-12-28",Open:50679.859375,High:50679.859375,Low:47414.210938,Close:47588.855469,"Adj Close":47588.855469,Volume:33430376883},{Date:"2021-12-29",Open:47623.871094,High:48119.742188,Low:46201.496094,Close:46444.710938,"Adj Close":46444.710938,Volume:30049226299},{Date:"2021-12-30",Open:46490.605469,High:47879.964844,Low:46060.3125,Close:47178.125,"Adj Close":47178.125,Volume:26686491018},{Date:"2021-12-31",Open:47169.371094,High:48472.527344,Low:45819.953125,Close:46306.445313,"Adj Close":46306.445313,Volume:36974172400},{Date:"2022-01-01",Open:46311.746094,High:47827.3125,Low:46288.484375,Close:47686.8125,"Adj Close":47686.8125,Volume:24582667004}];function detectCurrencySymbols(n){if(n==null||n==="")return["",""];const t=n.split("-");if(t.length<2)return["",""];const i=t[0],s=t[1].split(".")[0];return[i,s]}function parseYahooCsv(n,t=!0,i=","){let s=n.split(`
`).filter(Oe=>Oe.trimEnd()!==""),Le=[];t&&s.shift();for(const[Oe,Ae]of s.entries()){const Ee=Ae.split(i);if(Ee.length!==7)return[null,Error(`ParseError [line ${Oe+1}] Wrong column numbers in row: ${Ae}`)];const $e={time:Ee[0],open:Number.parseFloat(Ee[1]),high:Number.parseFloat(Ee[2]),low:Number.parseFloat(Ee[3]),close:Number.parseFloat(Ee[4]),volume:Number.parseFloat(Ee[6])};Le.push($e)}return[Le,null]}function importFromJson(n){return n.map(i=>({time:i.Date,open:i.Open,high:i.High,low:i.Low,close:i.Close,volume:i.Volume}))}function importBtcUsdJson(){return importFromJson(btcUsdData)}const[strategyCode,setStrategyCode]=createStore({value:DEFAULT_STRATEGY}),[backtestingOptions,setBacktestingOptions]=createStore({initialBalance:1e4,commissionPercentage:.005}),[marketDatas,setMarketDatas]=createSignal([{label:"BTC-USD-2021-2022.json",baseSymbol:"BTC",quoteSymbol:"USD",value:importBtcUsdJson(),disabled:!1}]),addMarketData=n=>{setMarketDatas(t=>[...t,n])},[selectedMarketData,setSelectedMarketData]=createSignal(marketDatas()[0]);function fixedWithoutTrailingZeroes(n,t=16){return Number.parseFloat(n?.toFixed(t)||"")}var _tmpl$$a=template('<div><div id=chart class="mr-4 mb-4"><i class=text-gray-500>Chart library created by <a class="font-bold text-sky-600 hover:underline"href=https://www.tradingview.com/>TradingView</a></i></div><div class=flex><article class="flex mr-2 flex-1 items-center justify-between rounded-lg border border-gray-100 bg-white p-6"><div><p class="ml-1 text-sm text-gray-500">Initial balance</p><p class="text-2xl font-medium text-gray-900"> </p></div></article><article class="flex ml-2 flex-1 items-center justify-between rounded-lg border border-gray-100 bg-white p-6"><div class=justify-start><p class="ml-1 text-sm text-gray-500">Equity</p><p class="text-2xl font-medium text-gray-900"> </p></div></article></div><div class="overflow-y-auto h-svh rounded-lg border border-gray-200">');function Arrow(n){const t=()=>n.backtestingReport,i=s=>(100*((s.equity-s.initialBalance)/s.initialBalance)).toFixed(2);return[createComponent(Show,{get when(){return t()?.equity>t()?.initialBalance},get children(){return createComponent(BadgeDelta,{deltaType:"increase",get children(){return["+ ",createMemo(()=>i(t())),"%"]}})}}),createComponent(Show,{get when(){return t()?.equity<t()?.initialBalance},get children(){return createComponent(BadgeDelta,{deltaType:"decrease",get children(){return["- ",createMemo(()=>i(t())),"%"]}})}})]}function BacktestingReportComponent(n){const t=()=>n.backtestingReport,i=()=>n.markers||[];let s,Le,Oe,Ae=null;return onMount(()=>{Le=Ve(s,{height:400,rightPriceScale:{visible:!0},leftPriceScale:{visible:!0},layout:{textColor:"#DDD",background:{color:"#222"}},grid:{vertLines:{color:"#444"},horzLines:{color:"#444"}}}),t()?.equityTimeseries&&(Ae=Le.addLineSeries({title:"Equity",priceScaleId:"left",color:"#2962FF",lineWidth:2}),Ae.setData(t().equityTimeseries)),Oe=Le.addCandlestickSeries({title:"Price",priceScaleId:"right"}),Oe.setData(selectedMarketData().value),Oe.setMarkers(i()),Le.timeScale().fitContent()}),(()=>{var Ee=_tmpl$$a(),$e=Ee.firstChild,Ie=$e.nextSibling,Fe=Ie.firstChild,He=Fe.firstChild,ze=He.firstChild,je=ze.nextSibling,Ne=je.firstChild,Ke=Fe.nextSibling,Be=Ke.firstChild,Ue=Be.firstChild,We=Ue.nextSibling,Ge=We.firstChild,qe=Ie.nextSibling;return use(Xe=>{s=Xe},$e),insert(je,()=>fixedWithoutTrailingZeroes(t()?.initialBalance),Ne),insert(je,()=>t()?.quoteSymbol,null),insert(We,()=>fixedWithoutTrailingZeroes(t()?.equity),Ge),insert(We,()=>t()?.quoteSymbol,null),insert(Ke,createComponent(Arrow,{get backtestingReport(){return t()}}),null),insert(qe,createComponent(Table,{get children(){return[createComponent(TableCaption,{}),createComponent(TableHeader,{get children(){return createComponent(TableRow,{get children(){return[createComponent(TableHead,{children:"#"}),createComponent(TableHead,{children:"Type"}),createComponent(TableHead,{children:"Start date"}),createComponent(TableHead,{children:"End date"}),createComponent(TableHead,{children:"Start price"}),createComponent(TableHead,{children:"End price"}),createComponent(TableHead,{get children(){return["Quantity [",createMemo(()=>t()?.baseSymbol),"]"]}}),createComponent(TableHead,{get children(){return["Profit [",createMemo(()=>t()?.quoteSymbol),"]"]}})]}})}}),createComponent(TableBody,{get children(){return createComponent(For,{get each(){return t()?.closedPositions},children:(Xe,Je)=>createComponent(TableRow,{onmouseover:Ze=>{Le.setCrosshairPosition(Xe.startPrice,Xe.startDate,Oe)},get children(){return[createComponent(TableCell,{get children(){return Xe.id}}),createComponent(TableCell,{get children(){return PositionType[Xe.type]}}),createComponent(TableCell,{get children(){return Xe.startDate}}),createComponent(TableCell,{get children(){return Xe.endDate}}),createComponent(TableCell,{get children(){return fixedWithoutTrailingZeroes(Xe.startPrice)}}),createComponent(TableCell,{get children(){return fixedWithoutTrailingZeroes(Xe.endPrice)}}),createComponent(TableCell,{get children(){return fixedWithoutTrailingZeroes(Xe.quantity)}}),createComponent(TableCell,{get class(){return closePositionProfitWithoutCommission(Xe)>0?"text-green-500":"text-red-500"},get children(){return fixedWithoutTrailingZeroes(closePositionProfitWithoutCommission(Xe))}})]}})})}})]}})),Ee})()}const buttonVariants=cva("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"size-10"}},defaultVariants:{variant:"default",size:"default"}}),Button=n=>{const[t,i]=splitProps(n,["variant","size","class"]);return createComponent(ButtonRoot,mergeProps({get class(){return cn$1(buttonVariants({variant:t.variant,size:t.size}),t.class)}},i))};var _tmpl$$9=template('<div role=status class="flex items-center w-full h-full justify-center bg-gray-300 rounded-lg animate-pulse dark:bg-gray-700"><svg class="w-10 h-10 text-gray-200 dark:text-gray-600"aria-hidden=true xmlns=http://www.w3.org/2000/svg fill=currentColor viewBox="0 0 16 20"><path d="M5 5V.13a2.96 2.96 0 0 0-1.293.749L.879 3.707A2.98 2.98 0 0 0 .13 5H5Z"></path><path d="M14.066 0H7v5a2 2 0 0 1-2 2H0v11a1.97 1.97 0 0 0 1.934 2h12.132A1.97 1.97 0 0 0 16 18V2a1.97 1.97 0 0 0-1.934-2ZM9 13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-2a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2Zm4 .382a1 1 0 0 1-1.447.894L10 13v-2l1.553-1.276a1 1 0 0 1 1.447.894v2.764Z"></path></svg><span class=sr-only>Loading...'),_tmpl$2$5=template("<div><div id=editor>");function Editor(){let n=null;const[t,i]=createSignal(!0),[s,Le]=createSignal(!1);return onMount(async()=>{const Oe=await __vitePreload(()=>import("./index-C3oh37l8.js").then(Ae=>Ae.i),[]);await __vitePreload(()=>import("./javascript-BA_B0F2T.js").then(Ae=>Ae.j),[]),await __vitePreload(()=>import("./monokai-F4Kfik9Y.js"),[]),n=Oe.edit("editor"),n.getSession().setMode("ace/mode/javascript"),n.setTheme("ace/theme/monokai"),await __vitePreload(()=>import("./language_tools-DDZ8fhKd.js"),[]),n.setOption("enableBasicAutocompletion",!0),n.setOption("enableLiveAutocompletion",!0),n.setFontSize(18),n.setValue(strategyCode.value),n.on("beforeEndOperation",function(Ae){n.curOp.docChanged&&setStrategyCode({value:n.getValue()})}),n.resize(),i(!1)}),[createComponent(Show,{get when(){return t()},get children(){return _tmpl$$9()}}),(()=>{var Oe=_tmpl$2$5();return createRenderEffect(()=>className(Oe,s()?"editor-container-fullscreen":"editor-container")),Oe})(),createComponent(Button,{class:"absolute bottom-8 right-8 bg-gray-100 z-10",variant:"outline",onClick:()=>Le(Oe=>(n.resize(),!Oe)),children:"Fullscreen"})]}var LIVEREGION_TIMEOUT_DELAY=7e3,liveAnnouncer=null,DATA_LIVE_ANNOUNCER_ATTR="data-live-announcer";function announce(n,t="assertive",i=LIVEREGION_TIMEOUT_DELAY){liveAnnouncer||(liveAnnouncer=new LiveAnnouncer),liveAnnouncer.announce(n,t,i)}function clearAnnouncer(n){liveAnnouncer&&liveAnnouncer.clear(n)}var LiveAnnouncer=class{node;assertiveLog;politeLog;constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,visuallyHiddenStyles),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}createLog(n){const t=document.createElement("div");return t.setAttribute("role","log"),t.setAttribute("aria-live",n),t.setAttribute("aria-relevant","additions"),t}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(n,t="assertive",i=LIVEREGION_TIMEOUT_DELAY){if(!this.node)return;const s=document.createElement("div");s.textContent=n,t==="assertive"?this.assertiveLog.appendChild(s):this.politeLog.appendChild(s),n!==""&&setTimeout(()=>{s.remove()},i)}clear(n){this.node&&((!n||n==="assertive")&&(this.assertiveLog.innerHTML=""),(!n||n==="polite")&&(this.politeLog.innerHTML=""))}},SPIN_BUTTON_INTL_TRANSLATIONS={empty:"Empty"};function SpinButtonRoot(n){const t=mergeDefaultProps({translations:SPIN_BUTTON_INTL_TRANSLATIONS},n),[i,s]=splitProps(t,["translations","value","textValue","minValue","maxValue","validationState","onIncrement","onIncrementPage","onDecrement","onDecrementPage","onDecrementToMin","onIncrementToMax","onKeyDown","onFocus","onBlur"]);let Le=!1;const Oe=createMemo(()=>i.textValue===""?i.translations?.empty:(i.textValue||`${i.value}`).replace("-","−")),Ae=Ie=>{if(callHandler(Ie,i.onKeyDown),!(Ie.ctrlKey||Ie.metaKey||Ie.shiftKey||Ie.altKey||n.readOnly))switch(Ie.key){case"PageUp":if(i.onIncrementPage){Ie.preventDefault(),i.onIncrementPage();break}case"ArrowUp":case"Up":i.onIncrement&&(Ie.preventDefault(),i.onIncrement());break;case"PageDown":if(i.onDecrementPage){Ie.preventDefault(),i.onDecrementPage();break}case"ArrowDown":case"Down":i.onDecrement&&(Ie.preventDefault(),i.onDecrement());break;case"Home":i.onDecrementToMin&&(Ie.preventDefault(),i.onDecrementToMin());break;case"End":i.onIncrementToMax&&(Ie.preventDefault(),i.onIncrementToMax());break}},Ee=Ie=>{callHandler(Ie,i.onFocus),Le=!0},$e=Ie=>{callHandler(Ie,i.onBlur),Le=!1};return createEffect(on$1(Oe,Ie=>{Le&&(clearAnnouncer("assertive"),announce(Ie??"","assertive"))})),createComponent(Polymorphic,mergeProps({as:"div",role:"spinbutton",get"aria-valuenow"(){return i.value!=null&&!Number.isNaN(i.value)?i.value:void 0},get"aria-valuetext"(){return Oe()},get"aria-valuemin"(){return i.minValue},get"aria-valuemax"(){return i.maxValue},get"aria-required"(){return n.required||void 0},get"aria-disabled"(){return n.disabled||void 0},get"aria-readonly"(){return n.readOnly||void 0},get"aria-invalid"(){return i.validationState==="invalid"||void 0},onKeyDown:Ae,onFocus:Ee,onBlur:$e},s))}let $488c6ddbf4ef74c2$var$formatterCache=new Map,$488c6ddbf4ef74c2$var$supportsSignDisplay=!1;try{$488c6ddbf4ef74c2$var$supportsSignDisplay=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let $488c6ddbf4ef74c2$var$supportsUnit=!1;try{$488c6ddbf4ef74c2$var$supportsUnit=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const $488c6ddbf4ef74c2$var$UNITS={degree:{narrow:{default:"°","ja-JP":" 度","zh-TW":"度","sl-SI":" °"}}};class $488c6ddbf4ef74c2$export$cc77c4ff7e8673c5{format(t){let i="";if(!$488c6ddbf4ef74c2$var$supportsSignDisplay&&this.options.signDisplay!=null?i=$488c6ddbf4ef74c2$export$711b50b3c525e0f2(this.numberFormatter,this.options.signDisplay,t):i=this.numberFormatter.format(t),this.options.style==="unit"&&!$488c6ddbf4ef74c2$var$supportsUnit){var s;let{unit:Le,unitDisplay:Oe="short",locale:Ae}=this.resolvedOptions();if(!Le)return i;let Ee=(s=$488c6ddbf4ef74c2$var$UNITS[Le])===null||s===void 0?void 0:s[Oe];i+=Ee[Ae]||Ee.default}return i}formatToParts(t){return this.numberFormatter.formatToParts(t)}formatRange(t,i){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(t,i);if(i<t)throw new RangeError("End date must be >= start date");return`${this.format(t)} – ${this.format(i)}`}formatRangeToParts(t,i){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(t,i);if(i<t)throw new RangeError("End date must be >= start date");let s=this.numberFormatter.formatToParts(t),Le=this.numberFormatter.formatToParts(i);return[...s.map(Oe=>({...Oe,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...Le.map(Oe=>({...Oe,source:"endRange"}))]}resolvedOptions(){let t=this.numberFormatter.resolvedOptions();return!$488c6ddbf4ef74c2$var$supportsSignDisplay&&this.options.signDisplay!=null&&(t={...t,signDisplay:this.options.signDisplay}),!$488c6ddbf4ef74c2$var$supportsUnit&&this.options.style==="unit"&&(t={...t,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),t}constructor(t,i={}){this.numberFormatter=$488c6ddbf4ef74c2$var$getCachedNumberFormatter(t,i),this.options=i}}function $488c6ddbf4ef74c2$var$getCachedNumberFormatter(n,t={}){let{numberingSystem:i}=t;if(i&&n.includes("-nu-")&&(n.includes("-u-")||(n+="-u-"),n+=`-nu-${i}`),t.style==="unit"&&!$488c6ddbf4ef74c2$var$supportsUnit){var s;let{unit:Ae,unitDisplay:Ee="short"}=t;if(!Ae)throw new Error('unit option must be provided with style: "unit"');if(!(!((s=$488c6ddbf4ef74c2$var$UNITS[Ae])===null||s===void 0)&&s[Ee]))throw new Error(`Unsupported unit ${Ae} with unitDisplay = ${Ee}`);t={...t,style:"decimal"}}let Le=n+(t?Object.entries(t).sort((Ae,Ee)=>Ae[0]<Ee[0]?-1:1).join():"");if($488c6ddbf4ef74c2$var$formatterCache.has(Le))return $488c6ddbf4ef74c2$var$formatterCache.get(Le);let Oe=new Intl.NumberFormat(n,t);return $488c6ddbf4ef74c2$var$formatterCache.set(Le,Oe),Oe}function $488c6ddbf4ef74c2$export$711b50b3c525e0f2(n,t,i){if(t==="auto")return n.format(i);if(t==="never")return n.format(Math.abs(i));{let s=!1;if(t==="always"?s=i>0||Object.is(i,0):t==="exceptZero"&&(Object.is(i,-0)||Object.is(i,0)?i=Math.abs(i):s=i>0),s){let Le=n.format(-i),Oe=n.format(i),Ae=Le.replace(Oe,"").replace(/\u200e|\u061C/,"");return[...Ae].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),Le.replace(Oe,"!!!").replace(Ae,"+").replace("!!!",Oe)}else return n.format(i)}}const $6c7bd7858deea686$var$CURRENCY_SIGN_REGEX=new RegExp("^.*\\(.*\\).*$"),$6c7bd7858deea686$var$NUMBERING_SYSTEMS=["latn","arab","hanidec"];class $6c7bd7858deea686$export$cd11ab140839f11d{parse(t){return $6c7bd7858deea686$var$getNumberParserImpl(this.locale,this.options,t).parse(t)}isValidPartialNumber(t,i,s){return $6c7bd7858deea686$var$getNumberParserImpl(this.locale,this.options,t).isValidPartialNumber(t,i,s)}getNumberingSystem(t){return $6c7bd7858deea686$var$getNumberParserImpl(this.locale,this.options,t).options.numberingSystem}constructor(t,i={}){this.locale=t,this.options=i}}const $6c7bd7858deea686$var$numberParserCache=new Map;function $6c7bd7858deea686$var$getNumberParserImpl(n,t,i){let s=$6c7bd7858deea686$var$getCachedNumberParser(n,t);if(!n.includes("-nu-")&&!s.isValidPartialNumber(i)){for(let Le of $6c7bd7858deea686$var$NUMBERING_SYSTEMS)if(Le!==s.options.numberingSystem){let Oe=$6c7bd7858deea686$var$getCachedNumberParser(n+(n.includes("-u-")?"-nu-":"-u-nu-")+Le,t);if(Oe.isValidPartialNumber(i))return Oe}}return s}function $6c7bd7858deea686$var$getCachedNumberParser(n,t){let i=n+(t?Object.entries(t).sort((Le,Oe)=>Le[0]<Oe[0]?-1:1).join():""),s=$6c7bd7858deea686$var$numberParserCache.get(i);return s||(s=new $6c7bd7858deea686$var$NumberParserImpl(n,t),$6c7bd7858deea686$var$numberParserCache.set(i,s)),s}class $6c7bd7858deea686$var$NumberParserImpl{parse(t){let i=this.sanitize(t);if(this.symbols.group&&(i=$6c7bd7858deea686$var$replaceAll(i,this.symbols.group,"")),this.symbols.decimal&&(i=i.replace(this.symbols.decimal,".")),this.symbols.minusSign&&(i=i.replace(this.symbols.minusSign,"-")),i=i.replace(this.symbols.numeral,this.symbols.index),this.options.style==="percent"){let Ae=i.indexOf("-");i=i.replace("-","");let Ee=i.indexOf(".");Ee===-1&&(Ee=i.length),i=i.replace(".",""),Ee-2===0?i=`0.${i}`:Ee-2===-1?i=`0.0${i}`:Ee-2===-2?i="0.00":i=`${i.slice(0,Ee-2)}.${i.slice(Ee-2)}`,Ae>-1&&(i=`-${i}`)}let s=i?+i:NaN;if(isNaN(s))return NaN;if(this.options.style==="percent"){var Le,Oe;let Ae={...this.options,style:"decimal",minimumFractionDigits:Math.min(((Le=this.options.minimumFractionDigits)!==null&&Le!==void 0?Le:0)+2,20),maximumFractionDigits:Math.min(((Oe=this.options.maximumFractionDigits)!==null&&Oe!==void 0?Oe:0)+2,20)};return new $6c7bd7858deea686$export$cd11ab140839f11d(this.locale,Ae).parse(new $488c6ddbf4ef74c2$export$cc77c4ff7e8673c5(this.locale,Ae).format(s))}return this.options.currencySign==="accounting"&&$6c7bd7858deea686$var$CURRENCY_SIGN_REGEX.test(t)&&(s=-1*s),s}sanitize(t){return t=t.replace(this.symbols.literals,""),this.symbols.minusSign&&(t=t.replace("-",this.symbols.minusSign)),this.options.numberingSystem==="arab"&&(this.symbols.decimal&&(t=t.replace(",",this.symbols.decimal),t=t.replace("،",this.symbols.decimal)),this.symbols.group&&(t=$6c7bd7858deea686$var$replaceAll(t,".",this.symbols.group))),this.options.locale==="fr-FR"&&(t=$6c7bd7858deea686$var$replaceAll(t,"."," ")),t}isValidPartialNumber(t,i=-1/0,s=1/0){return t=this.sanitize(t),this.symbols.minusSign&&t.startsWith(this.symbols.minusSign)&&i<0?t=t.slice(this.symbols.minusSign.length):this.symbols.plusSign&&t.startsWith(this.symbols.plusSign)&&s>0&&(t=t.slice(this.symbols.plusSign.length)),this.symbols.group&&t.startsWith(this.symbols.group)||this.symbols.decimal&&t.indexOf(this.symbols.decimal)>-1&&this.options.maximumFractionDigits===0?!1:(this.symbols.group&&(t=$6c7bd7858deea686$var$replaceAll(t,this.symbols.group,"")),t=t.replace(this.symbols.numeral,""),this.symbols.decimal&&(t=t.replace(this.symbols.decimal,"")),t.length===0)}constructor(t,i={}){this.locale=t,this.formatter=new Intl.NumberFormat(t,i),this.options=this.formatter.resolvedOptions(),this.symbols=$6c7bd7858deea686$var$getSymbols(t,this.formatter,this.options,i);var s,Le;this.options.style==="percent"&&(((s=this.options.minimumFractionDigits)!==null&&s!==void 0?s:0)>18||((Le=this.options.maximumFractionDigits)!==null&&Le!==void 0?Le:0)>18)&&console.warn("NumberParser cannot handle percentages with greater than 18 decimal places, please reduce the number in your options.")}}const $6c7bd7858deea686$var$nonLiteralParts=new Set(["decimal","fraction","integer","minusSign","plusSign","group"]),$6c7bd7858deea686$var$pluralNumbers=[0,4,2,1,11,20,3,7,100,21,.1,1.1];function $6c7bd7858deea686$var$getSymbols(n,t,i,s){var Le,Oe,Ae,Ee;let $e=new Intl.NumberFormat(n,{...i,minimumSignificantDigits:1,maximumSignificantDigits:21}),Ie=$e.formatToParts(-10000.111),Fe=$e.formatToParts(10000.111),He=$6c7bd7858deea686$var$pluralNumbers.map(Qe=>$e.formatToParts(Qe));var ze;let je=(ze=(Le=Ie.find(Qe=>Qe.type==="minusSign"))===null||Le===void 0?void 0:Le.value)!==null&&ze!==void 0?ze:"-",Ne=(Oe=Fe.find(Qe=>Qe.type==="plusSign"))===null||Oe===void 0?void 0:Oe.value;!Ne&&(s?.signDisplay==="exceptZero"||s?.signDisplay==="always")&&(Ne="+");let Be=(Ae=new Intl.NumberFormat(n,{...i,minimumFractionDigits:2,maximumFractionDigits:2}).formatToParts(.001).find(Qe=>Qe.type==="decimal"))===null||Ae===void 0?void 0:Ae.value,Ue=(Ee=Ie.find(Qe=>Qe.type==="group"))===null||Ee===void 0?void 0:Ee.value,We=Ie.filter(Qe=>!$6c7bd7858deea686$var$nonLiteralParts.has(Qe.type)).map(Qe=>$6c7bd7858deea686$var$escapeRegex(Qe.value)),Ge=He.flatMap(Qe=>Qe.filter(io=>!$6c7bd7858deea686$var$nonLiteralParts.has(io.type)).map(io=>$6c7bd7858deea686$var$escapeRegex(io.value))),qe=[...new Set([...We,...Ge])].sort((Qe,io)=>io.length-Qe.length),Xe=qe.length===0?new RegExp("[\\p{White_Space}]","gu"):new RegExp(`${qe.join("|")}|[\\p{White_Space}]`,"gu"),Je=[...new Intl.NumberFormat(i.locale,{useGrouping:!1}).format(9876543210)].reverse(),Ze=new Map(Je.map((Qe,io)=>[Qe,io])),Ye=new RegExp(`[${Je.join("")}]`,"g");return{minusSign:je,plusSign:Ne,decimal:Be,group:Ue,literals:Xe,numeral:Ye,index:Qe=>String(Ze.get(Qe))}}function $6c7bd7858deea686$var$replaceAll(n,t,i){return n.replaceAll?n.replaceAll(t,i):n.split(t).join(i)}function $6c7bd7858deea686$var$escapeRegex(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var RTL_SCRIPTS=new Set(["Avst","Arab","Armi","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),RTL_LANGS=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function isRTL$1(n){if(Intl.Locale){const i=new Intl.Locale(n).maximize().script??"";return RTL_SCRIPTS.has(i)}const t=n.split("-")[0];return RTL_LANGS.has(t)}function getReadingDirection(n){return isRTL$1(n)?"rtl":"ltr"}function getDefaultLocale(){let n=typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([n])}catch{n="en-US"}return{locale:n,direction:getReadingDirection(n)}}var currentLocale=getDefaultLocale(),listeners=new Set;function updateLocale(){currentLocale=getDefaultLocale();for(const n of listeners)n(currentLocale)}function createDefaultLocale(){const[n,t]=createSignal(currentLocale),i=createMemo(()=>n());return onMount(()=>{listeners.size===0&&window.addEventListener("languagechange",updateLocale),listeners.add(t),onCleanup(()=>{listeners.delete(t),listeners.size===0&&window.removeEventListener("languagechange",updateLocale)})}),{locale:()=>i().locale,direction:()=>i().direction}}var I18nContext=createContext();function useLocale(){const n=createDefaultLocale();return useContext(I18nContext)||n}var cache$1=new Map;function createCollator(n){const{locale:t}=useLocale(),i=createMemo(()=>t()+(n?Object.entries(n).sort((s,Le)=>s[0]<Le[0]?-1:1).join():""));return createMemo(()=>{const s=i();let Le;return cache$1.has(s)&&(Le=cache$1.get(s)),Le||(Le=new Intl.Collator(t(),n),cache$1.set(s,Le)),Le})}var FORM_CONTROL_PROP_NAMES=["id","name","validationState","required","disabled","readOnly"];function createFormControl(n){const t=`form-control-${createUniqueId()}`,i=mergeDefaultProps({id:t},n),[s,Le]=createSignal(),[Oe,Ae]=createSignal(),[Ee,$e]=createSignal(),[Ie,Fe]=createSignal(),He=(Ke,Be,Ue)=>{const We=Ue!=null||s()!=null;return[Ue,s(),We&&Be!=null?Ke:void 0].filter(Boolean).join(" ")||void 0},ze=Ke=>[Ee(),Ie(),Ke].filter(Boolean).join(" ")||void 0,je=createMemo(()=>({"data-valid":access(i.validationState)==="valid"?"":void 0,"data-invalid":access(i.validationState)==="invalid"?"":void 0,"data-required":access(i.required)?"":void 0,"data-disabled":access(i.disabled)?"":void 0,"data-readonly":access(i.readOnly)?"":void 0}));return{formControlContext:{name:()=>access(i.name)??access(i.id),dataset:je,validationState:()=>access(i.validationState),isRequired:()=>access(i.required),isDisabled:()=>access(i.disabled),isReadOnly:()=>access(i.readOnly),labelId:s,fieldId:Oe,descriptionId:Ee,errorMessageId:Ie,getAriaLabelledBy:He,getAriaDescribedBy:ze,generateId:createGenerateId(()=>access(i.id)),registerLabel:createRegisterId(Le),registerField:createRegisterId(Ae),registerDescription:createRegisterId($e),registerErrorMessage:createRegisterId(Fe)}}}var FormControlContext=createContext();function useFormControlContext(){const n=useContext(FormControlContext);if(n===void 0)throw new Error("[kobalte]: `useFormControlContext` must be used within a `FormControlContext.Provider` component");return n}function FormControlDescription(n){const t=useFormControlContext(),i=mergeDefaultProps({id:t.generateId("description")},n);return createEffect(()=>onCleanup(t.registerDescription(i.id))),createComponent(Polymorphic,mergeProps({as:"div"},()=>t.dataset(),i))}function FormControlErrorMessage(n){const t=useFormControlContext(),i=mergeDefaultProps({id:t.generateId("error-message")},n),[s,Le]=splitProps(i,["forceMount"]),Oe=()=>t.validationState()==="invalid";return createEffect(()=>{Oe()&&onCleanup(t.registerErrorMessage(Le.id))}),createComponent(Show,{get when(){return s.forceMount||Oe()},get children(){return createComponent(Polymorphic,mergeProps({as:"div"},()=>t.dataset(),Le))}})}function FormControlLabel(n){let t;const i=useFormControlContext(),s=mergeDefaultProps({id:i.generateId("label")},n),[Le,Oe]=splitProps(s,["ref"]),Ae=createTagName(()=>t,()=>"label");return createEffect(()=>onCleanup(i.registerLabel(Oe.id))),createComponent(Polymorphic,mergeProps({as:"label",ref(Ee){var $e=mergeRefs(Ie=>t=Ie,Le.ref);typeof $e=="function"&&$e(Ee)},get for(){return createMemo(()=>Ae()==="label")()?i.fieldId():void 0}},()=>i.dataset(),Oe))}var FORM_CONTROL_FIELD_PROP_NAMES=["id","aria-label","aria-labelledby","aria-describedby"];function createFormControlField(n){const t=useFormControlContext(),i=mergeDefaultProps({id:t.generateId("field")},n);return createEffect(()=>onCleanup(t.registerField(access(i.id)))),{fieldProps:{id:()=>access(i.id),ariaLabel:()=>access(i["aria-label"]),ariaLabelledBy:()=>t.getAriaLabelledBy(access(i.id),access(i["aria-label"]),access(i["aria-labelledby"])),ariaDescribedBy:()=>t.getAriaDescribedBy(access(i["aria-describedby"]))}}}function createFormResetListener(n,t){createEffect(on$1(n,i=>{if(i==null)return;const s=getClosestForm(i);s!=null&&(s.addEventListener("reset",t,{passive:!0}),onCleanup(()=>{s.removeEventListener("reset",t)}))}))}function getClosestForm(n){return isFormElement(n)?n.form:n.closest("form")}function isFormElement(n){return n.matches("textarea, input, select, button")}function createControllableSignal(n){const[t,i]=createSignal(n.defaultValue?.()),s=createMemo(()=>n.value?.()!==void 0),Le=createMemo(()=>s()?n.value?.():t());return[Le,Ae=>{untrack(()=>{const Ee=accessWith(Ae,Le());return Object.is(Ee,Le())||(s()||i(Ee),n.onChange?.(Ee)),Ee})}]}function createControllableBooleanSignal(n){const[t,i]=createControllableSignal(n);return[()=>t()??!1,i]}var _tmpl$$8=template("<div aria-hidden=true><input type=text tabindex=-1>"),number_field_exports={};__export(number_field_exports,{DecrementTrigger:()=>NumberFieldDecrementTrigger$1,Description:()=>FormControlDescription,ErrorMessage:()=>FormControlErrorMessage,HiddenInput:()=>NumberFieldHiddenInput,IncrementTrigger:()=>NumberFieldIncrementTrigger$1,Input:()=>NumberFieldInput$1,Label:()=>FormControlLabel,NumberField:()=>NumberField$1,Root:()=>NumberFieldRoot});var NumberFieldContext=createContext();function useNumberFieldContext(){const n=useContext(NumberFieldContext);if(n===void 0)throw new Error("[kobalte]: `useNumberFieldContext` must be used within a `NumberField` component");return n}function NumberFieldVaryTrigger(n){const t=useFormControlContext(),i=useNumberFieldContext(),[s,Le]=splitProps(n,["numberFieldVaryType","onClick"]);return createComponent(ButtonRoot,mergeProps({tabIndex:-1,get disabled(){return t.isDisabled()||i.rawValue()===(s.numberFieldVaryType==="increment"?i.maxValue():i.minValue())},get"aria-controls"(){return t.fieldId()},onClick:Oe=>{callHandler(Oe,s.onClick),i.varyValue(i.step()*(s.numberFieldVaryType==="increment"?1:-1)),i.inputRef()?.focus()}},Le))}function NumberFieldDecrementTrigger$1(n){return createComponent(NumberFieldVaryTrigger,mergeProps({numberFieldVaryType:"decrement"},n))}function NumberFieldHiddenInput(n){const t=useNumberFieldContext(),[i,s]=splitProps(n,["ref","onChange"]),Le=useFormControlContext();return(()=>{var Oe=_tmpl$$8(),Ae=Oe.firstChild;Ae.addEventListener("change",$e=>{callHandler($e,i.onChange),batch(()=>{t.setValue($e.target.value),t.format()})});var Ee=mergeRefs(t.setHiddenInputRef,i.ref);return typeof Ee=="function"&&use(Ee,Ae),Ae.style.setProperty("font-size","16px"),spread(Ae,mergeProps({get name(){return Le.name()},get value(){return createMemo(()=>!!Number.isNaN(t.rawValue()))()?"":t.rawValue()},get required(){return Le.isRequired()},get disabled(){return Le.isDisabled()},get readOnly(){return Le.isReadOnly()}},s),!1,!1),createRenderEffect($e=>style(Oe,visuallyHiddenStyles,$e)),Oe})()}function NumberFieldIncrementTrigger$1(n){return createComponent(NumberFieldVaryTrigger,mergeProps({numberFieldVaryType:"increment"},n))}function NumberFieldInput$1(n){const t=useFormControlContext(),i=useNumberFieldContext(),s=mergeDefaultProps({id:i.generateId("input"),inputMode:"decimal",autocomplete:"off",autocorrect:"off",spellcheck:!1},n),[Le,Oe,Ae]=splitProps(s,["ref","onInput","onChange","onWheel","as"],FORM_CONTROL_FIELD_PROP_NAMES),{fieldProps:Ee}=createFormControlField(Oe);return createComponent(SpinButtonRoot,mergeProps({type:"text",get id(){return Ee.id()},ref($e){var Ie=mergeRefs(i.setInputRef,Le.ref);typeof Ie=="function"&&Ie($e)},get value(){return i.value()},get validationState(){return t.validationState()},get required(){return t.isRequired()},get disabled(){return t.isDisabled()},get readOnly(){return t.isReadOnly()},get textValue(){return i.textValue()},get minValue(){return i.minValue()},get maxValue(){return i.maxValue()},onIncrement:()=>{i.varyValue(i.step())},onIncrementPage:()=>{i.varyValue(i.largeStep())},onIncrementToMax:()=>{i.setValue(i.maxValue()),i.format()},onDecrement:()=>{i.varyValue(-i.step())},onDecrementPage:()=>{i.varyValue(-i.largeStep())},onDecrementToMin:()=>{i.setValue(i.minValue()),i.format()},get translations(){return i.translations()},onChange:$e=>{callHandler($e,Le.onChange),i.format()},onWheel:$e=>{callHandler($e,Le.onWheel),!(!i.changeOnWheel()||document.activeElement!==i.inputRef())&&($e.preventDefault(),$e.deltaY<0?i.varyValue(i.step()):i.varyValue(-i.step()))},get onInput(){return composeEventHandlers([Le.onInput,i.onInput])},get"aria-label"(){return Ee.ariaLabel()},get"aria-labelledby"(){return Ee.ariaLabelledBy()},get"aria-describedby"(){return Ee.ariaDescribedBy()}},()=>t.dataset(),{as:$e=>createComponent(Polymorphic,mergeProps({get as(){return Le.as||"input"},get value(){return createMemo(()=>!!Number.isNaN(i.rawValue()))()?"":i.formatNumber(i.rawValue())},get required(){return t.isRequired()},get disabled(){return t.isDisabled()},get readOnly(){return t.isReadOnly()}},$e,Ae))}))}function NumberFieldRoot(n){let t;const i=`NumberField-${createUniqueId()}`,s=mergeDefaultProps({id:i,format:!0,minValue:Number.MIN_SAFE_INTEGER,maxValue:Number.MAX_SAFE_INTEGER,step:1,changeOnWheel:!0},n),[Le,Oe,Ae]=splitProps(s,["ref","value","defaultValue","onChange","rawValue","onRawValueChange","translations","format","formatOptions","textValue","minValue","maxValue","step","largeStep","changeOnWheel","translations","allowedInput"],FORM_CONTROL_PROP_NAMES),{locale:Ee}=useLocale(),$e=createMemo(()=>new $6c7bd7858deea686$export$cd11ab140839f11d(Ee(),Le.formatOptions)),Ie=createMemo(()=>new $488c6ddbf4ef74c2$export$cc77c4ff7e8673c5(Ee(),Le.formatOptions)),Fe=Je=>Le.format&&typeof Je!="number"?$e().parse(Je??""):Number(Je??""),He=Je=>Le.format&&typeof Je!="number"?$e().isValidPartialNumber(Je??"",s.minValue,s.maxValue):!Number.isNaN(Number(Je)),[ze,je]=createControllableSignal({value:()=>Le.value,defaultValue:()=>Le.defaultValue??Le.rawValue,onChange:Je=>{Le.onChange?.(typeof Je=="number"?Ie().format(Je):Je),Le.onRawValueChange?.(Fe(Je))}});Le.onRawValueChange?.(Fe(ze()));function Ne(Je){return Le.allowedInput!==void 0?Le.allowedInput.test(Je):!0}const{formControlContext:Ke}=createFormControl(Oe);createFormResetListener(()=>t,()=>{je(Le.defaultValue??"")});const[Be,Ue]=createSignal(),[We,Ge]=createSignal(),qe=Je=>{if(Ke.isReadOnly()||Ke.isDisabled())return;const Ze=Je.target;let Ye=Ze.selectionStart;He(Ze.value)?(Je.inputType!=="insertText"||Ne(Je.data||""))&&je(Ze.value):Je.inputType==="deleteContentBackward"&&Ye!==null&&(Ye+=1);const eo=ze();eo!==Ze.value&&(Ze.value=String(eo??""),Ye!==null&&(Ze.selectionStart=Ye,Ze.selectionEnd=Ye))},Xe={value:ze,setValue:je,rawValue:()=>Fe(ze()),generateId:createGenerateId(()=>access(Oe.id)),formatNumber:Je=>Ie().format(Je),format:()=>{if(!Le.format)return;let Je=Xe.rawValue();if(Number.isNaN(Je)){We()&&(We().value=""),Le.onRawValueChange?.(Je);return}Xe.minValue()&&(Je=Math.max(Je,Xe.minValue())),Xe.maxValue()&&(Je=Math.min(Je,Xe.maxValue()));const Ze=Xe.formatNumber(Je);ze()!=Ze&&je(Ze),Be()&&(Be().value=Ze),We()&&(We().value=String(Je))},onInput:qe,textValue:()=>Le.textValue,minValue:()=>Le.minValue,maxValue:()=>Le.maxValue,step:()=>Le.step,largeStep:()=>Le.largeStep??Le.step*10,changeOnWheel:()=>Le.changeOnWheel,translations:()=>Le.translations,inputRef:Be,setInputRef:Ue,hiddenInputRef:We,setHiddenInputRef:Ge,varyValue:Je=>{let Ze=Xe.rawValue()??0;Number.isNaN(Ze)&&(Ze=0),batch(()=>{let Ye=Ze;Ze%1===0?Ye+=Je:Je>0?Ye=Math.ceil(Ye):Ye=Math.floor(Ye),Xe.setValue(Ye),Xe.format()})}};return createEffect(on$1(()=>Le.rawValue,Je=>{if(Je!==Xe.rawValue()){if(Number.isNaN(Je))return;batch(()=>{je(Je??""),Xe.format()})}},{defer:!0})),createComponent(FormControlContext.Provider,{value:Ke,get children(){return createComponent(NumberFieldContext.Provider,{value:Xe,get children(){return createComponent(Polymorphic,mergeProps({as:"div",ref(Je){var Ze=mergeRefs(Ye=>t=Ye,Le.ref);typeof Ze=="function"&&Ze(Je)},role:"group",get id(){return access(Oe.id)}},()=>Ke.dataset(),Ae))}})}})}var NumberField$1=Object.assign(NumberFieldRoot,{Description:FormControlDescription,ErrorMessage:FormControlErrorMessage,HiddenInput:NumberFieldHiddenInput,Input:NumberFieldInput$1,IncrementTrigger:NumberFieldIncrementTrigger$1,DecrementTrigger:NumberFieldDecrementTrigger$1,Label:FormControlLabel}),_tmpl$$7=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round class=size-4><path d="M6 15l6 -6l6 6">'),_tmpl$2$4=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round class=size-4><path d="M6 9l6 6l6 -6">');const NumberField=NumberFieldRoot,NumberFieldLabel=n=>{const[t,i]=splitProps(n,["class"]);return createComponent(FormControlLabel,mergeProps({get class(){return cn$1("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t.class)}},i))},NumberFieldInput=n=>{const[t,i]=splitProps(n,["class"]);return createComponent(NumberFieldInput$1,mergeProps({get class(){return cn$1("flex h-10 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[invalid]:border-error-foreground data-[invalid]:text-error-foreground",t.class)}},i))},NumberFieldIncrementTrigger=n=>{const[t,i]=splitProps(n,["class","children"]);return createComponent(NumberFieldIncrementTrigger$1,mergeProps({get class(){return cn$1("absolute right-1 top-1 inline-flex size-4 items-center justify-center",t.class)}},i,{get children(){return t.children??_tmpl$$7()}}))},NumberFieldDecrementTrigger=n=>{const[t,i]=splitProps(n,["class","children"]);return createComponent(NumberFieldDecrementTrigger$1,mergeProps({get class(){return cn$1("absolute bottom-1 right-1 inline-flex size-4 items-center justify-center",t.class)}},i,{get children(){return t.children??_tmpl$2$4()}}))},NumberFieldDescription=n=>{const[t,i]=splitProps(n,["class"]);return createComponent(FormControlDescription,mergeProps({get class(){return cn$1("text-sm text-muted-foreground",t.class)}},i))};function buildNodes(n){let t=n.startIndex??0;const i=n.startLevel??0,s=[],Le=$e=>{if($e==null)return"";const Ie=n.getKey??"key",Fe=isString(Ie)?$e[Ie]:Ie($e);return Fe!=null?String(Fe):""},Oe=$e=>{if($e==null)return"";const Ie=n.getTextValue??"textValue",Fe=isString(Ie)?$e[Ie]:Ie($e);return Fe!=null?String(Fe):""},Ae=$e=>{if($e==null)return!1;const Ie=n.getDisabled??"disabled";return(isString(Ie)?$e[Ie]:Ie($e))??!1},Ee=$e=>{if($e!=null)return isString(n.getSectionChildren)?$e[n.getSectionChildren]:n.getSectionChildren?.($e)};for(const $e of n.dataSource){if(isString($e)||isNumber($e)){s.push({type:"item",rawValue:$e,key:String($e),textValue:String($e),disabled:Ae($e),level:i,index:t}),t++;continue}if(Ee($e)!=null){s.push({type:"section",rawValue:$e,key:"",textValue:"",disabled:!1,level:i,index:t}),t++;const Ie=Ee($e)??[];if(Ie.length>0){const Fe=buildNodes({dataSource:Ie,getKey:n.getKey,getTextValue:n.getTextValue,getDisabled:n.getDisabled,getSectionChildren:n.getSectionChildren,startIndex:t,startLevel:i+1});s.push(...Fe),t+=Fe.length}}else s.push({type:"item",rawValue:$e,key:Le($e),textValue:Oe($e),disabled:Ae($e),level:i,index:t}),t++}return s}function createCollection(n,t=[]){return createMemo(()=>{const i=buildNodes({dataSource:access(n.dataSource),getKey:access(n.getKey),getTextValue:access(n.getTextValue),getDisabled:access(n.getDisabled),getSectionChildren:access(n.getSectionChildren)});for(let s=0;s<t.length;s++)t[s]();return n.factory(i)})}var Selection=class bo extends Set{anchorKey;currentKey;constructor(t,i,s){super(t),t instanceof bo?(this.anchorKey=i||t.anchorKey,this.currentKey=s||t.currentKey):(this.anchorKey=i,this.currentKey=s)}};function createControllableSelectionSignal(n){const[t,i]=createControllableSignal(n);return[()=>t()??new Selection,i]}function isNonContiguousSelectionModifier(n){return isAppleDevice()?n.altKey:n.ctrlKey}function isCtrlKeyPressed(n){return isMac()?n.metaKey:n.ctrlKey}function convertSelection(n){return new Selection(n)}function isSameSelection(n,t){if(n.size!==t.size)return!1;for(const i of n)if(!t.has(i))return!1;return!0}function createMultipleSelectionState(n){const t=mergeDefaultProps({selectionMode:"none",selectionBehavior:"toggle"},n),[i,s]=createSignal(!1),[Le,Oe]=createSignal(),Ae=createMemo(()=>{const Ke=access(t.selectedKeys);return Ke!=null?convertSelection(Ke):Ke}),Ee=createMemo(()=>{const Ke=access(t.defaultSelectedKeys);return Ke!=null?convertSelection(Ke):new Selection}),[$e,Ie]=createControllableSelectionSignal({value:Ae,defaultValue:Ee,onChange:Ke=>t.onSelectionChange?.(Ke)}),[Fe,He]=createSignal(access(t.selectionBehavior)),ze=()=>access(t.selectionMode),je=()=>access(t.disallowEmptySelection)??!1,Ne=Ke=>{(access(t.allowDuplicateSelectionEvents)||!isSameSelection(Ke,$e()))&&Ie(Ke)};return createEffect(()=>{const Ke=$e();access(t.selectionBehavior)==="replace"&&Fe()==="toggle"&&typeof Ke=="object"&&Ke.size===0&&He("replace")}),createEffect(()=>{He(access(t.selectionBehavior)??"toggle")}),{selectionMode:ze,disallowEmptySelection:je,selectionBehavior:Fe,setSelectionBehavior:He,isFocused:i,setFocused:s,focusedKey:Le,setFocusedKey:Oe,selectedKeys:$e,setSelectedKeys:Ne}}function createTypeSelect(n){const[t,i]=createSignal(""),[s,Le]=createSignal(-1);return{typeSelectHandlers:{onKeyDown:Ae=>{if(access(n.isDisabled))return;const Ee=access(n.keyboardDelegate),$e=access(n.selectionManager);if(!Ee.getKeyForSearch)return;const Ie=getStringForKey(Ae.key);if(!Ie||Ae.ctrlKey||Ae.metaKey)return;Ie===" "&&t().trim().length>0&&(Ae.preventDefault(),Ae.stopPropagation());let Fe=i(ze=>ze+Ie),He=Ee.getKeyForSearch(Fe,$e.focusedKey())??Ee.getKeyForSearch(Fe);He==null&&isAllSameLetter(Fe)&&(Fe=Fe[0],He=Ee.getKeyForSearch(Fe,$e.focusedKey())??Ee.getKeyForSearch(Fe)),He!=null&&($e.setFocusedKey(He),n.onTypeSelect?.(He)),clearTimeout(s()),Le(window.setTimeout(()=>i(""),500))}}}}function getStringForKey(n){return n.length===1||!/^[A-Z]/i.test(n)?n:""}function isAllSameLetter(n){return n.split("").every(t=>t===n[0])}function createSelectableCollection(n,t,i){const Le=mergeProps({selectOnFocus:()=>access(n.selectionManager).selectionBehavior()==="replace"},n),Oe=()=>i?.()??t(),{direction:Ae}=useLocale();let Ee={top:0,left:0};createEventListener(()=>access(Le.isVirtualized)?void 0:Oe(),"scroll",()=>{const Be=Oe();Be&&(Ee={top:Be.scrollTop,left:Be.scrollLeft})});const{typeSelectHandlers:$e}=createTypeSelect({isDisabled:()=>access(Le.disallowTypeAhead),keyboardDelegate:()=>access(Le.keyboardDelegate),selectionManager:()=>access(Le.selectionManager)}),Ie=()=>access(Le.orientation)??"vertical",Fe=Be=>{callHandler(Be,$e.onKeyDown),Be.altKey&&Be.key==="Tab"&&Be.preventDefault();const Ue=t();if(!Ue?.contains(Be.target))return;const We=access(Le.selectionManager),Ge=access(Le.selectOnFocus),qe=Ye=>{Ye!=null&&(We.setFocusedKey(Ye),Be.shiftKey&&We.selectionMode()==="multiple"?We.extendSelection(Ye):Ge&&!isNonContiguousSelectionModifier(Be)&&We.replaceSelection(Ye))},Xe=access(Le.keyboardDelegate),Je=access(Le.shouldFocusWrap),Ze=We.focusedKey();switch(Be.key){case(Ie()==="vertical"?"ArrowDown":"ArrowRight"):{if(Xe.getKeyBelow){Be.preventDefault();let Ye;Ze!=null?Ye=Xe.getKeyBelow(Ze):Ye=Xe.getFirstKey?.(),Ye==null&&Je&&(Ye=Xe.getFirstKey?.(Ze)),qe(Ye)}break}case(Ie()==="vertical"?"ArrowUp":"ArrowLeft"):{if(Xe.getKeyAbove){Be.preventDefault();let Ye;Ze!=null?Ye=Xe.getKeyAbove(Ze):Ye=Xe.getLastKey?.(),Ye==null&&Je&&(Ye=Xe.getLastKey?.(Ze)),qe(Ye)}break}case(Ie()==="vertical"?"ArrowLeft":"ArrowUp"):{if(Xe.getKeyLeftOf){Be.preventDefault();const Ye=Ae()==="rtl";let eo;Ze!=null?eo=Xe.getKeyLeftOf(Ze):eo=Ye?Xe.getFirstKey?.():Xe.getLastKey?.(),qe(eo)}break}case(Ie()==="vertical"?"ArrowRight":"ArrowDown"):{if(Xe.getKeyRightOf){Be.preventDefault();const Ye=Ae()==="rtl";let eo;Ze!=null?eo=Xe.getKeyRightOf(Ze):eo=Ye?Xe.getLastKey?.():Xe.getFirstKey?.(),qe(eo)}break}case"Home":if(Xe.getFirstKey){Be.preventDefault();const Ye=Xe.getFirstKey(Ze,isCtrlKeyPressed(Be));Ye!=null&&(We.setFocusedKey(Ye),isCtrlKeyPressed(Be)&&Be.shiftKey&&We.selectionMode()==="multiple"?We.extendSelection(Ye):Ge&&We.replaceSelection(Ye))}break;case"End":if(Xe.getLastKey){Be.preventDefault();const Ye=Xe.getLastKey(Ze,isCtrlKeyPressed(Be));Ye!=null&&(We.setFocusedKey(Ye),isCtrlKeyPressed(Be)&&Be.shiftKey&&We.selectionMode()==="multiple"?We.extendSelection(Ye):Ge&&We.replaceSelection(Ye))}break;case"PageDown":if(Xe.getKeyPageBelow&&Ze!=null){Be.preventDefault();const Ye=Xe.getKeyPageBelow(Ze);qe(Ye)}break;case"PageUp":if(Xe.getKeyPageAbove&&Ze!=null){Be.preventDefault();const Ye=Xe.getKeyPageAbove(Ze);qe(Ye)}break;case"a":isCtrlKeyPressed(Be)&&We.selectionMode()==="multiple"&&access(Le.disallowSelectAll)!==!0&&(Be.preventDefault(),We.selectAll());break;case"Escape":Be.defaultPrevented||(Be.preventDefault(),access(Le.disallowEmptySelection)||We.clearSelection());break;case"Tab":if(!access(Le.allowsTabNavigation)){if(Be.shiftKey)Ue.focus();else{const Ye=getFocusableTreeWalker(Ue,{tabbable:!0});let eo,Qe;do Qe=Ye.lastChild(),Qe&&(eo=Qe);while(Qe);eo&&!eo.contains(document.activeElement)&&focusWithoutScrolling(eo)}break}}},He=Be=>{const Ue=access(Le.selectionManager),We=access(Le.keyboardDelegate),Ge=access(Le.selectOnFocus);if(Ue.isFocused()){Be.currentTarget.contains(Be.target)||Ue.setFocused(!1);return}if(Be.currentTarget.contains(Be.target)){if(Ue.setFocused(!0),Ue.focusedKey()==null){const qe=Je=>{Je!=null&&(Ue.setFocusedKey(Je),Ge&&Ue.replaceSelection(Je))},Xe=Be.relatedTarget;Xe&&Be.currentTarget.compareDocumentPosition(Xe)&Node.DOCUMENT_POSITION_FOLLOWING?qe(Ue.lastSelectedKey()??We.getLastKey?.()):qe(Ue.firstSelectedKey()??We.getFirstKey?.())}else if(!access(Le.isVirtualized)){const qe=Oe();if(qe){qe.scrollTop=Ee.top,qe.scrollLeft=Ee.left;const Xe=qe.querySelector(`[data-key="${Ue.focusedKey()}"]`);Xe&&(focusWithoutScrolling(Xe),scrollIntoView(qe,Xe))}}}},ze=Be=>{const Ue=access(Le.selectionManager);Be.currentTarget.contains(Be.relatedTarget)||Ue.setFocused(!1)},je=Be=>{Oe()===Be.target&&Be.preventDefault()},Ne=()=>{const Be=access(Le.autoFocus);if(!Be)return;const Ue=access(Le.selectionManager),We=access(Le.keyboardDelegate);let Ge;Be==="first"&&(Ge=We.getFirstKey?.()),Be==="last"&&(Ge=We.getLastKey?.());const qe=Ue.selectedKeys();qe.size&&(Ge=qe.values().next().value),Ue.setFocused(!0),Ue.setFocusedKey(Ge);const Xe=t();Xe&&Ge==null&&!access(Le.shouldUseVirtualFocus)&&focusWithoutScrolling(Xe)};return onMount(()=>{Le.deferAutoFocus?setTimeout(Ne,0):Ne()}),createEffect(on$1([Oe,()=>access(Le.isVirtualized),()=>access(Le.selectionManager).focusedKey()],Be=>{const[Ue,We,Ge]=Be;if(We)Ge&&Le.scrollToKey?.(Ge);else if(Ge&&Ue){const qe=Ue.querySelector(`[data-key="${Ge}"]`);qe&&scrollIntoView(Ue,qe)}})),{tabIndex:createMemo(()=>{if(!access(Le.shouldUseVirtualFocus))return access(Le.selectionManager).focusedKey()==null?0:-1}),onKeyDown:Fe,onMouseDown:je,onFocusIn:He,onFocusOut:ze}}function createSelectableItem(n,t){const i=()=>access(n.selectionManager),s=()=>access(n.key),Le=()=>access(n.shouldUseVirtualFocus),Oe=We=>{i().selectionMode()!=="none"&&(i().selectionMode()==="single"?i().isSelected(s())&&!i().disallowEmptySelection()?i().toggleSelection(s()):i().replaceSelection(s()):We?.shiftKey?i().extendSelection(s()):i().selectionBehavior()==="toggle"||isCtrlKeyPressed(We)||"pointerType"in We&&We.pointerType==="touch"?i().toggleSelection(s()):i().replaceSelection(s()))},Ae=()=>i().isSelected(s()),Ee=()=>access(n.disabled)||i().isDisabled(s()),$e=()=>!Ee()&&i().canSelectItem(s());let Ie=null;const Fe=We=>{$e()&&(Ie=We.pointerType,We.pointerType==="mouse"&&We.button===0&&!access(n.shouldSelectOnPressUp)&&Oe(We))},He=We=>{$e()&&We.pointerType==="mouse"&&We.button===0&&access(n.shouldSelectOnPressUp)&&access(n.allowsDifferentPressOrigin)&&Oe(We)},ze=We=>{$e()&&(access(n.shouldSelectOnPressUp)&&!access(n.allowsDifferentPressOrigin)||Ie!=="mouse")&&Oe(We)},je=We=>{!$e()||!["Enter"," "].includes(We.key)||(isNonContiguousSelectionModifier(We)?i().toggleSelection(s()):Oe(We))},Ne=We=>{Ee()&&We.preventDefault()},Ke=We=>{const Ge=t();Le()||Ee()||!Ge||We.target===Ge&&i().setFocusedKey(s())},Be=createMemo(()=>{if(!(Le()||Ee()))return s()===i().focusedKey()?0:-1}),Ue=createMemo(()=>access(n.virtualized)?void 0:s());return createEffect(on$1([t,s,Le,()=>i().focusedKey(),()=>i().isFocused()],([We,Ge,qe,Xe,Je])=>{We&&Ge===Xe&&Je&&!qe&&document.activeElement!==We&&(n.focus?n.focus():focusWithoutScrolling(We))})),{isSelected:Ae,isDisabled:Ee,allowsSelection:$e,tabIndex:Be,dataKey:Ue,onPointerDown:Fe,onPointerUp:He,onClick:ze,onKeyDown:je,onMouseDown:Ne,onFocus:Ke}}var SelectionManager=class{collection;state;constructor(n,t){this.collection=n,this.state=t}selectionMode(){return this.state.selectionMode()}disallowEmptySelection(){return this.state.disallowEmptySelection()}selectionBehavior(){return this.state.selectionBehavior()}setSelectionBehavior(n){this.state.setSelectionBehavior(n)}isFocused(){return this.state.isFocused()}setFocused(n){this.state.setFocused(n)}focusedKey(){return this.state.focusedKey()}setFocusedKey(n){(n==null||this.collection().getItem(n))&&this.state.setFocusedKey(n)}selectedKeys(){return this.state.selectedKeys()}isSelected(n){if(this.state.selectionMode()==="none")return!1;const t=this.getKey(n);return t==null?!1:this.state.selectedKeys().has(t)}isEmpty(){return this.state.selectedKeys().size===0}isSelectAll(){if(this.isEmpty())return!1;const n=this.state.selectedKeys();return this.getAllSelectableKeys().every(t=>n.has(t))}firstSelectedKey(){let n;for(const t of this.state.selectedKeys()){const i=this.collection().getItem(t),s=i?.index!=null&&n?.index!=null&&i.index<n.index;(!n||s)&&(n=i)}return n?.key}lastSelectedKey(){let n;for(const t of this.state.selectedKeys()){const i=this.collection().getItem(t),s=i?.index!=null&&n?.index!=null&&i.index>n.index;(!n||s)&&(n=i)}return n?.key}extendSelection(n){if(this.selectionMode()==="none")return;if(this.selectionMode()==="single"){this.replaceSelection(n);return}const t=this.getKey(n);if(t==null)return;const i=this.state.selectedKeys(),s=i.anchorKey||t,Le=new Selection(i,s,t);for(const Oe of this.getKeyRange(s,i.currentKey||t))Le.delete(Oe);for(const Oe of this.getKeyRange(t,s))this.canSelectItem(Oe)&&Le.add(Oe);this.state.setSelectedKeys(Le)}getKeyRange(n,t){const i=this.collection().getItem(n),s=this.collection().getItem(t);return i&&s?i.index!=null&&s.index!=null&&i.index<=s.index?this.getKeyRangeInternal(n,t):this.getKeyRangeInternal(t,n):[]}getKeyRangeInternal(n,t){const i=[];let s=n;for(;s!=null;){const Le=this.collection().getItem(s);if(Le&&Le.type==="item"&&i.push(s),s===t)return i;s=this.collection().getKeyAfter(s)}return[]}getKey(n){const t=this.collection().getItem(n);return t?!t||t.type!=="item"?null:t.key:n}toggleSelection(n){if(this.selectionMode()==="none")return;if(this.selectionMode()==="single"&&!this.isSelected(n)){this.replaceSelection(n);return}const t=this.getKey(n);if(t==null)return;const i=new Selection(this.state.selectedKeys());i.has(t)?i.delete(t):this.canSelectItem(t)&&(i.add(t),i.anchorKey=t,i.currentKey=t),!(this.disallowEmptySelection()&&i.size===0)&&this.state.setSelectedKeys(i)}replaceSelection(n){if(this.selectionMode()==="none")return;const t=this.getKey(n);if(t==null)return;const i=this.canSelectItem(t)?new Selection([t],t,t):new Selection;this.state.setSelectedKeys(i)}setSelectedKeys(n){if(this.selectionMode()==="none")return;const t=new Selection;for(const i of n){const s=this.getKey(i);if(s!=null&&(t.add(s),this.selectionMode()==="single"))break}this.state.setSelectedKeys(t)}selectAll(){this.selectionMode()==="multiple"&&this.state.setSelectedKeys(new Set(this.getAllSelectableKeys()))}clearSelection(){const n=this.state.selectedKeys();!this.disallowEmptySelection()&&n.size>0&&this.state.setSelectedKeys(new Selection)}toggleSelectAll(){this.isSelectAll()?this.clearSelection():this.selectAll()}select(n,t){this.selectionMode()!=="none"&&(this.selectionMode()==="single"?this.isSelected(n)&&!this.disallowEmptySelection()?this.toggleSelection(n):this.replaceSelection(n):this.selectionBehavior()==="toggle"||t&&t.pointerType==="touch"?this.toggleSelection(n):this.replaceSelection(n))}isSelectionEqual(n){if(n===this.state.selectedKeys())return!0;const t=this.selectedKeys();if(n.size!==t.size)return!1;for(const i of n)if(!t.has(i))return!1;for(const i of t)if(!n.has(i))return!1;return!0}canSelectItem(n){if(this.state.selectionMode()==="none")return!1;const t=this.collection().getItem(n);return t!=null&&!t.disabled}isDisabled(n){const t=this.collection().getItem(n);return!t||t.disabled}getAllSelectableKeys(){const n=[];return(i=>{for(;i!=null;){if(this.canSelectItem(i)){const s=this.collection().getItem(i);if(!s)continue;s.type==="item"&&n.push(i)}i=this.collection().getKeyAfter(i)}})(this.collection().getFirstKey()),n}},ListCollection=class{keyMap=new Map;iterable;firstKey;lastKey;constructor(n){this.iterable=n;for(const s of n)this.keyMap.set(s.key,s);if(this.keyMap.size===0)return;let t,i=0;for(const[s,Le]of this.keyMap)t?(t.nextKey=s,Le.prevKey=t.key):(this.firstKey=s,Le.prevKey=void 0),Le.type==="item"&&(Le.index=i++),t=Le,t.nextKey=void 0;this.lastKey=t.key}*[Symbol.iterator](){yield*this.iterable}getSize(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(n){return this.keyMap.get(n)?.prevKey}getKeyAfter(n){return this.keyMap.get(n)?.nextKey}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(n){return this.keyMap.get(n)}at(n){const t=[...this.getKeys()];return this.getItem(t[n])}};function createListState(n){const t=createMultipleSelectionState(n),s=createCollection({dataSource:()=>access(n.dataSource),getKey:()=>access(n.getKey),getTextValue:()=>access(n.getTextValue),getDisabled:()=>access(n.getDisabled),getSectionChildren:()=>access(n.getSectionChildren),factory:Oe=>n.filter?new ListCollection(n.filter(Oe)):new ListCollection(Oe)},[()=>n.filter]),Le=new SelectionManager(s,t);return createComputed(()=>{const Oe=t.focusedKey();Oe!=null&&!s().getItem(Oe)&&t.setFocusedKey(void 0)}),{collection:s,selectionManager:()=>Le}}var _tmpl$$6=template("<option>"),_tmpl$2$3=template("<div aria-hidden=true><input type=text><select tabindex=-1><option>");function HiddenSelectBase(n){let t;const[i,s]=splitProps(n,["ref","onChange","collection","selectionManager","isOpen","isMultiple","isVirtualized","focusTrigger"]),Le=useFormControlContext(),[Oe,Ae]=createSignal(!1),Ee=$e=>{const Ie=i.collection.getItem($e);return createComponent(Show,{get when(){return Ie?.type==="item"},get children(){var Fe=_tmpl$$6();return Fe.value=$e,insert(Fe,()=>Ie?.textValue),createRenderEffect(()=>Fe.selected=i.selectionManager.isSelected($e)),Fe}})};return createEffect(on$1(()=>i.selectionManager.selectedKeys(),($e,Ie)=>{Ie&&isSameSelection($e,Ie)||(Ae(!0),t?.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})),t?.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})))},{defer:!0})),(()=>{var $e=_tmpl$2$3(),Ie=$e.firstChild,Fe=Ie.nextSibling;Fe.firstChild,Ie.addEventListener("focus",()=>i.focusTrigger()),Ie.style.setProperty("font-size","16px"),Fe.addEventListener("change",ze=>{callHandler(ze,i.onChange),Oe()||i.selectionManager.setSelectedKeys(new Set([ze.target.value])),Ae(!1)});var He=mergeRefs(ze=>t=ze,i.ref);return typeof He=="function"&&use(He,Fe),spread(Fe,mergeProps({get multiple(){return i.isMultiple},get name(){return Le.name()},get required(){return Le.isRequired()},get disabled(){return Le.isDisabled()},get size(){return i.collection.getSize()},get value(){return i.selectionManager.firstSelectedKey()??""}},s),!1,!0),insert(Fe,createComponent(Show,{get when(){return i.isVirtualized},get fallback(){return createComponent(For,{get each(){return[...i.collection.getKeys()]},children:Ee})},get children(){return createComponent(For,{get each(){return[...i.selectionManager.selectedKeys()]},children:Ee})}}),null),createRenderEffect(ze=>{var je=visuallyHiddenStyles,Ne=i.selectionManager.isFocused()||i.isOpen?-1:0,Ke=Le.isRequired(),Be=Le.isDisabled(),Ue=Le.isReadOnly();return ze.e=style($e,je,ze.e),Ne!==ze.t&&setAttribute(Ie,"tabindex",ze.t=Ne),Ke!==ze.a&&(Ie.required=ze.a=Ke),Be!==ze.o&&(Ie.disabled=ze.o=Be),Ue!==ze.i&&(Ie.readOnly=ze.i=Ue),ze},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),$e})()}var cache=new WeakMap;function getItemCount(n){let t=cache.get(n);if(t!=null)return t;t=0;for(const i of n)i.type==="item"&&t++;return cache.set(n,t),t}var ListKeyboardDelegate=class{collection;ref;collator;constructor(n,t,i){this.collection=n,this.ref=t,this.collator=i}getKeyBelow(n){let t=this.collection().getKeyAfter(n);for(;t!=null;){const i=this.collection().getItem(t);if(i&&i.type==="item"&&!i.disabled)return t;t=this.collection().getKeyAfter(t)}}getKeyAbove(n){let t=this.collection().getKeyBefore(n);for(;t!=null;){const i=this.collection().getItem(t);if(i&&i.type==="item"&&!i.disabled)return t;t=this.collection().getKeyBefore(t)}}getFirstKey(){let n=this.collection().getFirstKey();for(;n!=null;){const t=this.collection().getItem(n);if(t&&t.type==="item"&&!t.disabled)return n;n=this.collection().getKeyAfter(n)}}getLastKey(){let n=this.collection().getLastKey();for(;n!=null;){const t=this.collection().getItem(n);if(t&&t.type==="item"&&!t.disabled)return n;n=this.collection().getKeyBefore(n)}}getItem(n){return this.ref?.()?.querySelector(`[data-key="${n}"]`)??null}getKeyPageAbove(n){const t=this.ref?.();let i=this.getItem(n);if(!t||!i)return;const s=Math.max(0,i.offsetTop+i.offsetHeight-t.offsetHeight);let Le=n;for(;Le&&i&&i.offsetTop>s;)Le=this.getKeyAbove(Le),i=Le!=null?this.getItem(Le):null;return Le}getKeyPageBelow(n){const t=this.ref?.();let i=this.getItem(n);if(!t||!i)return;const s=Math.min(t.scrollHeight,i.offsetTop-i.offsetHeight+t.offsetHeight);let Le=n;for(;Le&&i&&i.offsetTop<s;)Le=this.getKeyBelow(Le),i=Le!=null?this.getItem(Le):null;return Le}getKeyForSearch(n,t){const i=this.collator?.();if(!i)return;let s=t!=null?this.getKeyBelow(t):this.getFirstKey();for(;s!=null;){const Le=this.collection().getItem(s);if(Le){const Oe=Le.textValue.slice(0,n.length);if(Le.textValue&&i.compare(Oe,n)===0)return s}s=this.getKeyBelow(s)}}};function createSelectableList(n,t,i){const s=createCollator({usage:"search",sensitivity:"base"}),Le=createMemo(()=>{const Oe=access(n.keyboardDelegate);return Oe||new ListKeyboardDelegate(n.collection,t,s)});return createSelectableCollection({selectionManager:()=>access(n.selectionManager),keyboardDelegate:Le,autoFocus:()=>access(n.autoFocus),deferAutoFocus:()=>access(n.deferAutoFocus),shouldFocusWrap:()=>access(n.shouldFocusWrap),disallowEmptySelection:()=>access(n.disallowEmptySelection),selectOnFocus:()=>access(n.selectOnFocus),disallowTypeAhead:()=>access(n.disallowTypeAhead),shouldUseVirtualFocus:()=>access(n.shouldUseVirtualFocus),allowsTabNavigation:()=>access(n.allowsTabNavigation),isVirtualized:()=>access(n.isVirtualized),scrollToKey:Oe=>access(n.scrollToKey)?.(Oe),orientation:()=>access(n.orientation)},t,i)}var listbox_exports={};__export(listbox_exports,{Item:()=>ListboxItem,ItemDescription:()=>ListboxItemDescription,ItemIndicator:()=>ListboxItemIndicator,ItemLabel:()=>ListboxItemLabel,Listbox:()=>Listbox,Root:()=>ListboxRoot,Section:()=>ListboxSection});var ListboxContext=createContext();function useListboxContext(){const n=useContext(ListboxContext);if(n===void 0)throw new Error("[kobalte]: `useListboxContext` must be used within a `Listbox` component");return n}var ListboxItemContext=createContext();function useListboxItemContext(){const n=useContext(ListboxItemContext);if(n===void 0)throw new Error("[kobalte]: `useListboxItemContext` must be used within a `Listbox.Item` component");return n}function ListboxItem(n){let t;const i=useListboxContext(),s=`${i.generateId("item")}-${createUniqueId()}`,Le=mergeDefaultProps({id:s},n),[Oe,Ae]=splitProps(Le,["ref","item","aria-label","aria-labelledby","aria-describedby","onPointerMove","onPointerDown","onPointerUp","onClick","onKeyDown","onMouseDown","onFocus"]),[Ee,$e]=createSignal(),[Ie,Fe]=createSignal(),He=()=>i.listState().selectionManager(),ze=()=>He().focusedKey()===Oe.item.key,je=createSelectableItem({key:()=>Oe.item.key,selectionManager:He,shouldSelectOnPressUp:i.shouldSelectOnPressUp,allowsDifferentPressOrigin:()=>i.shouldSelectOnPressUp()&&i.shouldFocusOnHover(),shouldUseVirtualFocus:i.shouldUseVirtualFocus,disabled:()=>Oe.item.disabled},()=>t),Ne=()=>{if(He().selectionMode()!=="none")return je.isSelected()},Ke=createMemo(()=>!(isMac()&&isWebKit$1())),Be=()=>Ke()?Oe["aria-label"]:void 0,Ue=()=>Ke()?Ee():void 0,We=()=>Ke()?Ie():void 0,Ge=()=>{if(!i.isVirtualized())return;const Ye=i.listState().collection().getItem(Oe.item.key)?.index;return Ye!=null?Ye+1:void 0},qe=()=>{if(i.isVirtualized())return getItemCount(i.listState().collection())},Xe=Ye=>{callHandler(Ye,Oe.onPointerMove),Ye.pointerType==="mouse"&&!je.isDisabled()&&i.shouldFocusOnHover()&&(focusWithoutScrolling(Ye.currentTarget),He().setFocused(!0),He().setFocusedKey(Oe.item.key))},Je=createMemo(()=>({"data-disabled":je.isDisabled()?"":void 0,"data-selected":je.isSelected()?"":void 0,"data-highlighted":ze()?"":void 0})),Ze={isSelected:je.isSelected,dataset:Je,generateId:createGenerateId(()=>Ae.id),registerLabelId:createRegisterId($e),registerDescriptionId:createRegisterId(Fe)};return createComponent(ListboxItemContext.Provider,{value:Ze,get children(){return createComponent(Polymorphic,mergeProps({as:"li",ref(Ye){var eo=mergeRefs(Qe=>t=Qe,Oe.ref);typeof eo=="function"&&eo(Ye)},role:"option",get tabIndex(){return je.tabIndex()},get"aria-disabled"(){return je.isDisabled()},get"aria-selected"(){return Ne()},get"aria-label"(){return Be()},get"aria-labelledby"(){return Ue()},get"aria-describedby"(){return We()},get"aria-posinset"(){return Ge()},get"aria-setsize"(){return qe()},get"data-key"(){return je.dataKey()},get onPointerDown(){return composeEventHandlers([Oe.onPointerDown,je.onPointerDown])},get onPointerUp(){return composeEventHandlers([Oe.onPointerUp,je.onPointerUp])},get onClick(){return composeEventHandlers([Oe.onClick,je.onClick])},get onKeyDown(){return composeEventHandlers([Oe.onKeyDown,je.onKeyDown])},get onMouseDown(){return composeEventHandlers([Oe.onMouseDown,je.onMouseDown])},get onFocus(){return composeEventHandlers([Oe.onFocus,je.onFocus])},onPointerMove:Xe},Je,Ae))}})}function ListboxItemDescription(n){const t=useListboxItemContext(),i=mergeDefaultProps({id:t.generateId("description")},n);return createEffect(()=>onCleanup(t.registerDescriptionId(i.id))),createComponent(Polymorphic,mergeProps({as:"div"},()=>t.dataset(),i))}function ListboxItemIndicator(n){const t=useListboxItemContext(),i=mergeDefaultProps({id:t.generateId("indicator")},n),[s,Le]=splitProps(i,["forceMount"]);return createComponent(Show,{get when(){return s.forceMount||t.isSelected()},get children(){return createComponent(Polymorphic,mergeProps({as:"div","aria-hidden":"true"},()=>t.dataset(),Le))}})}function ListboxItemLabel(n){const t=useListboxItemContext(),i=mergeDefaultProps({id:t.generateId("label")},n);return createEffect(()=>onCleanup(t.registerLabelId(i.id))),createComponent(Polymorphic,mergeProps({as:"div"},()=>t.dataset(),i))}function ListboxRoot(n){let t;const i=`listbox-${createUniqueId()}`,s=mergeDefaultProps({id:i,selectionMode:"single",virtualized:!1},n),[Le,Oe]=splitProps(s,["ref","children","renderItem","renderSection","value","defaultValue","onChange","options","optionValue","optionTextValue","optionDisabled","optionGroupChildren","state","keyboardDelegate","autoFocus","selectionMode","shouldFocusWrap","shouldUseVirtualFocus","shouldSelectOnPressUp","shouldFocusOnHover","allowDuplicateSelectionEvents","disallowEmptySelection","selectionBehavior","selectOnFocus","disallowTypeAhead","allowsTabNavigation","virtualized","scrollToItem","scrollRef","onKeyDown","onMouseDown","onFocusIn","onFocusOut"]),Ae=createMemo(()=>Le.state?Le.state:createListState({selectedKeys:()=>Le.value,defaultSelectedKeys:()=>Le.defaultValue,onSelectionChange:Le.onChange,allowDuplicateSelectionEvents:()=>access(Le.allowDuplicateSelectionEvents),disallowEmptySelection:()=>access(Le.disallowEmptySelection),selectionBehavior:()=>access(Le.selectionBehavior),selectionMode:()=>access(Le.selectionMode),dataSource:()=>Le.options??[],getKey:()=>Le.optionValue,getTextValue:()=>Le.optionTextValue,getDisabled:()=>Le.optionDisabled,getSectionChildren:()=>Le.optionGroupChildren})),Ee=createSelectableList({selectionManager:()=>Ae().selectionManager(),collection:()=>Ae().collection(),autoFocus:()=>access(Le.autoFocus),shouldFocusWrap:()=>access(Le.shouldFocusWrap),keyboardDelegate:()=>Le.keyboardDelegate,disallowEmptySelection:()=>access(Le.disallowEmptySelection),selectOnFocus:()=>access(Le.selectOnFocus),disallowTypeAhead:()=>access(Le.disallowTypeAhead),shouldUseVirtualFocus:()=>access(Le.shouldUseVirtualFocus),allowsTabNavigation:()=>access(Le.allowsTabNavigation),isVirtualized:()=>Le.virtualized,scrollToKey:()=>Le.scrollToItem},()=>t,()=>Le.scrollRef?.()),$e={listState:Ae,generateId:createGenerateId(()=>Oe.id),shouldUseVirtualFocus:()=>s.shouldUseVirtualFocus,shouldSelectOnPressUp:()=>s.shouldSelectOnPressUp,shouldFocusOnHover:()=>s.shouldFocusOnHover,isVirtualized:()=>Le.virtualized};return createComponent(ListboxContext.Provider,{value:$e,get children(){return createComponent(Polymorphic,mergeProps({as:"ul",ref(Ie){var Fe=mergeRefs(He=>t=He,Le.ref);typeof Fe=="function"&&Fe(Ie)},role:"listbox",get tabIndex(){return Ee.tabIndex()},get"aria-multiselectable"(){return Ae().selectionManager().selectionMode()==="multiple"?!0:void 0},get onKeyDown(){return composeEventHandlers([Le.onKeyDown,Ee.onKeyDown])},get onMouseDown(){return composeEventHandlers([Le.onMouseDown,Ee.onMouseDown])},get onFocusIn(){return composeEventHandlers([Le.onFocusIn,Ee.onFocusIn])},get onFocusOut(){return composeEventHandlers([Le.onFocusOut,Ee.onFocusOut])}},Oe,{get children(){return createComponent(Show,{get when(){return!Le.virtualized},get fallback(){return Le.children?.(Ae().collection)},get children(){return createComponent(Key,{get each(){return[...Ae().collection()]},by:"key",children:Ie=>createComponent(Switch,{get children(){return[createComponent(Match,{get when(){return Ie().type==="section"},get children(){return Le.renderSection?.(Ie())}}),createComponent(Match,{get when(){return Ie().type==="item"},get children(){return Le.renderItem?.(Ie())}})]}})})}})}}))}})}function ListboxSection(n){return createComponent(Polymorphic,mergeProps({as:"li",role:"presentation"},n))}var Listbox=Object.assign(ListboxRoot,{Item:ListboxItem,ItemDescription:ListboxItemDescription,ItemIndicator:ListboxItemIndicator,ItemLabel:ListboxItemLabel,Section:ListboxSection});const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=n=>({x:n,y:n}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(n,t,i){return max(n,min(t,i))}function evaluate(n,t){return typeof n=="function"?n(t):n}function getSide(n){return n.split("-")[0]}function getAlignment(n){return n.split("-")[1]}function getOppositeAxis(n){return n==="x"?"y":"x"}function getAxisLength(n){return n==="y"?"height":"width"}function getSideAxis(n){return["top","bottom"].includes(getSide(n))?"y":"x"}function getAlignmentAxis(n){return getOppositeAxis(getSideAxis(n))}function getAlignmentSides(n,t,i){i===void 0&&(i=!1);const s=getAlignment(n),Le=getAlignmentAxis(n),Oe=getAxisLength(Le);let Ae=Le==="x"?s===(i?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[Oe]>t.floating[Oe]&&(Ae=getOppositePlacement(Ae)),[Ae,getOppositePlacement(Ae)]}function getExpandedPlacements(n){const t=getOppositePlacement(n);return[getOppositeAlignmentPlacement(n),t,getOppositeAlignmentPlacement(t)]}function getOppositeAlignmentPlacement(n){return n.replace(/start|end/g,t=>oppositeAlignmentMap[t])}function getSideList(n,t,i){const s=["left","right"],Le=["right","left"],Oe=["top","bottom"],Ae=["bottom","top"];switch(n){case"top":case"bottom":return i?t?Le:s:t?s:Le;case"left":case"right":return t?Oe:Ae;default:return[]}}function getOppositeAxisPlacements(n,t,i,s){const Le=getAlignment(n);let Oe=getSideList(getSide(n),i==="start",s);return Le&&(Oe=Oe.map(Ae=>Ae+"-"+Le),t&&(Oe=Oe.concat(Oe.map(getOppositeAlignmentPlacement)))),Oe}function getOppositePlacement(n){return n.replace(/left|right|bottom|top/g,t=>oppositeSideMap[t])}function expandPaddingObject(n){return{top:0,right:0,bottom:0,left:0,...n}}function getPaddingObject(n){return typeof n!="number"?expandPaddingObject(n):{top:n,right:n,bottom:n,left:n}}function rectToClientRect(n){const{x:t,y:i,width:s,height:Le}=n;return{width:s,height:Le,top:i,left:t,right:t+s,bottom:i+Le,x:t,y:i}}function computeCoordsFromPlacement(n,t,i){let{reference:s,floating:Le}=n;const Oe=getSideAxis(t),Ae=getAlignmentAxis(t),Ee=getAxisLength(Ae),$e=getSide(t),Ie=Oe==="y",Fe=s.x+s.width/2-Le.width/2,He=s.y+s.height/2-Le.height/2,ze=s[Ee]/2-Le[Ee]/2;let je;switch($e){case"top":je={x:Fe,y:s.y-Le.height};break;case"bottom":je={x:Fe,y:s.y+s.height};break;case"right":je={x:s.x+s.width,y:He};break;case"left":je={x:s.x-Le.width,y:He};break;default:je={x:s.x,y:s.y}}switch(getAlignment(t)){case"start":je[Ae]-=ze*(i&&Ie?-1:1);break;case"end":je[Ae]+=ze*(i&&Ie?-1:1);break}return je}const computePosition$1=async(n,t,i)=>{const{placement:s="bottom",strategy:Le="absolute",middleware:Oe=[],platform:Ae}=i,Ee=Oe.filter(Boolean),$e=await(Ae.isRTL==null?void 0:Ae.isRTL(t));let Ie=await Ae.getElementRects({reference:n,floating:t,strategy:Le}),{x:Fe,y:He}=computeCoordsFromPlacement(Ie,s,$e),ze=s,je={},Ne=0;for(let Ke=0;Ke<Ee.length;Ke++){const{name:Be,fn:Ue}=Ee[Ke],{x:We,y:Ge,data:qe,reset:Xe}=await Ue({x:Fe,y:He,initialPlacement:s,placement:ze,strategy:Le,middlewareData:je,rects:Ie,platform:Ae,elements:{reference:n,floating:t}});Fe=We??Fe,He=Ge??He,je={...je,[Be]:{...je[Be],...qe}},Xe&&Ne<=50&&(Ne++,typeof Xe=="object"&&(Xe.placement&&(ze=Xe.placement),Xe.rects&&(Ie=Xe.rects===!0?await Ae.getElementRects({reference:n,floating:t,strategy:Le}):Xe.rects),{x:Fe,y:He}=computeCoordsFromPlacement(Ie,ze,$e)),Ke=-1)}return{x:Fe,y:He,placement:ze,strategy:Le,middlewareData:je}};async function detectOverflow(n,t){var i;t===void 0&&(t={});const{x:s,y:Le,platform:Oe,rects:Ae,elements:Ee,strategy:$e}=n,{boundary:Ie="clippingAncestors",rootBoundary:Fe="viewport",elementContext:He="floating",altBoundary:ze=!1,padding:je=0}=evaluate(t,n),Ne=getPaddingObject(je),Be=Ee[ze?He==="floating"?"reference":"floating":He],Ue=rectToClientRect(await Oe.getClippingRect({element:(i=await(Oe.isElement==null?void 0:Oe.isElement(Be)))==null||i?Be:Be.contextElement||await(Oe.getDocumentElement==null?void 0:Oe.getDocumentElement(Ee.floating)),boundary:Ie,rootBoundary:Fe,strategy:$e})),We=He==="floating"?{x:s,y:Le,width:Ae.floating.width,height:Ae.floating.height}:Ae.reference,Ge=await(Oe.getOffsetParent==null?void 0:Oe.getOffsetParent(Ee.floating)),qe=await(Oe.isElement==null?void 0:Oe.isElement(Ge))?await(Oe.getScale==null?void 0:Oe.getScale(Ge))||{x:1,y:1}:{x:1,y:1},Xe=rectToClientRect(Oe.convertOffsetParentRelativeRectToViewportRelativeRect?await Oe.convertOffsetParentRelativeRectToViewportRelativeRect({elements:Ee,rect:We,offsetParent:Ge,strategy:$e}):We);return{top:(Ue.top-Xe.top+Ne.top)/qe.y,bottom:(Xe.bottom-Ue.bottom+Ne.bottom)/qe.y,left:(Ue.left-Xe.left+Ne.left)/qe.x,right:(Xe.right-Ue.right+Ne.right)/qe.x}}const arrow$1=n=>({name:"arrow",options:n,async fn(t){const{x:i,y:s,placement:Le,rects:Oe,platform:Ae,elements:Ee,middlewareData:$e}=t,{element:Ie,padding:Fe=0}=evaluate(n,t)||{};if(Ie==null)return{};const He=getPaddingObject(Fe),ze={x:i,y:s},je=getAlignmentAxis(Le),Ne=getAxisLength(je),Ke=await Ae.getDimensions(Ie),Be=je==="y",Ue=Be?"top":"left",We=Be?"bottom":"right",Ge=Be?"clientHeight":"clientWidth",qe=Oe.reference[Ne]+Oe.reference[je]-ze[je]-Oe.floating[Ne],Xe=ze[je]-Oe.reference[je],Je=await(Ae.getOffsetParent==null?void 0:Ae.getOffsetParent(Ie));let Ze=Je?Je[Ge]:0;(!Ze||!await(Ae.isElement==null?void 0:Ae.isElement(Je)))&&(Ze=Ee.floating[Ge]||Oe.floating[Ne]);const Ye=qe/2-Xe/2,eo=Ze/2-Ke[Ne]/2-1,Qe=min(He[Ue],eo),io=min(He[We],eo),so=Qe,uo=Ze-Ke[Ne]-io,no=Ze/2-Ke[Ne]/2+Ye,ho=clamp(so,no,uo),lo=!$e.arrow&&getAlignment(Le)!=null&&no!==ho&&Oe.reference[Ne]/2-(no<so?Qe:io)-Ke[Ne]/2<0,ao=lo?no<so?no-so:no-uo:0;return{[je]:ze[je]+ao,data:{[je]:ho,centerOffset:no-ho-ao,...lo&&{alignmentOffset:ao}},reset:lo}}}),flip$1=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(t){var i,s;const{placement:Le,middlewareData:Oe,rects:Ae,initialPlacement:Ee,platform:$e,elements:Ie}=t,{mainAxis:Fe=!0,crossAxis:He=!0,fallbackPlacements:ze,fallbackStrategy:je="bestFit",fallbackAxisSideDirection:Ne="none",flipAlignment:Ke=!0,...Be}=evaluate(n,t);if((i=Oe.arrow)!=null&&i.alignmentOffset)return{};const Ue=getSide(Le),We=getSideAxis(Ee),Ge=getSide(Ee)===Ee,qe=await($e.isRTL==null?void 0:$e.isRTL(Ie.floating)),Xe=ze||(Ge||!Ke?[getOppositePlacement(Ee)]:getExpandedPlacements(Ee)),Je=Ne!=="none";!ze&&Je&&Xe.push(...getOppositeAxisPlacements(Ee,Ke,Ne,qe));const Ze=[Ee,...Xe],Ye=await detectOverflow(t,Be),eo=[];let Qe=((s=Oe.flip)==null?void 0:s.overflows)||[];if(Fe&&eo.push(Ye[Ue]),He){const no=getAlignmentSides(Le,Ae,qe);eo.push(Ye[no[0]],Ye[no[1]])}if(Qe=[...Qe,{placement:Le,overflows:eo}],!eo.every(no=>no<=0)){var io,so;const no=(((io=Oe.flip)==null?void 0:io.index)||0)+1,ho=Ze[no];if(ho)return{data:{index:no,overflows:Qe},reset:{placement:ho}};let lo=(so=Qe.filter(ao=>ao.overflows[0]<=0).sort((ao,oo)=>ao.overflows[1]-oo.overflows[1])[0])==null?void 0:so.placement;if(!lo)switch(je){case"bestFit":{var uo;const ao=(uo=Qe.filter(oo=>{if(Je){const co=getSideAxis(oo.placement);return co===We||co==="y"}return!0}).map(oo=>[oo.placement,oo.overflows.filter(co=>co>0).reduce((co,fo)=>co+fo,0)]).sort((oo,co)=>oo[1]-co[1])[0])==null?void 0:uo[0];ao&&(lo=ao);break}case"initialPlacement":lo=Ee;break}if(Le!==lo)return{reset:{placement:lo}}}return{}}}};function getSideOffsets(n,t){return{top:n.top-t.height,right:n.right-t.width,bottom:n.bottom-t.height,left:n.left-t.width}}function isAnySideFullyClipped(n){return sides.some(t=>n[t]>=0)}const hide$1=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(t){const{rects:i}=t,{strategy:s="referenceHidden",...Le}=evaluate(n,t);switch(s){case"referenceHidden":{const Oe=await detectOverflow(t,{...Le,elementContext:"reference"}),Ae=getSideOffsets(Oe,i.reference);return{data:{referenceHiddenOffsets:Ae,referenceHidden:isAnySideFullyClipped(Ae)}}}case"escaped":{const Oe=await detectOverflow(t,{...Le,altBoundary:!0}),Ae=getSideOffsets(Oe,i.floating);return{data:{escapedOffsets:Ae,escaped:isAnySideFullyClipped(Ae)}}}default:return{}}}}};async function convertValueToCoords(n,t){const{placement:i,platform:s,elements:Le}=n,Oe=await(s.isRTL==null?void 0:s.isRTL(Le.floating)),Ae=getSide(i),Ee=getAlignment(i),$e=getSideAxis(i)==="y",Ie=["left","top"].includes(Ae)?-1:1,Fe=Oe&&$e?-1:1,He=evaluate(t,n);let{mainAxis:ze,crossAxis:je,alignmentAxis:Ne}=typeof He=="number"?{mainAxis:He,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...He};return Ee&&typeof Ne=="number"&&(je=Ee==="end"?Ne*-1:Ne),$e?{x:je*Fe,y:ze*Ie}:{x:ze*Ie,y:je*Fe}}const offset$1=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(t){var i,s;const{x:Le,y:Oe,placement:Ae,middlewareData:Ee}=t,$e=await convertValueToCoords(t,n);return Ae===((i=Ee.offset)==null?void 0:i.placement)&&(s=Ee.arrow)!=null&&s.alignmentOffset?{}:{x:Le+$e.x,y:Oe+$e.y,data:{...$e,placement:Ae}}}}},shift$1=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(t){const{x:i,y:s,placement:Le}=t,{mainAxis:Oe=!0,crossAxis:Ae=!1,limiter:Ee={fn:Be=>{let{x:Ue,y:We}=Be;return{x:Ue,y:We}}},...$e}=evaluate(n,t),Ie={x:i,y:s},Fe=await detectOverflow(t,$e),He=getSideAxis(getSide(Le)),ze=getOppositeAxis(He);let je=Ie[ze],Ne=Ie[He];if(Oe){const Be=ze==="y"?"top":"left",Ue=ze==="y"?"bottom":"right",We=je+Fe[Be],Ge=je-Fe[Ue];je=clamp(We,je,Ge)}if(Ae){const Be=He==="y"?"top":"left",Ue=He==="y"?"bottom":"right",We=Ne+Fe[Be],Ge=Ne-Fe[Ue];Ne=clamp(We,Ne,Ge)}const Ke=Ee.fn({...t,[ze]:je,[He]:Ne});return{...Ke,data:{x:Ke.x-i,y:Ke.y-s}}}}},size$1=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(t){const{placement:i,rects:s,platform:Le,elements:Oe}=t,{apply:Ae=()=>{},...Ee}=evaluate(n,t),$e=await detectOverflow(t,Ee),Ie=getSide(i),Fe=getAlignment(i),He=getSideAxis(i)==="y",{width:ze,height:je}=s.floating;let Ne,Ke;Ie==="top"||Ie==="bottom"?(Ne=Ie,Ke=Fe===(await(Le.isRTL==null?void 0:Le.isRTL(Oe.floating))?"start":"end")?"left":"right"):(Ke=Ie,Ne=Fe==="end"?"top":"bottom");const Be=je-$e.top-$e.bottom,Ue=ze-$e.left-$e.right,We=min(je-$e[Ne],Be),Ge=min(ze-$e[Ke],Ue),qe=!t.middlewareData.shift;let Xe=We,Je=Ge;if(He?Je=Fe||qe?min(Ge,Ue):Ue:Xe=Fe||qe?min(We,Be):Be,qe&&!Fe){const Ye=max($e.left,0),eo=max($e.right,0),Qe=max($e.top,0),io=max($e.bottom,0);He?Je=ze-2*(Ye!==0||eo!==0?Ye+eo:max($e.left,$e.right)):Xe=je-2*(Qe!==0||io!==0?Qe+io:max($e.top,$e.bottom))}await Ae({...t,availableWidth:Je,availableHeight:Xe});const Ze=await Le.getDimensions(Oe.floating);return ze!==Ze.width||je!==Ze.height?{reset:{rects:!0}}:{}}}};function getNodeName(n){return isNode(n)?(n.nodeName||"").toLowerCase():"#document"}function getWindow(n){var t;return(n==null||(t=n.ownerDocument)==null?void 0:t.defaultView)||window}function getDocumentElement(n){var t;return(t=(isNode(n)?n.ownerDocument:n.document)||window.document)==null?void 0:t.documentElement}function isNode(n){return n instanceof Node||n instanceof getWindow(n).Node}function isElement(n){return n instanceof Element||n instanceof getWindow(n).Element}function isHTMLElement(n){return n instanceof HTMLElement||n instanceof getWindow(n).HTMLElement}function isShadowRoot(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof getWindow(n).ShadowRoot}function isOverflowElement(n){const{overflow:t,overflowX:i,overflowY:s,display:Le}=getComputedStyle$1(n);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!["inline","contents"].includes(Le)}function isTableElement(n){return["table","td","th"].includes(getNodeName(n))}function isTopLayer(n){return[":popover-open",":modal"].some(t=>{try{return n.matches(t)}catch{return!1}})}function isContainingBlock(n){const t=isWebKit(),i=isElement(n)?getComputedStyle$1(n):n;return i.transform!=="none"||i.perspective!=="none"||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(i.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(i.contain||"").includes(s))}function getContainingBlock(n){let t=getParentNode(n);for(;isHTMLElement(t)&&!isLastTraversableNode(t);){if(isContainingBlock(t))return t;if(isTopLayer(t))return null;t=getParentNode(t)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(n){return["html","body","#document"].includes(getNodeName(n))}function getComputedStyle$1(n){return getWindow(n).getComputedStyle(n)}function getNodeScroll(n){return isElement(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function getParentNode(n){if(getNodeName(n)==="html")return n;const t=n.assignedSlot||n.parentNode||isShadowRoot(n)&&n.host||getDocumentElement(n);return isShadowRoot(t)?t.host:t}function getNearestOverflowAncestor(n){const t=getParentNode(n);return isLastTraversableNode(t)?n.ownerDocument?n.ownerDocument.body:n.body:isHTMLElement(t)&&isOverflowElement(t)?t:getNearestOverflowAncestor(t)}function getOverflowAncestors(n,t,i){var s;t===void 0&&(t=[]),i===void 0&&(i=!0);const Le=getNearestOverflowAncestor(n),Oe=Le===((s=n.ownerDocument)==null?void 0:s.body),Ae=getWindow(Le);if(Oe){const Ee=getFrameElement(Ae);return t.concat(Ae,Ae.visualViewport||[],isOverflowElement(Le)?Le:[],Ee&&i?getOverflowAncestors(Ee):[])}return t.concat(Le,getOverflowAncestors(Le,[],i))}function getFrameElement(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function getCssDimensions(n){const t=getComputedStyle$1(n);let i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const Le=isHTMLElement(n),Oe=Le?n.offsetWidth:i,Ae=Le?n.offsetHeight:s,Ee=round(i)!==Oe||round(s)!==Ae;return Ee&&(i=Oe,s=Ae),{width:i,height:s,$:Ee}}function unwrapElement(n){return isElement(n)?n:n.contextElement}function getScale(n){const t=unwrapElement(n);if(!isHTMLElement(t))return createCoords(1);const i=t.getBoundingClientRect(),{width:s,height:Le,$:Oe}=getCssDimensions(t);let Ae=(Oe?round(i.width):i.width)/s,Ee=(Oe?round(i.height):i.height)/Le;return(!Ae||!Number.isFinite(Ae))&&(Ae=1),(!Ee||!Number.isFinite(Ee))&&(Ee=1),{x:Ae,y:Ee}}const noOffsets=createCoords(0);function getVisualOffsets(n){const t=getWindow(n);return!isWebKit()||!t.visualViewport?noOffsets:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function shouldAddVisualOffsets(n,t,i){return t===void 0&&(t=!1),!i||t&&i!==getWindow(n)?!1:t}function getBoundingClientRect(n,t,i,s){t===void 0&&(t=!1),i===void 0&&(i=!1);const Le=n.getBoundingClientRect(),Oe=unwrapElement(n);let Ae=createCoords(1);t&&(s?isElement(s)&&(Ae=getScale(s)):Ae=getScale(n));const Ee=shouldAddVisualOffsets(Oe,i,s)?getVisualOffsets(Oe):createCoords(0);let $e=(Le.left+Ee.x)/Ae.x,Ie=(Le.top+Ee.y)/Ae.y,Fe=Le.width/Ae.x,He=Le.height/Ae.y;if(Oe){const ze=getWindow(Oe),je=s&&isElement(s)?getWindow(s):s;let Ne=ze,Ke=getFrameElement(Ne);for(;Ke&&s&&je!==Ne;){const Be=getScale(Ke),Ue=Ke.getBoundingClientRect(),We=getComputedStyle$1(Ke),Ge=Ue.left+(Ke.clientLeft+parseFloat(We.paddingLeft))*Be.x,qe=Ue.top+(Ke.clientTop+parseFloat(We.paddingTop))*Be.y;$e*=Be.x,Ie*=Be.y,Fe*=Be.x,He*=Be.y,$e+=Ge,Ie+=qe,Ne=getWindow(Ke),Ke=getFrameElement(Ne)}}return rectToClientRect({width:Fe,height:He,x:$e,y:Ie})}function convertOffsetParentRelativeRectToViewportRelativeRect(n){let{elements:t,rect:i,offsetParent:s,strategy:Le}=n;const Oe=Le==="fixed",Ae=getDocumentElement(s),Ee=t?isTopLayer(t.floating):!1;if(s===Ae||Ee&&Oe)return i;let $e={scrollLeft:0,scrollTop:0},Ie=createCoords(1);const Fe=createCoords(0),He=isHTMLElement(s);if((He||!He&&!Oe)&&((getNodeName(s)!=="body"||isOverflowElement(Ae))&&($e=getNodeScroll(s)),isHTMLElement(s))){const ze=getBoundingClientRect(s);Ie=getScale(s),Fe.x=ze.x+s.clientLeft,Fe.y=ze.y+s.clientTop}return{width:i.width*Ie.x,height:i.height*Ie.y,x:i.x*Ie.x-$e.scrollLeft*Ie.x+Fe.x,y:i.y*Ie.y-$e.scrollTop*Ie.y+Fe.y}}function getClientRects(n){return Array.from(n.getClientRects())}function getWindowScrollBarX(n){return getBoundingClientRect(getDocumentElement(n)).left+getNodeScroll(n).scrollLeft}function getDocumentRect(n){const t=getDocumentElement(n),i=getNodeScroll(n),s=n.ownerDocument.body,Le=max(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),Oe=max(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let Ae=-i.scrollLeft+getWindowScrollBarX(n);const Ee=-i.scrollTop;return getComputedStyle$1(s).direction==="rtl"&&(Ae+=max(t.clientWidth,s.clientWidth)-Le),{width:Le,height:Oe,x:Ae,y:Ee}}function getViewportRect(n,t){const i=getWindow(n),s=getDocumentElement(n),Le=i.visualViewport;let Oe=s.clientWidth,Ae=s.clientHeight,Ee=0,$e=0;if(Le){Oe=Le.width,Ae=Le.height;const Ie=isWebKit();(!Ie||Ie&&t==="fixed")&&(Ee=Le.offsetLeft,$e=Le.offsetTop)}return{width:Oe,height:Ae,x:Ee,y:$e}}function getInnerBoundingClientRect(n,t){const i=getBoundingClientRect(n,!0,t==="fixed"),s=i.top+n.clientTop,Le=i.left+n.clientLeft,Oe=isHTMLElement(n)?getScale(n):createCoords(1),Ae=n.clientWidth*Oe.x,Ee=n.clientHeight*Oe.y,$e=Le*Oe.x,Ie=s*Oe.y;return{width:Ae,height:Ee,x:$e,y:Ie}}function getClientRectFromClippingAncestor(n,t,i){let s;if(t==="viewport")s=getViewportRect(n,i);else if(t==="document")s=getDocumentRect(getDocumentElement(n));else if(isElement(t))s=getInnerBoundingClientRect(t,i);else{const Le=getVisualOffsets(n);s={...t,x:t.x-Le.x,y:t.y-Le.y}}return rectToClientRect(s)}function hasFixedPositionAncestor(n,t){const i=getParentNode(n);return i===t||!isElement(i)||isLastTraversableNode(i)?!1:getComputedStyle$1(i).position==="fixed"||hasFixedPositionAncestor(i,t)}function getClippingElementAncestors(n,t){const i=t.get(n);if(i)return i;let s=getOverflowAncestors(n,[],!1).filter(Ee=>isElement(Ee)&&getNodeName(Ee)!=="body"),Le=null;const Oe=getComputedStyle$1(n).position==="fixed";let Ae=Oe?getParentNode(n):n;for(;isElement(Ae)&&!isLastTraversableNode(Ae);){const Ee=getComputedStyle$1(Ae),$e=isContainingBlock(Ae);!$e&&Ee.position==="fixed"&&(Le=null),(Oe?!$e&&!Le:!$e&&Ee.position==="static"&&!!Le&&["absolute","fixed"].includes(Le.position)||isOverflowElement(Ae)&&!$e&&hasFixedPositionAncestor(n,Ae))?s=s.filter(Fe=>Fe!==Ae):Le=Ee,Ae=getParentNode(Ae)}return t.set(n,s),s}function getClippingRect(n){let{element:t,boundary:i,rootBoundary:s,strategy:Le}=n;const Ae=[...i==="clippingAncestors"?isTopLayer(t)?[]:getClippingElementAncestors(t,this._c):[].concat(i),s],Ee=Ae[0],$e=Ae.reduce((Ie,Fe)=>{const He=getClientRectFromClippingAncestor(t,Fe,Le);return Ie.top=max(He.top,Ie.top),Ie.right=min(He.right,Ie.right),Ie.bottom=min(He.bottom,Ie.bottom),Ie.left=max(He.left,Ie.left),Ie},getClientRectFromClippingAncestor(t,Ee,Le));return{width:$e.right-$e.left,height:$e.bottom-$e.top,x:$e.left,y:$e.top}}function getDimensions(n){const{width:t,height:i}=getCssDimensions(n);return{width:t,height:i}}function getRectRelativeToOffsetParent(n,t,i){const s=isHTMLElement(t),Le=getDocumentElement(t),Oe=i==="fixed",Ae=getBoundingClientRect(n,!0,Oe,t);let Ee={scrollLeft:0,scrollTop:0};const $e=createCoords(0);if(s||!s&&!Oe)if((getNodeName(t)!=="body"||isOverflowElement(Le))&&(Ee=getNodeScroll(t)),s){const He=getBoundingClientRect(t,!0,Oe,t);$e.x=He.x+t.clientLeft,$e.y=He.y+t.clientTop}else Le&&($e.x=getWindowScrollBarX(Le));const Ie=Ae.left+Ee.scrollLeft-$e.x,Fe=Ae.top+Ee.scrollTop-$e.y;return{x:Ie,y:Fe,width:Ae.width,height:Ae.height}}function isStaticPositioned(n){return getComputedStyle$1(n).position==="static"}function getTrueOffsetParent(n,t){return!isHTMLElement(n)||getComputedStyle$1(n).position==="fixed"?null:t?t(n):n.offsetParent}function getOffsetParent(n,t){const i=getWindow(n);if(isTopLayer(n))return i;if(!isHTMLElement(n)){let Le=getParentNode(n);for(;Le&&!isLastTraversableNode(Le);){if(isElement(Le)&&!isStaticPositioned(Le))return Le;Le=getParentNode(Le)}return i}let s=getTrueOffsetParent(n,t);for(;s&&isTableElement(s)&&isStaticPositioned(s);)s=getTrueOffsetParent(s,t);return s&&isLastTraversableNode(s)&&isStaticPositioned(s)&&!isContainingBlock(s)?i:s||getContainingBlock(n)||i}const getElementRects=async function(n){const t=this.getOffsetParent||getOffsetParent,i=this.getDimensions,s=await i(n.floating);return{reference:getRectRelativeToOffsetParent(n.reference,await t(n.floating),n.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function isRTL(n){return getComputedStyle$1(n).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(n,t){let i=null,s;const Le=getDocumentElement(n);function Oe(){var Ee;clearTimeout(s),(Ee=i)==null||Ee.disconnect(),i=null}function Ae(Ee,$e){Ee===void 0&&(Ee=!1),$e===void 0&&($e=1),Oe();const{left:Ie,top:Fe,width:He,height:ze}=n.getBoundingClientRect();if(Ee||t(),!He||!ze)return;const je=floor(Fe),Ne=floor(Le.clientWidth-(Ie+He)),Ke=floor(Le.clientHeight-(Fe+ze)),Be=floor(Ie),We={rootMargin:-je+"px "+-Ne+"px "+-Ke+"px "+-Be+"px",threshold:max(0,min(1,$e))||1};let Ge=!0;function qe(Xe){const Je=Xe[0].intersectionRatio;if(Je!==$e){if(!Ge)return Ae();Je?Ae(!1,Je):s=setTimeout(()=>{Ae(!1,1e-7)},1e3)}Ge=!1}try{i=new IntersectionObserver(qe,{...We,root:Le.ownerDocument})}catch{i=new IntersectionObserver(qe,We)}i.observe(n)}return Ae(!0),Oe}function autoUpdate(n,t,i,s){s===void 0&&(s={});const{ancestorScroll:Le=!0,ancestorResize:Oe=!0,elementResize:Ae=typeof ResizeObserver=="function",layoutShift:Ee=typeof IntersectionObserver=="function",animationFrame:$e=!1}=s,Ie=unwrapElement(n),Fe=Le||Oe?[...Ie?getOverflowAncestors(Ie):[],...getOverflowAncestors(t)]:[];Fe.forEach(Ue=>{Le&&Ue.addEventListener("scroll",i,{passive:!0}),Oe&&Ue.addEventListener("resize",i)});const He=Ie&&Ee?observeMove(Ie,i):null;let ze=-1,je=null;Ae&&(je=new ResizeObserver(Ue=>{let[We]=Ue;We&&We.target===Ie&&je&&(je.unobserve(t),cancelAnimationFrame(ze),ze=requestAnimationFrame(()=>{var Ge;(Ge=je)==null||Ge.observe(t)})),i()}),Ie&&!$e&&je.observe(Ie),je.observe(t));let Ne,Ke=$e?getBoundingClientRect(n):null;$e&&Be();function Be(){const Ue=getBoundingClientRect(n);Ke&&(Ue.x!==Ke.x||Ue.y!==Ke.y||Ue.width!==Ke.width||Ue.height!==Ke.height)&&i(),Ke=Ue,Ne=requestAnimationFrame(Be)}return i(),()=>{var Ue;Fe.forEach(We=>{Le&&We.removeEventListener("scroll",i),Oe&&We.removeEventListener("resize",i)}),He?.(),(Ue=je)==null||Ue.disconnect(),je=null,$e&&cancelAnimationFrame(Ne)}}const offset=offset$1,shift=shift$1,flip=flip$1,size=size$1,hide=hide$1,arrow=arrow$1,computePosition=(n,t,i)=>{const s=new Map,Le={platform,...i},Oe={...Le.platform,_c:s};return computePosition$1(n,t,{...Le,platform:Oe})};var _tmpl$$5=template('<svg display=block viewBox="0 0 30 30"style=transform:scale(1.02)><g><path fill=none d=M23,27.8c1.1,1.2,3.4,2.2,5,2.2h2H0h2c1.7,0,3.9-1,5-2.2l6.6-7.2c0.7-0.8,2-0.8,2.7,0L23,27.8L23,27.8z></path><path stroke=none d=M23,27.8c1.1,1.2,3.4,2.2,5,2.2h2H0h2c1.7,0,3.9-1,5-2.2l6.6-7.2c0.7-0.8,2-0.8,2.7,0L23,27.8L23,27.8z>'),PopperContext=createContext();function usePopperContext(){const n=useContext(PopperContext);if(n===void 0)throw new Error("[kobalte]: `usePopperContext` must be used within a `Popper` component");return n}var DEFAULT_SIZE=30,HALF_DEFAULT_SIZE=DEFAULT_SIZE/2,ROTATION_DEG={top:180,right:-90,bottom:0,left:90};function PopperArrow(n){const t=usePopperContext(),i=mergeDefaultProps({size:DEFAULT_SIZE},n),[s,Le]=splitProps(i,["ref","style","size"]),Oe=()=>t.currentPlacement().split("-")[0],Ae=createComputedStyle(t.contentRef),Ee=()=>Ae()?.getPropertyValue("background-color")||"none",$e=()=>Ae()?.getPropertyValue(`border-${Oe()}-color`)||"none",Ie=()=>Ae()?.getPropertyValue(`border-${Oe()}-width`)||"0px",Fe=()=>Number.parseInt(Ie())*2*(DEFAULT_SIZE/s.size),He=()=>`rotate(${ROTATION_DEG[Oe()]} ${HALF_DEFAULT_SIZE} ${HALF_DEFAULT_SIZE}) translate(0 2)`;return createComponent(Polymorphic,mergeProps({as:"div",ref(ze){var je=mergeRefs(t.setArrowRef,s.ref);typeof je=="function"&&je(ze)},"aria-hidden":"true",get style(){return combineStyle({position:"absolute","font-size":`${s.size}px`,width:"1em",height:"1em","pointer-events":"none",fill:Ee(),stroke:$e(),"stroke-width":Fe()},s.style)}},Le,{get children(){var ze=_tmpl$$5(),je=ze.firstChild,Ne=je.firstChild;return Ne.nextSibling,createRenderEffect(()=>setAttribute(je,"transform",He())),ze}}))}function createComputedStyle(n){const[t,i]=createSignal();return createEffect(()=>{const s=n();s&&i(getWindow$1(s).getComputedStyle(s))}),t}function PopperPositioner(n){const t=usePopperContext(),[i,s]=splitProps(n,["ref","style"]);return createComponent(Polymorphic,mergeProps({as:"div",ref(Le){var Oe=mergeRefs(t.setPositionerRef,i.ref);typeof Oe=="function"&&Oe(Le)},"data-popper-positioner":"",get style(){return combineStyle({position:"absolute",top:0,left:0,"min-width":"max-content"},i.style)}},s))}function createDOMRect(n){const{x:t=0,y:i=0,width:s=0,height:Le=0}=n??{};if(typeof DOMRect=="function")return new DOMRect(t,i,s,Le);const Oe={x:t,y:i,width:s,height:Le,top:i,right:t+s,bottom:i+Le,left:t};return{...Oe,toJSON:()=>Oe}}function getAnchorElement(n,t){return{contextElement:n,getBoundingClientRect:()=>{const s=t(n);return s?createDOMRect(s):n?n.getBoundingClientRect():createDOMRect()}}}function isValidPlacement(n){return/^(?:top|bottom|left|right)(?:-(?:start|end))?$/.test(n)}var REVERSE_BASE_PLACEMENT={top:"bottom",right:"left",bottom:"top",left:"right"};function getTransformOrigin(n,t){const[i,s]=n.split("-"),Le=REVERSE_BASE_PLACEMENT[i];return s?i==="left"||i==="right"?`${Le} ${s==="start"?"top":"bottom"}`:s==="start"?`${Le} ${t==="rtl"?"right":"left"}`:`${Le} ${t==="rtl"?"left":"right"}`:`${Le} center`}function PopperRoot(n){const t=mergeDefaultProps({getAnchorRect:ze=>ze?.getBoundingClientRect(),placement:"bottom",gutter:0,shift:0,flip:!0,slide:!0,overlap:!1,sameWidth:!1,fitViewport:!1,hideWhenDetached:!1,detachedPadding:0,arrowPadding:4,overflowPadding:8},n),[i,s]=createSignal(),[Le,Oe]=createSignal(),[Ae,Ee]=createSignal(t.placement),$e=()=>getAnchorElement(t.anchorRef?.(),t.getAnchorRect),{direction:Ie}=useLocale();async function Fe(){const ze=$e(),je=i(),Ne=Le();if(!ze||!je)return;const Ke=(Ne?.clientHeight||0)/2,Be=typeof t.gutter=="number"?t.gutter+Ke:t.gutter??Ke;je.style.setProperty("--kb-popper-content-overflow-padding",`${t.overflowPadding}px`),ze.getBoundingClientRect();const Ue=[offset(({placement:Je})=>{const Ze=!!Je.split("-")[1];return{mainAxis:Be,crossAxis:Ze?void 0:t.shift,alignmentAxis:t.shift}})];if(t.flip!==!1){const Je=typeof t.flip=="string"?t.flip.split(" "):void 0;if(Je!==void 0&&!Je.every(isValidPlacement))throw new Error("`flip` expects a spaced-delimited list of placements");Ue.push(flip({padding:t.overflowPadding,fallbackPlacements:Je}))}(t.slide||t.overlap)&&Ue.push(shift({mainAxis:t.slide,crossAxis:t.overlap,padding:t.overflowPadding})),Ue.push(size({padding:t.overflowPadding,apply({availableWidth:Je,availableHeight:Ze,rects:Ye}){const eo=Math.round(Ye.reference.width);Je=Math.floor(Je),Ze=Math.floor(Ze),je.style.setProperty("--kb-popper-anchor-width",`${eo}px`),je.style.setProperty("--kb-popper-content-available-width",`${Je}px`),je.style.setProperty("--kb-popper-content-available-height",`${Ze}px`),t.sameWidth&&(je.style.width=`${eo}px`),t.fitViewport&&(je.style.maxWidth=`${Je}px`,je.style.maxHeight=`${Ze}px`)}})),t.hideWhenDetached&&Ue.push(hide({padding:t.detachedPadding})),Ne&&Ue.push(arrow({element:Ne,padding:t.arrowPadding}));const We=await computePosition(ze,je,{placement:t.placement,strategy:"absolute",middleware:Ue,platform:{...platform,isRTL:()=>Ie()==="rtl"}});if(Ee(We.placement),t.onCurrentPlacementChange?.(We.placement),!je)return;je.style.setProperty("--kb-popper-content-transform-origin",getTransformOrigin(We.placement,Ie()));const Ge=Math.round(We.x),qe=Math.round(We.y);let Xe;if(t.hideWhenDetached&&(Xe=We.middlewareData.hide?.referenceHidden?"hidden":"visible"),Object.assign(je.style,{top:"0",left:"0",transform:`translate3d(${Ge}px, ${qe}px, 0)`,visibility:Xe}),Ne&&We.middlewareData.arrow){const{x:Je,y:Ze}=We.middlewareData.arrow,Ye=We.placement.split("-")[0];Object.assign(Ne.style,{left:Je!=null?`${Je}px`:"",top:Ze!=null?`${Ze}px`:"",[Ye]:"100%"})}}createEffect(()=>{const ze=$e(),je=i();if(!ze||!je)return;const Ne=autoUpdate(ze,je,Fe,{elementResize:typeof ResizeObserver=="function"});onCleanup(Ne)}),createEffect(()=>{const ze=i(),je=t.contentRef?.();!ze||!je||queueMicrotask(()=>{ze.style.zIndex=getComputedStyle(je).zIndex})});const He={currentPlacement:Ae,contentRef:()=>t.contentRef?.(),setPositionerRef:s,setArrowRef:Oe};return createComponent(PopperContext.Provider,{value:He,get children(){return t.children}})}var Popper=Object.assign(PopperRoot,{Arrow:PopperArrow,Context:PopperContext,usePopperContext,Positioner:PopperPositioner}),AUTOFOCUS_ON_MOUNT_EVENT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT_EVENT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS={bubbles:!1,cancelable:!0},focusScopeStack={stack:[],active(){return this.stack[0]},add(n){n!==this.active()&&this.active()?.pause(),this.stack=removeItemFromArray(this.stack,n),this.stack.unshift(n)},remove(n){this.stack=removeItemFromArray(this.stack,n),this.active()?.resume()}};function createFocusScope(n,t){const[i,s]=createSignal(!1),Le={pause(){s(!0)},resume(){s(!1)}};let Oe=null;const Ae=Ne=>n.onMountAutoFocus?.(Ne),Ee=Ne=>n.onUnmountAutoFocus?.(Ne),$e=()=>getDocument(t()),Ie=()=>{const Ne=$e().createElement("span");return Ne.setAttribute("data-focus-trap",""),Ne.tabIndex=0,Object.assign(Ne.style,visuallyHiddenStyles),Ne},Fe=()=>{const Ne=t();return Ne?getAllTabbableIn(Ne,!0).filter(Ke=>!Ke.hasAttribute("data-focus-trap")):[]},He=()=>{const Ne=Fe();return Ne.length>0?Ne[0]:null},ze=()=>{const Ne=Fe();return Ne.length>0?Ne[Ne.length-1]:null},je=()=>{const Ne=t();if(!Ne)return!1;const Ke=getActiveElement(Ne);return!Ke||contains$1(Ne,Ke)?!1:isFocusable(Ke)};createEffect(()=>{const Ne=t();if(!Ne)return;focusScopeStack.add(Le);const Ke=getActiveElement(Ne);if(!contains$1(Ne,Ke)){const Ue=new CustomEvent(AUTOFOCUS_ON_MOUNT_EVENT,EVENT_OPTIONS);Ne.addEventListener(AUTOFOCUS_ON_MOUNT_EVENT,Ae),Ne.dispatchEvent(Ue),Ue.defaultPrevented||setTimeout(()=>{focusWithoutScrolling(He()),getActiveElement(Ne)===Ke&&focusWithoutScrolling(Ne)},0)}onCleanup(()=>{Ne.removeEventListener(AUTOFOCUS_ON_MOUNT_EVENT,Ae),setTimeout(()=>{const Ue=new CustomEvent(AUTOFOCUS_ON_UNMOUNT_EVENT,EVENT_OPTIONS);je()&&Ue.preventDefault(),Ne.addEventListener(AUTOFOCUS_ON_UNMOUNT_EVENT,Ee),Ne.dispatchEvent(Ue),Ue.defaultPrevented||focusWithoutScrolling(Ke??$e().body),Ne.removeEventListener(AUTOFOCUS_ON_UNMOUNT_EVENT,Ee),focusScopeStack.remove(Le)},0)})}),createEffect(()=>{const Ne=t();if(!Ne||!access(n.trapFocus)||i())return;const Ke=Ue=>{const We=Ue.target;We?.closest(`[${DATA_TOP_LAYER_ATTR}]`)||(contains$1(Ne,We)?Oe=We:focusWithoutScrolling(Oe))},Be=Ue=>{const Ge=Ue.relatedTarget??getActiveElement(Ne);Ge?.closest(`[${DATA_TOP_LAYER_ATTR}]`)||contains$1(Ne,Ge)||focusWithoutScrolling(Oe)};$e().addEventListener("focusin",Ke),$e().addEventListener("focusout",Be),onCleanup(()=>{$e().removeEventListener("focusin",Ke),$e().removeEventListener("focusout",Be)})}),createEffect(()=>{const Ne=t();if(!Ne||!access(n.trapFocus)||i())return;const Ke=Ie();Ne.insertAdjacentElement("afterbegin",Ke);const Be=Ie();Ne.insertAdjacentElement("beforeend",Be);function Ue(Ge){const qe=He(),Xe=ze();Ge.relatedTarget===qe?focusWithoutScrolling(Xe):focusWithoutScrolling(qe)}Ke.addEventListener("focusin",Ue),Be.addEventListener("focusin",Ue);const We=new MutationObserver(Ge=>{for(const qe of Ge)qe.previousSibling===Be&&(Be.remove(),Ne.insertAdjacentElement("beforeend",Be)),qe.nextSibling===Ke&&(Ke.remove(),Ne.insertAdjacentElement("afterbegin",Ke))});We.observe(Ne,{childList:!0,subtree:!1}),onCleanup(()=>{Ke.removeEventListener("focusin",Ue),Be.removeEventListener("focusin",Ue),Ke.remove(),Be.remove(),We.disconnect()})})}function createHideOutside(n){createEffect(()=>{access(n.isDisabled)||onCleanup(ariaHideOutside(access(n.targets),access(n.root)))})}var refCountMap=new WeakMap,observerStack=[];function ariaHideOutside(n,t=document.body){const i=new Set(n),s=new Set,Le=$e=>{for(const ze of $e.querySelectorAll(`[${DATA_LIVE_ANNOUNCER_ATTR}], [${DATA_TOP_LAYER_ATTR}]`))i.add(ze);const Ie=ze=>{if(i.has(ze)||ze.parentElement&&s.has(ze.parentElement)&&ze.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(const je of i)if(ze.contains(je))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},Fe=document.createTreeWalker($e,NodeFilter.SHOW_ELEMENT,{acceptNode:Ie}),He=Ie($e);if(He===NodeFilter.FILTER_ACCEPT&&Oe($e),He!==NodeFilter.FILTER_REJECT){let ze=Fe.nextNode();for(;ze!=null;)Oe(ze),ze=Fe.nextNode()}},Oe=$e=>{const Ie=refCountMap.get($e)??0;$e.getAttribute("aria-hidden")==="true"&&Ie===0||(Ie===0&&$e.setAttribute("aria-hidden","true"),s.add($e),refCountMap.set($e,Ie+1))};observerStack.length&&observerStack[observerStack.length-1].disconnect(),Le(t);const Ae=new MutationObserver($e=>{for(const Ie of $e)if(!(Ie.type!=="childList"||Ie.addedNodes.length===0)&&![...i,...s].some(Fe=>Fe.contains(Ie.target))){for(const Fe of Ie.removedNodes)Fe instanceof Element&&(i.delete(Fe),s.delete(Fe));for(const Fe of Ie.addedNodes)(Fe instanceof HTMLElement||Fe instanceof SVGElement)&&(Fe.dataset.liveAnnouncer==="true"||Fe.dataset.reactAriaTopLayer==="true")?i.add(Fe):Fe instanceof Element&&Le(Fe)}});Ae.observe(t,{childList:!0,subtree:!0});const Ee={observe(){Ae.observe(t,{childList:!0,subtree:!0})},disconnect(){Ae.disconnect()}};return observerStack.push(Ee),()=>{Ae.disconnect();for(const $e of s){const Ie=refCountMap.get($e);if(Ie==null)return;Ie===1?($e.removeAttribute("aria-hidden"),refCountMap.delete($e)):refCountMap.set($e,Ie-1)}Ee===observerStack[observerStack.length-1]?(observerStack.pop(),observerStack.length&&observerStack[observerStack.length-1].observe()):observerStack.splice(observerStack.indexOf(Ee),1)}}function createEscapeKeyDown(n){const t=i=>{i.key===EventKey.Escape&&n.onEscapeKeyDown?.(i)};createEffect(()=>{if(access(n.isDisabled))return;const i=n.ownerDocument?.()??getDocument();i.addEventListener("keydown",t),onCleanup(()=>{i.removeEventListener("keydown",t)})})}var POINTER_DOWN_OUTSIDE_EVENT="interactOutside.pointerDownOutside",FOCUS_OUTSIDE_EVENT="interactOutside.focusOutside";function createInteractOutside(n,t){let i,s=noop;const Le=()=>getDocument(t()),Oe=He=>n.onPointerDownOutside?.(He),Ae=He=>n.onFocusOutside?.(He),Ee=He=>n.onInteractOutside?.(He),$e=He=>{const ze=He.target;return!(ze instanceof HTMLElement)||ze.closest(`[${DATA_TOP_LAYER_ATTR}]`)||!contains$1(Le(),ze)||contains$1(t(),ze)?!1:!n.shouldExcludeElement?.(ze)},Ie=He=>{function ze(){const je=t(),Ne=He.target;if(!je||!Ne||!$e(He))return;const Ke=composeEventHandlers([Oe,Ee]);Ne.addEventListener(POINTER_DOWN_OUTSIDE_EVENT,Ke,{once:!0});const Be=new CustomEvent(POINTER_DOWN_OUTSIDE_EVENT,{bubbles:!1,cancelable:!0,detail:{originalEvent:He,isContextMenu:He.button===2||isCtrlKey(He)&&He.button===0}});Ne.dispatchEvent(Be)}He.pointerType==="touch"?(Le().removeEventListener("click",ze),s=ze,Le().addEventListener("click",ze,{once:!0})):ze()},Fe=He=>{const ze=t(),je=He.target;if(!ze||!je||!$e(He))return;const Ne=composeEventHandlers([Ae,Ee]);je.addEventListener(FOCUS_OUTSIDE_EVENT,Ne,{once:!0});const Ke=new CustomEvent(FOCUS_OUTSIDE_EVENT,{bubbles:!1,cancelable:!0,detail:{originalEvent:He,isContextMenu:!1}});je.dispatchEvent(Ke)};createEffect(()=>{access(n.isDisabled)||(i=window.setTimeout(()=>{Le().addEventListener("pointerdown",Ie,!0)},0),Le().addEventListener("focusin",Fe,!0),onCleanup(()=>{window.clearTimeout(i),Le().removeEventListener("click",s),Le().removeEventListener("pointerdown",Ie,!0),Le().removeEventListener("focusin",Fe,!0)}))})}var DismissableLayerContext=createContext();function useOptionalDismissableLayerContext(){return useContext(DismissableLayerContext)}function DismissableLayer(n){let t;const i=useOptionalDismissableLayerContext(),[s,Le]=splitProps(n,["ref","disableOutsidePointerEvents","excludedElements","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","bypassTopMostLayerCheck"]),Oe=new Set([]),Ae=He=>{Oe.add(He);const ze=i?.registerNestedLayer(He);return()=>{Oe.delete(He),ze?.()}};createInteractOutside({shouldExcludeElement:He=>t?s.excludedElements?.some(ze=>contains$1(ze(),He))||[...Oe].some(ze=>contains$1(ze,He)):!1,onPointerDownOutside:He=>{!t||layerStack.isBelowPointerBlockingLayer(t)||!s.bypassTopMostLayerCheck&&!layerStack.isTopMostLayer(t)||(s.onPointerDownOutside?.(He),s.onInteractOutside?.(He),He.defaultPrevented||s.onDismiss?.())},onFocusOutside:He=>{s.onFocusOutside?.(He),s.onInteractOutside?.(He),He.defaultPrevented||s.onDismiss?.()}},()=>t),createEscapeKeyDown({ownerDocument:()=>getDocument(t),onEscapeKeyDown:He=>{!t||!layerStack.isTopMostLayer(t)||(s.onEscapeKeyDown?.(He),!He.defaultPrevented&&s.onDismiss&&(He.preventDefault(),s.onDismiss()))}}),onMount(()=>{if(!t)return;layerStack.addLayer({node:t,isPointerBlocking:s.disableOutsidePointerEvents,dismiss:s.onDismiss});const He=i?.registerNestedLayer(t);layerStack.assignPointerEventToLayers(),layerStack.disableBodyPointerEvents(t),onCleanup(()=>{t&&(layerStack.removeLayer(t),He?.(),layerStack.assignPointerEventToLayers(),layerStack.restoreBodyPointerEvents(t))})}),createEffect(on$1([()=>t,()=>s.disableOutsidePointerEvents],([He,ze])=>{if(!He)return;const je=layerStack.find(He);je&&je.isPointerBlocking!==ze&&(je.isPointerBlocking=ze,layerStack.assignPointerEventToLayers()),ze&&layerStack.disableBodyPointerEvents(He),onCleanup(()=>{layerStack.restoreBodyPointerEvents(He)})},{defer:!0}));const Fe={registerNestedLayer:Ae};return createComponent(DismissableLayerContext.Provider,{value:Fe,get children(){return createComponent(Polymorphic,mergeProps({as:"div",ref(He){var ze=mergeRefs(je=>t=je,s.ref);typeof ze=="function"&&ze(He)}},Le))}})}function createDisclosureState(n={}){const[t,i]=createControllableBooleanSignal({value:()=>access(n.open),defaultValue:()=>!!access(n.defaultOpen),onChange:Ae=>n.onOpenChange?.(Ae)}),s=()=>{i(!0)},Le=()=>{i(!1)};return{isOpen:t,setIsOpen:i,open:s,close:Le,toggle:()=>{t()?Le():s()}}}var contains=(n,t)=>{if(n.contains(t))return!0;let i=t;for(;i;){if(i===n)return!0;i=i._$host??i.parentElement}return!1},activeStyles=new Map,createStyle=n=>{createEffect(()=>{const t=access$1(n.style)??{},i=access$1(n.properties)??[],s={};for(const Oe in t)s[Oe]=n.element.style[Oe];const Le=activeStyles.get(n.key);Le?Le.activeCount++:activeStyles.set(n.key,{activeCount:1,originalStyles:s,properties:i.map(Oe=>Oe.key)}),Object.assign(n.element.style,n.style);for(const Oe of i)n.element.style.setProperty(Oe.key,Oe.value);onCleanup(()=>{const Oe=activeStyles.get(n.key);if(Oe){if(Oe.activeCount!==1){Oe.activeCount--;return}activeStyles.delete(n.key);for(const[Ae,Ee]of Object.entries(Oe.originalStyles))n.element.style[Ae]=Ee;for(const Ae of Oe.properties)n.element.style.removeProperty(Ae);n.element.style.length===0&&n.element.removeAttribute("style"),n.cleanup?.()}})})},style_default=createStyle,getScrollDimensions=(n,t)=>{switch(t){case"x":return[n.clientWidth,n.scrollLeft,n.scrollWidth];case"y":return[n.clientHeight,n.scrollTop,n.scrollHeight]}},isScrollContainer=(n,t)=>{const i=getComputedStyle(n),s=t==="x"?i.overflowX:i.overflowY;return s==="auto"||s==="scroll"||n.tagName==="HTML"&&s==="visible"},getScrollAtLocation=(n,t,i)=>{const s=t==="x"&&window.getComputedStyle(n).direction==="rtl"?-1:1;let Le=n,Oe=0,Ae=0,Ee=!1;do{const[$e,Ie,Fe]=getScrollDimensions(Le,t),He=Fe-$e-s*Ie;(Ie!==0||He!==0)&&isScrollContainer(Le,t)&&(Oe+=He,Ae+=Ie),Le===(i??document.documentElement)?Ee=!0:Le=Le._$host??Le.parentElement}while(Le&&!Ee);return[Oe,Ae]},[preventScrollStack,setPreventScrollStack]=createSignal([]),isActive=n=>preventScrollStack().indexOf(n)===preventScrollStack().length-1,createPreventScroll=n=>{const t=mergeProps({element:null,enabled:!0,hideScrollbar:!0,preventScrollbarShift:!0,preventScrollbarShiftMode:"padding",restoreScrollPosition:!0,allowPinchZoom:!1},n),i=createUniqueId();let s=[0,0],Le=null,Oe=null;createEffect(()=>{access$1(t.enabled)&&(setPreventScrollStack(Ie=>[...Ie,i]),onCleanup(()=>{setPreventScrollStack(Ie=>Ie.filter(Fe=>Fe!==i))}))}),createEffect(()=>{if(!access$1(t.enabled)||!access$1(t.hideScrollbar))return;const{body:Ie}=document,Fe=window.innerWidth-Ie.offsetWidth;if(access$1(t.preventScrollbarShift)){const He={overflow:"hidden"},ze=[];Fe>0&&(access$1(t.preventScrollbarShiftMode)==="padding"?He.paddingRight=`calc(${window.getComputedStyle(Ie).paddingRight} + ${Fe}px)`:He.marginRight=`calc(${window.getComputedStyle(Ie).marginRight} + ${Fe}px)`,ze.push({key:"--scrollbar-width",value:`${Fe}px`}));const je=window.scrollY,Ne=window.scrollX;style_default({key:"prevent-scroll",element:Ie,style:He,properties:ze,cleanup:()=>{access$1(t.restoreScrollPosition)&&Fe>0&&window.scrollTo(Ne,je)}})}else style_default({key:"prevent-scroll",element:Ie,style:{overflow:"hidden"}})}),createEffect(()=>{!isActive(i)||!access$1(t.enabled)||(document.addEventListener("wheel",Ee,{passive:!1}),document.addEventListener("touchstart",Ae,{passive:!1}),document.addEventListener("touchmove",$e,{passive:!1}),onCleanup(()=>{document.removeEventListener("wheel",Ee),document.removeEventListener("touchstart",Ae),document.removeEventListener("touchmove",$e)}))});const Ae=Ie=>{s=getTouchXY(Ie),Le=null,Oe=null},Ee=Ie=>{const Fe=Ie.target,He=access$1(t.element),ze=getDeltaXY(Ie),je=Math.abs(ze[0])>Math.abs(ze[1])?"x":"y",Ne=je==="x"?ze[0]:ze[1],Ke=wouldScroll(Fe,je,Ne,He);let Be;He&&contains(He,Fe)?Be=!Ke:Be=!0,Be&&Ie.cancelable&&Ie.preventDefault()},$e=Ie=>{const Fe=access$1(t.element),He=Ie.target;let ze;if(Ie.touches.length===2)ze=!access$1(t.allowPinchZoom);else{if(Le==null||Oe===null){const je=getTouchXY(Ie).map((Ke,Be)=>s[Be]-Ke),Ne=Math.abs(je[0])>Math.abs(je[1])?"x":"y";Le=Ne,Oe=Ne==="x"?je[0]:je[1]}if(He.type==="range")ze=!1;else{const je=wouldScroll(He,Le,Oe,Fe);Fe&&contains(Fe,He)?ze=!je:ze=!0}}ze&&Ie.cancelable&&Ie.preventDefault()}},getDeltaXY=n=>[n.deltaX,n.deltaY],getTouchXY=n=>n.changedTouches[0]?[n.changedTouches[0].clientX,n.changedTouches[0].clientY]:[0,0],wouldScroll=(n,t,i,s)=>{const Le=s!==null&&contains(s,n),[Oe,Ae]=getScrollAtLocation(n,t,Le?s:void 0);return!(i>0&&Math.abs(Oe)<=1||i<0&&Math.abs(Ae)<1)},preventScroll_default=createPreventScroll,src_default=preventScroll_default,select_exports={};__export(select_exports,{Arrow:()=>PopperArrow,Content:()=>SelectContent$1,Description:()=>FormControlDescription,ErrorMessage:()=>FormControlErrorMessage,HiddenSelect:()=>SelectHiddenSelect,Icon:()=>SelectIcon,Item:()=>ListboxItem,ItemDescription:()=>ListboxItemDescription,ItemIndicator:()=>ListboxItemIndicator,ItemLabel:()=>ListboxItemLabel,Label:()=>SelectLabel,Listbox:()=>SelectListbox,Portal:()=>SelectPortal,Root:()=>SelectRoot,Section:()=>ListboxSection,Select:()=>Select$1,Trigger:()=>SelectTrigger$1,Value:()=>SelectValue$1});var SelectContext=createContext();function useSelectContext(){const n=useContext(SelectContext);if(n===void 0)throw new Error("[kobalte]: `useSelectContext` must be used within a `Select` component");return n}function SelectContent$1(n){let t;const i=useSelectContext(),[s,Le]=splitProps(n,["ref","style","onCloseAutoFocus","onFocusOutside"]),Oe=Ee=>{i.close()},Ae=Ee=>{s.onFocusOutside?.(Ee),i.isOpen()&&i.isModal()&&Ee.preventDefault()};return createHideOutside({isDisabled:()=>!(i.isOpen()&&i.isModal()),targets:()=>t?[t]:[]}),src_default({element:()=>t??null,enabled:()=>i.contentPresent()&&i.preventScroll()}),createFocusScope({trapFocus:()=>i.isOpen()&&i.isModal(),onMountAutoFocus:Ee=>{Ee.preventDefault()},onUnmountAutoFocus:Ee=>{s.onCloseAutoFocus?.(Ee),Ee.defaultPrevented||(focusWithoutScrolling(i.triggerRef()),Ee.preventDefault())}},()=>t),createComponent(Show,{get when(){return i.contentPresent()},get children(){return createComponent(Popper.Positioner,{get children(){return createComponent(DismissableLayer,mergeProps({ref(Ee){var $e=mergeRefs(Ie=>{i.setContentRef(Ie),t=Ie},s.ref);typeof $e=="function"&&$e(Ee)},get disableOutsidePointerEvents(){return createMemo(()=>!!i.isModal())()&&i.isOpen()},get excludedElements(){return[i.triggerRef]},get style(){return combineStyle({"--kb-select-content-transform-origin":"var(--kb-popper-content-transform-origin)",position:"relative"},s.style)},onEscapeKeyDown:Oe,onFocusOutside:Ae,get onDismiss(){return i.close}},()=>i.dataset(),Le))}})}})}function SelectHiddenSelect(n){const t=useSelectContext();return createComponent(HiddenSelectBase,mergeProps({get collection(){return t.listState().collection()},get selectionManager(){return t.listState().selectionManager()},get isOpen(){return t.isOpen()},get isMultiple(){return t.isMultiple()},get isVirtualized(){return t.isVirtualized()},focusTrigger:()=>t.triggerRef()?.focus()},n))}function SelectIcon(n){const t=useSelectContext(),i=mergeDefaultProps({children:"▼"},n);return createComponent(Polymorphic,mergeProps({as:"span","aria-hidden":"true"},()=>t.dataset(),i))}function SelectLabel(n){const t=useSelectContext(),[i,s]=splitProps(n,["onClick"]);return createComponent(FormControlLabel,mergeProps({as:"span",onClick:Oe=>{callHandler(Oe,i.onClick),t.isDisabled()||t.triggerRef()?.focus()}},s))}function SelectListbox(n){const t=useSelectContext(),i=mergeDefaultProps({id:t.generateId("listbox")},n),[s,Le]=splitProps(i,["ref","id","onKeyDown"]);return createEffect(()=>onCleanup(t.registerListboxId(s.id))),createComponent(ListboxRoot,mergeProps({ref(Ae){var Ee=mergeRefs(t.setListboxRef,s.ref);typeof Ee=="function"&&Ee(Ae)},get id(){return s.id},get state(){return t.listState()},get virtualized(){return t.isVirtualized()},get autoFocus(){return t.autoFocus()},shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,get shouldFocusWrap(){return t.shouldFocusWrap()},get disallowTypeAhead(){return t.disallowTypeAhead()},get"aria-labelledby"(){return t.listboxAriaLabelledBy()},get renderItem(){return t.renderItem},get renderSection(){return t.renderSection},onKeyDown:Ae=>{callHandler(Ae,s.onKeyDown),Ae.key==="Escape"&&Ae.preventDefault()}},Le))}function SelectPortal(n){const t=useSelectContext();return createComponent(Show,{get when(){return t.contentPresent()},get children(){return createComponent(Portal,n)}})}function SelectBase(n){const t=`select-${createUniqueId()}`,i=mergeDefaultProps({id:t,selectionMode:"single",disallowEmptySelection:!1,closeOnSelection:n.selectionMode==="single",allowDuplicateSelectionEvents:!0,gutter:8,sameWidth:!0,modal:!1},n),[s,Le,Oe,Ae]=splitProps(i,["itemComponent","sectionComponent","open","defaultOpen","onOpenChange","value","defaultValue","onChange","placeholder","options","optionValue","optionTextValue","optionDisabled","optionGroupChildren","keyboardDelegate","allowDuplicateSelectionEvents","disallowEmptySelection","closeOnSelection","disallowTypeAhead","shouldFocusWrap","selectionBehavior","selectionMode","virtualized","modal","preventScroll","forceMount"],["getAnchorRect","placement","gutter","shift","flip","slide","overlap","sameWidth","fitViewport","hideWhenDetached","detachedPadding","arrowPadding","overflowPadding"],FORM_CONTROL_PROP_NAMES),[Ee,$e]=createSignal(),[Ie,Fe]=createSignal(),[He,ze]=createSignal(),[je,Ne]=createSignal(),[Ke,Be]=createSignal(),[Ue,We]=createSignal(),[Ge,qe]=createSignal(),[Xe,Je]=createSignal(!0),Ze=to=>{const ro=s.optionValue;return ro==null?String(to):String(isFunction(ro)?ro(to):to[ro])},Ye=createMemo(()=>{const to=s.optionGroupChildren;return to==null?s.options:s.options.flatMap(ro=>ro[to]??ro)}),eo=createMemo(()=>Ye().map(to=>Ze(to))),Qe=to=>[...to].map(ro=>Ye().find(po=>Ze(po)===ro)).filter(ro=>ro!=null),io=createDisclosureState({open:()=>s.open,defaultOpen:()=>s.defaultOpen,onOpenChange:to=>s.onOpenChange?.(to)}),so=createListState({selectedKeys:()=>s.value!=null?s.value.map(Ze):s.value,defaultSelectedKeys:()=>s.defaultValue!=null?s.defaultValue.map(Ze):s.defaultValue,onSelectionChange:to=>{s.onChange?.(Qe(to)),s.closeOnSelection&&oo()},allowDuplicateSelectionEvents:()=>access(s.allowDuplicateSelectionEvents),disallowEmptySelection:()=>access(s.disallowEmptySelection),selectionBehavior:()=>access(s.selectionBehavior),selectionMode:()=>s.selectionMode,dataSource:()=>s.options??[],getKey:()=>s.optionValue,getTextValue:()=>s.optionTextValue,getDisabled:()=>s.optionDisabled,getSectionChildren:()=>s.optionGroupChildren}),uo=createMemo(()=>Qe(so.selectionManager().selectedKeys())),no=to=>{so.selectionManager().toggleSelection(Ze(to))},{present:ho}=src_default$1({show:()=>s.forceMount||io.isOpen(),element:()=>Ke()??null}),lo=()=>{const to=Ue();to&&focusWithoutScrolling(to)},ao=to=>{if(s.options.length<=0)return;Je(to),io.open();let ro=so.selectionManager().firstSelectedKey();ro==null&&(to==="first"?ro=so.collection().getFirstKey():to==="last"&&(ro=so.collection().getLastKey())),lo(),so.selectionManager().setFocused(!0),so.selectionManager().setFocusedKey(ro)},oo=()=>{io.close(),so.selectionManager().setFocused(!1),so.selectionManager().setFocusedKey(void 0)},co=to=>{io.isOpen()?oo():ao(to)},{formControlContext:fo}=createFormControl(Oe);createFormResetListener(je,()=>{const to=s.defaultValue?[...s.defaultValue].map(Ze):new Selection;so.selectionManager().setSelectedKeys(to)});const mo=createCollator({usage:"search",sensitivity:"base"}),wo=createMemo(()=>{const to=access(s.keyboardDelegate);return to||new ListKeyboardDelegate(so.collection,void 0,mo)}),Co=to=>s.itemComponent?.({item:to}),yo=to=>s.sectionComponent?.({section:to});createEffect(on$1([eo],([to])=>{const po=[...so.selectionManager().selectedKeys()].filter(So=>to.includes(So));so.selectionManager().setSelectedKeys(po)},{defer:!0}));const go=createMemo(()=>({"data-expanded":io.isOpen()?"":void 0,"data-closed":io.isOpen()?void 0:""})),vo={dataset:go,isOpen:io.isOpen,isDisabled:()=>fo.isDisabled()??!1,isMultiple:()=>access(s.selectionMode)==="multiple",isVirtualized:()=>s.virtualized??!1,isModal:()=>s.modal??!1,preventScroll:()=>s.preventScroll??vo.isModal(),disallowTypeAhead:()=>s.disallowTypeAhead??!1,shouldFocusWrap:()=>s.shouldFocusWrap??!1,selectedOptions:uo,contentPresent:ho,autoFocus:Xe,triggerRef:je,listState:()=>so,keyboardDelegate:wo,triggerId:Ee,valueId:Ie,listboxId:He,listboxAriaLabelledBy:Ge,setListboxAriaLabelledBy:qe,setTriggerRef:Ne,setContentRef:Be,setListboxRef:We,open:ao,close:oo,toggle:co,placeholder:()=>s.placeholder,renderItem:Co,renderSection:yo,removeOptionFromSelection:no,generateId:createGenerateId(()=>access(Oe.id)),registerTriggerId:createRegisterId($e),registerValueId:createRegisterId(Fe),registerListboxId:createRegisterId(ze)};return createComponent(FormControlContext.Provider,{value:fo,get children(){return createComponent(SelectContext.Provider,{value:vo,get children(){return createComponent(Popper,mergeProps({anchorRef:je,contentRef:Ke},Le,{get children(){return createComponent(Polymorphic,mergeProps({as:"div",role:"group",get id(){return access(Oe.id)}},()=>fo.dataset(),go,Ae))}}))}})}})}function SelectRoot(n){const[t,i]=splitProps(n,["value","defaultValue","onChange","multiple"]),s=createMemo(()=>t.value!=null?t.multiple?t.value:[t.value]:t.value),Le=createMemo(()=>t.defaultValue!=null?t.multiple?t.defaultValue:[t.defaultValue]:t.defaultValue);return createComponent(SelectBase,mergeProps({get value(){return s()},get defaultValue(){return Le()},onChange:Ae=>{t.multiple?t.onChange?.(Ae):t.onChange?.(Ae[0]??null)},get selectionMode(){return t.multiple?"multiple":"single"}},i))}function SelectTrigger$1(n){const t=useFormControlContext(),i=useSelectContext(),s=mergeDefaultProps({id:i.generateId("trigger")},n),[Le,Oe,Ae]=splitProps(s,["ref","disabled","onPointerDown","onClick","onKeyDown","onFocus","onBlur"],FORM_CONTROL_FIELD_PROP_NAMES),Ee=()=>i.listState().selectionManager(),$e=()=>i.keyboardDelegate(),Ie=()=>Le.disabled||i.isDisabled(),{fieldProps:Fe}=createFormControlField(Oe),{typeSelectHandlers:He}=createTypeSelect({keyboardDelegate:$e,selectionManager:Ee,onTypeSelect:We=>Ee().select(We)}),ze=()=>[i.listboxAriaLabelledBy(),i.valueId()].filter(Boolean).join(" ")||void 0,je=We=>{callHandler(We,Le.onPointerDown),We.currentTarget.dataset.pointerType=We.pointerType,!Ie()&&We.pointerType!=="touch"&&We.button===0&&(We.preventDefault(),i.toggle(!0))},Ne=We=>{callHandler(We,Le.onClick),!Ie()&&We.currentTarget.dataset.pointerType==="touch"&&i.toggle(!0)},Ke=We=>{if(callHandler(We,Le.onKeyDown),!Ie())switch(callHandler(We,He.onKeyDown),We.key){case"Enter":case" ":case"ArrowDown":We.stopPropagation(),We.preventDefault(),i.toggle("first");break;case"ArrowUp":We.stopPropagation(),We.preventDefault(),i.toggle("last");break;case"ArrowLeft":{if(We.preventDefault(),i.isMultiple())return;const Ge=Ee().firstSelectedKey(),qe=Ge!=null?$e().getKeyAbove?.(Ge):$e().getFirstKey?.();qe!=null&&Ee().select(qe);break}case"ArrowRight":{if(We.preventDefault(),i.isMultiple())return;const Ge=Ee().firstSelectedKey(),qe=Ge!=null?$e().getKeyBelow?.(Ge):$e().getFirstKey?.();qe!=null&&Ee().select(qe);break}}},Be=We=>{callHandler(We,Le.onFocus),!Ee().isFocused()&&Ee().setFocused(!0)},Ue=We=>{callHandler(We,Le.onBlur),!i.isOpen()&&Ee().setFocused(!1)};return createEffect(()=>onCleanup(i.registerTriggerId(Fe.id()))),createEffect(()=>{i.setListboxAriaLabelledBy([Fe.ariaLabelledBy(),Fe.ariaLabel()&&!Fe.ariaLabelledBy()?Fe.id():null].filter(Boolean).join(" ")||void 0)}),createComponent(ButtonRoot,mergeProps({ref(We){var Ge=mergeRefs(i.setTriggerRef,Le.ref);typeof Ge=="function"&&Ge(We)},get id(){return Fe.id()},get disabled(){return Ie()},"aria-haspopup":"listbox",get"aria-expanded"(){return i.isOpen()},get"aria-controls"(){return createMemo(()=>!!i.isOpen())()?i.listboxId():void 0},get"aria-label"(){return Fe.ariaLabel()},get"aria-labelledby"(){return ze()},get"aria-describedby"(){return Fe.ariaDescribedBy()},onPointerDown:je,onClick:Ne,onKeyDown:Ke,onFocus:Be,onBlur:Ue},()=>i.dataset(),()=>t.dataset(),Ae))}function SelectValue$1(n){const t=useFormControlContext(),i=useSelectContext(),s=mergeDefaultProps({id:i.generateId("value")},n),[Le,Oe]=splitProps(s,["id","children"]),Ae=()=>i.listState().selectionManager(),Ee=()=>{const $e=Ae().selectedKeys();return $e.size===1&&$e.has("")?!0:Ae().isEmpty()};return createEffect(()=>onCleanup(i.registerValueId(Le.id))),createComponent(Polymorphic,mergeProps({as:"span",get id(){return Le.id},get"data-placeholder-shown"(){return Ee()?"":void 0}},()=>t.dataset(),Oe,{get children(){return createComponent(Show,{get when(){return!Ee()},get fallback(){return i.placeholder()},get children(){return createComponent(SelectValueChild,{state:{selectedOption:()=>i.selectedOptions()[0],selectedOptions:()=>i.selectedOptions(),remove:$e=>i.removeOptionFromSelection($e),clear:()=>Ae().clearSelection()},get children(){return Le.children}})}})}}))}function SelectValueChild(n){const t=children(()=>{const i=n.children;return isFunction(i)?i(n.state):i});return createMemo(t)}var Select$1=Object.assign(SelectRoot,{Arrow:PopperArrow,Content:SelectContent$1,Description:FormControlDescription,ErrorMessage:FormControlErrorMessage,HiddenSelect:SelectHiddenSelect,Icon:SelectIcon,Item:ListboxItem,ItemDescription:ListboxItemDescription,ItemIndicator:ListboxItemIndicator,ItemLabel:ListboxItemLabel,Label:SelectLabel,Listbox:SelectListbox,Portal:SelectPortal,Section:ListboxSection,Trigger:SelectTrigger$1,Value:SelectValue$1}),_tmpl$$4=template('<svg><path d="M8 9l4 -4l4 4"></svg>',!1,!0),_tmpl$2$2=template('<svg><path d="M16 15l-4 4l-4 -4"></svg>',!1,!0),_tmpl$3$2=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round class=size-4><path stroke=none d="M0 0h24v24H0z"fill=none></path><path d="M5 12l5 5l10 -10">');const Select=SelectRoot,SelectValue=SelectValue$1,SelectTrigger=n=>{const[t,i]=splitProps(n,["class","children"]);return createComponent(SelectTrigger$1,mergeProps({get class(){return cn$1("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t.class)}},i,{get children(){return[createMemo(()=>t.children),createComponent(SelectIcon,{as:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"size-4 opacity-50",get children(){return[_tmpl$$4(),_tmpl$2$2()]}})]}}))},SelectContent=n=>{const[t,i]=splitProps(n,["class"]);return createComponent(SelectPortal,{get children(){return createComponent(SelectContent$1,mergeProps({get class(){return cn$1("relative z-50 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80",t.class)}},i,{get children(){return createComponent(SelectListbox,{class:"m-0 p-1"})}}))}})},SelectItem=n=>{const[t,i]=splitProps(n,["class","children"]);return createComponent(ListboxItem,mergeProps({get class(){return cn$1("relative mt-0 flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t.class)}},i,{get children(){return[createComponent(ListboxItemIndicator,{class:"absolute right-2 flex size-3.5 items-center justify-center",get children(){return _tmpl$3$2()}}),createComponent(ListboxItemLabel,{get children(){return t.children}})]}}))};var dialog_exports={};__export(dialog_exports,{CloseButton:()=>DialogCloseButton,Content:()=>DialogContent$1,Description:()=>DialogDescription$1,Dialog:()=>Dialog$1,Overlay:()=>DialogOverlay$1,Portal:()=>DialogPortal$1,Root:()=>DialogRoot,Title:()=>DialogTitle$1,Trigger:()=>DialogTrigger$1});var DialogContext=createContext();function useDialogContext(){const n=useContext(DialogContext);if(n===void 0)throw new Error("[kobalte]: `useDialogContext` must be used within a `Dialog` component");return n}function DialogCloseButton(n){const t=useDialogContext(),[i,s]=splitProps(n,["aria-label","onClick"]);return createComponent(ButtonRoot,mergeProps({get"aria-label"(){return i["aria-label"]||t.translations().dismiss},onClick:Oe=>{callHandler(Oe,i.onClick),t.close()}},s))}function DialogContent$1(n){let t;const i=useDialogContext(),s=mergeDefaultProps({id:i.generateId("content")},n),[Le,Oe]=splitProps(s,["ref","onOpenAutoFocus","onCloseAutoFocus","onPointerDownOutside","onFocusOutside","onInteractOutside"]);let Ae=!1,Ee=!1;const $e=ze=>{Le.onPointerDownOutside?.(ze),i.modal()&&ze.detail.isContextMenu&&ze.preventDefault()},Ie=ze=>{Le.onFocusOutside?.(ze),i.modal()&&ze.preventDefault()},Fe=ze=>{Le.onInteractOutside?.(ze),!i.modal()&&(ze.defaultPrevented||(Ae=!0,ze.detail.originalEvent.type==="pointerdown"&&(Ee=!0)),contains$1(i.triggerRef(),ze.target)&&ze.preventDefault(),ze.detail.originalEvent.type==="focusin"&&Ee&&ze.preventDefault())},He=ze=>{Le.onCloseAutoFocus?.(ze),i.modal()?(ze.preventDefault(),focusWithoutScrolling(i.triggerRef())):(ze.defaultPrevented||(Ae||focusWithoutScrolling(i.triggerRef()),ze.preventDefault()),Ae=!1,Ee=!1)};return createHideOutside({isDisabled:()=>!(i.isOpen()&&i.modal()),targets:()=>t?[t]:[]}),src_default({element:()=>t??null,enabled:()=>i.contentPresent()&&i.preventScroll()}),createFocusScope({trapFocus:()=>i.isOpen()&&i.modal(),onMountAutoFocus:Le.onOpenAutoFocus,onUnmountAutoFocus:He},()=>t),createEffect(()=>onCleanup(i.registerContentId(Oe.id))),createComponent(Show,{get when(){return i.contentPresent()},get children(){return createComponent(DismissableLayer,mergeProps({ref(ze){var je=mergeRefs(Ne=>{i.setContentRef(Ne),t=Ne},Le.ref);typeof je=="function"&&je(ze)},role:"dialog",tabIndex:-1,get disableOutsidePointerEvents(){return createMemo(()=>!!i.modal())()&&i.isOpen()},get excludedElements(){return[i.triggerRef]},get"aria-labelledby"(){return i.titleId()},get"aria-describedby"(){return i.descriptionId()},get"data-expanded"(){return i.isOpen()?"":void 0},get"data-closed"(){return i.isOpen()?void 0:""},onPointerDownOutside:$e,onFocusOutside:Ie,onInteractOutside:Fe,get onDismiss(){return i.close}},Oe))}})}function DialogDescription$1(n){const t=useDialogContext(),i=mergeDefaultProps({id:t.generateId("description")},n),[s,Le]=splitProps(i,["id"]);return createEffect(()=>onCleanup(t.registerDescriptionId(s.id))),createComponent(Polymorphic,mergeProps({as:"p",get id(){return s.id}},Le))}function DialogOverlay$1(n){const t=useDialogContext(),[i,s]=splitProps(n,["ref","style","onPointerDown"]),Le=Oe=>{callHandler(Oe,i.onPointerDown),Oe.target===Oe.currentTarget&&Oe.preventDefault()};return createComponent(Show,{get when(){return t.overlayPresent()},get children(){return createComponent(Polymorphic,mergeProps({as:"div",ref(Oe){var Ae=mergeRefs(t.setOverlayRef,i.ref);typeof Ae=="function"&&Ae(Oe)},get style(){return combineStyle({"pointer-events":"auto"},i.style)},get"data-expanded"(){return t.isOpen()?"":void 0},get"data-closed"(){return t.isOpen()?void 0:""},onPointerDown:Le},s))}})}function DialogPortal$1(n){const t=useDialogContext();return createComponent(Show,{get when(){return t.contentPresent()||t.overlayPresent()},get children(){return createComponent(Portal,n)}})}var DIALOG_INTL_TRANSLATIONS={dismiss:"Dismiss"};function DialogRoot(n){const t=`dialog-${createUniqueId()}`,i=mergeDefaultProps({id:t,modal:!0,translations:DIALOG_INTL_TRANSLATIONS},n),[s,Le]=createSignal(),[Oe,Ae]=createSignal(),[Ee,$e]=createSignal(),[Ie,Fe]=createSignal(),[He,ze]=createSignal(),[je,Ne]=createSignal(),Ke=createDisclosureState({open:()=>i.open,defaultOpen:()=>i.defaultOpen,onOpenChange:qe=>i.onOpenChange?.(qe)}),Be=()=>i.forceMount||Ke.isOpen(),{present:Ue}=src_default$1({show:Be,element:()=>Ie()??null}),{present:We}=src_default$1({show:Be,element:()=>He()??null}),Ge={translations:()=>i.translations??DIALOG_INTL_TRANSLATIONS,isOpen:Ke.isOpen,modal:()=>i.modal??!0,preventScroll:()=>i.preventScroll??Ge.modal(),contentId:s,titleId:Oe,descriptionId:Ee,triggerRef:je,overlayRef:Ie,setOverlayRef:Fe,contentRef:He,setContentRef:ze,overlayPresent:Ue,contentPresent:We,close:Ke.close,toggle:Ke.toggle,setTriggerRef:Ne,generateId:createGenerateId(()=>i.id),registerContentId:createRegisterId(Le),registerTitleId:createRegisterId(Ae),registerDescriptionId:createRegisterId($e)};return createComponent(DialogContext.Provider,{value:Ge,get children(){return i.children}})}function DialogTitle$1(n){const t=useDialogContext(),i=mergeDefaultProps({id:t.generateId("title")},n),[s,Le]=splitProps(i,["id"]);return createEffect(()=>onCleanup(t.registerTitleId(s.id))),createComponent(Polymorphic,mergeProps({as:"h2",get id(){return s.id}},Le))}function DialogTrigger$1(n){const t=useDialogContext(),[i,s]=splitProps(n,["ref","onClick"]);return createComponent(ButtonRoot,mergeProps({ref(Oe){var Ae=mergeRefs(t.setTriggerRef,i.ref);typeof Ae=="function"&&Ae(Oe)},"aria-haspopup":"dialog",get"aria-expanded"(){return t.isOpen()},get"aria-controls"(){return createMemo(()=>!!t.isOpen())()?t.contentId():void 0},get"data-expanded"(){return t.isOpen()?"":void 0},get"data-closed"(){return t.isOpen()?void 0:""},onClick:Oe=>{callHandler(Oe,i.onClick),t.toggle()}},s))}var Dialog$1=Object.assign(DialogRoot,{CloseButton:DialogCloseButton,Content:DialogContent$1,Description:DialogDescription$1,Overlay:DialogOverlay$1,Portal:DialogPortal$1,Title:DialogTitle$1,Trigger:DialogTrigger$1}),_tmpl$$3=template('<div class="fixed inset-0 z-50 flex items-start justify-center sm:items-center">'),_tmpl$2$1=template('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"fill=none stroke=currentColor stroke-width=2 stroke-linecap=round stroke-linejoin=round class=size-4><path d="M18 6l-12 12"></path><path d="M6 6l12 12">'),_tmpl$3$1=template("<span class=sr-only>Close"),_tmpl$4$1=template("<div>");const Dialog=DialogRoot,DialogTrigger=DialogTrigger$1,DialogPortal=n=>{const[,t]=splitProps(n,["children"]);return createComponent(DialogPortal$1,mergeProps(t,{get children(){var i=_tmpl$$3();return insert(i,()=>n.children),i}}))},DialogOverlay=n=>{const[,t]=splitProps(n,["class"]);return createComponent(DialogOverlay$1,mergeProps({get class(){return cn$1("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[expanded]:animate-in data-[closed]:animate-out data-[closed]:fade-out-0 data-[expanded]:fade-in-0",n.class)}},t))},DialogContent=n=>{const[,t]=splitProps(n,["class","children"]);return createComponent(DialogPortal,{get children(){return[createComponent(DialogOverlay,{}),createComponent(DialogContent$1,mergeProps({get class(){return cn$1("fixed left-1/2 top-1/2 z-50 grid w-full max-w-lg -translate-x-1/2 -translate-y-1/2 gap-4 border bg-background p-6 shadow-lg duration-200 data-[expanded]:animate-in data-[closed]:animate-out data-[closed]:fade-out-0 data-[expanded]:fade-in-0 data-[closed]:zoom-out-95 data-[expanded]:zoom-in-95 data-[closed]:slide-out-to-left-1/2 data-[closed]:slide-out-to-top-[48%] data-[expanded]:slide-in-from-left-1/2 data-[expanded]:slide-in-from-top-[48%] sm:rounded-lg",n.class)}},t,{get children(){return[createMemo(()=>n.children),createComponent(DialogCloseButton,{class:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[expanded]:bg-accent data-[expanded]:text-muted-foreground",get children(){return[_tmpl$2$1(),_tmpl$3$1()]}})]}}))]}})},DialogHeader=n=>{const[,t]=splitProps(n,["class"]);return(()=>{var i=_tmpl$4$1();return spread(i,mergeProps({get class(){return cn$1("flex flex-col space-y-1.5 text-center sm:text-left",n.class)}},t),!1,!1),i})()},DialogTitle=n=>{const[,t]=splitProps(n,["class"]);return createComponent(DialogTitle$1,mergeProps({get class(){return cn$1("text-lg font-semibold leading-none tracking-tight",n.class)}},t))},DialogDescription=n=>{const[,t]=splitProps(n,["class"]);return createComponent(DialogDescription$1,mergeProps({get class(){return cn$1("text-sm text-muted-foreground",n.class)}},t))};var _tmpl$$2=template('<div id=chart class="mr-4 mb-4"> ');function Chart(n){let t,i,s;return onMount(()=>{i=Ve(t,{height:200,layout:{textColor:"#DDD",background:{color:"#222"}},grid:{vertLines:{color:"#444"},horzLines:{color:"#444"}}}),s=i.addCandlestickSeries()}),createEffect(()=>{s.setData(n.marketData),s.setMarkers(n.markers||[]),i.timeScale().fitContent()}),(()=>{var Le=_tmpl$$2();return use(Oe=>{t=Oe},Le),Le})()}var text_field_exports={};__export(text_field_exports,{Description:()=>FormControlDescription,ErrorMessage:()=>FormControlErrorMessage,Input:()=>TextFieldInput$1,Label:()=>FormControlLabel,Root:()=>TextFieldRoot,TextArea:()=>TextFieldTextArea,TextField:()=>TextField$1});var TextFieldContext=createContext();function useTextFieldContext(){const n=useContext(TextFieldContext);if(n===void 0)throw new Error("[kobalte]: `useTextFieldContext` must be used within a `TextField` component");return n}function TextFieldInput$1(n){return createComponent(TextFieldInputBase,mergeProps({type:"text"},n))}function TextFieldInputBase(n){const t=useFormControlContext(),i=useTextFieldContext(),s=mergeDefaultProps({id:i.generateId("input")},n),[Le,Oe,Ae]=splitProps(s,["onInput"],FORM_CONTROL_FIELD_PROP_NAMES),{fieldProps:Ee}=createFormControlField(Oe);return createComponent(Polymorphic,mergeProps({as:"input",get id(){return Ee.id()},get name(){return t.name()},get value(){return i.value()},get required(){return t.isRequired()},get disabled(){return t.isDisabled()},get readonly(){return t.isReadOnly()},get"aria-label"(){return Ee.ariaLabel()},get"aria-labelledby"(){return Ee.ariaLabelledBy()},get"aria-describedby"(){return Ee.ariaDescribedBy()},get"aria-invalid"(){return t.validationState()==="invalid"||void 0},get"aria-required"(){return t.isRequired()||void 0},get"aria-disabled"(){return t.isDisabled()||void 0},get"aria-readonly"(){return t.isReadOnly()||void 0},get onInput(){return composeEventHandlers([Le.onInput,i.onInput])}},()=>t.dataset(),Ae))}function TextFieldRoot(n){let t;const i=`textfield-${createUniqueId()}`,s=mergeDefaultProps({id:i},n),[Le,Oe,Ae]=splitProps(s,["ref","value","defaultValue","onChange"],FORM_CONTROL_PROP_NAMES),[Ee,$e]=createControllableSignal({value:()=>Le.value,defaultValue:()=>Le.defaultValue,onChange:ze=>Le.onChange?.(ze)}),{formControlContext:Ie}=createFormControl(Oe);createFormResetListener(()=>t,()=>$e(Le.defaultValue??""));const Fe=ze=>{if(Ie.isReadOnly()||Ie.isDisabled())return;const je=ze.target;$e(je.value),je.value=Ee()??""},He={value:Ee,generateId:createGenerateId(()=>access(Oe.id)),onInput:Fe};return createComponent(FormControlContext.Provider,{value:Ie,get children(){return createComponent(TextFieldContext.Provider,{value:He,get children(){return createComponent(Polymorphic,mergeProps({as:"div",ref(ze){var je=mergeRefs(Ne=>t=Ne,Le.ref);typeof je=="function"&&je(ze)},role:"group",get id(){return access(Oe.id)}},()=>Ie.dataset(),Ae))}})}})}function TextFieldTextArea(n){let t;const i=useTextFieldContext(),s=mergeDefaultProps({id:i.generateId("textarea")},n),[Le,Oe]=splitProps(s,["ref","autoResize","submitOnEnter","onKeyPress"]);createEffect(on$1([()=>t,()=>Le.autoResize,()=>i.value()],([Ee,$e])=>{!Ee||!$e||adjustHeight(Ee)}));const Ae=Ee=>{t&&Le.submitOnEnter&&Ee.key==="Enter"&&!Ee.shiftKey&&t.form&&(t.form.requestSubmit(),Ee.preventDefault())};return createComponent(TextFieldInputBase,mergeProps({as:"textarea",get"aria-multiline"(){return Le.submitOnEnter?"false":void 0},get onKeyPress(){return composeEventHandlers([Le.onKeyPress,Ae])},ref(Ee){var $e=mergeRefs(Ie=>t=Ie,Le.ref);typeof $e=="function"&&$e(Ee)}},Oe))}function adjustHeight(n){const t=n.style.alignSelf,i=n.style.overflow;"MozAppearance"in n.style||(n.style.overflow="hidden"),n.style.alignSelf="start",n.style.height="auto",n.style.height=`${n.scrollHeight+(n.offsetHeight-n.clientHeight)}px`,n.style.overflow=i,n.style.alignSelf=t}var TextField$1=Object.assign(TextFieldRoot,{Description:FormControlDescription,ErrorMessage:FormControlErrorMessage,Input:TextFieldInput$1,Label:FormControlLabel,TextArea:TextFieldTextArea});const TextField=TextFieldRoot,TextFieldInput=n=>{const[t,i]=splitProps(n,["type","class"]);return createComponent(TextFieldInput$1,mergeProps({get type(){return t.type},get class(){return cn$1("flex h-10 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t.class)}},i))},labelVariants=cva("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",{variants:{variant:{label:"data-[invalid]:text-destructive",description:"text-destructive",error:"font-normal text-muted-foreground"}},defaultVariants:{variant:"label"}}),TextFieldLabel=n=>{const[t,i]=splitProps(n,["class"]);return createComponent(FormControlLabel,mergeProps({get class(){return cn$1(labelVariants(),t.class)}},i))};class CircularBuffer{constructor(t){this.length=t,this.filled=!1,this.pointer=0,this.buffer=new Array(t),this.maxIndex=t-1}push(t){const i=this.buffer[this.pointer];return this.buffer[this.pointer]=t,this.iteratorNext(),i}pushback(t){this.iteratorPrev();const i=this.buffer[this.pointer];return this.buffer[this.pointer]=t,i}peek(){return this.buffer[this.pointer]}forEach(t){let i=this.pointer,s=0;for(;s!==this.length;)t(this.buffer[i],s),i=(this.length+i+1)%this.length,s++}forEachRight(t){let i=(this.length+this.pointer-1)%this.length,s=this.length-1;for(;s!==this.length;)t(this.buffer[i],s),i=(this.length+i-1)%this.length,s--}fill(t){this.buffer.fill(t),this.filled=!0}toArray(){return this.buffer}iteratorNext(){this.pointer++,this.pointer>this.maxIndex&&(this.pointer=0,this.filled=!0)}iteratorPrev(){this.pointer--,this.pointer<0&&(this.pointer=this.maxIndex)}}class SMA{constructor(t){this.period=t,this.sum=0,this.circular=new CircularBuffer(t)}nextValue(t){if(this.circular.push(t),this.sum+=t,!!this.circular.filled)return this.nextValue=i=>(this.sum=this.sum-this.circular.push(i)+i,this.sum/this.period),this.momentValue=i=>(this.sum-this.circular.peek()+i)/this.period,this.sum/this.period}momentValue(t){}}class EMA{constructor(t){this.period=t,this.smooth=2/(this.period+1),this.sma=new SMA(this.period)}nextValue(t){const i=this.sma.nextValue(t);return i&&(this.ema=i,this.nextValue=s=>this.ema=(s-this.ema)*this.smooth+this.ema,this.momentValue=s=>(s-this.ema)*this.smooth+this.ema),i}momentValue(t){}}class SMMA{constructor(t){this.period=t,this.sum=0,this.avg=0,this.filled=!1,this.fill=0}nextValue(t){if(this.filled)return this.nextValue=i=>this.avg=(this.avg*(this.period-1)+i)/this.period,this.nextValue(t);if(this.sum+=t,this.fill++,this.fill===this.period)return this.filled=!0,this.avg=this.sum/this.period,this.avg}momentValue(t){if(this.filled)return(this.avg*(this.period-1)+t)/this.period}}const getMax=n=>{let t=-1/0;for(let i=n.length-1;i>=0;i--){const s=n[i];t<s&&(t=s)}return t},getMin=n=>{let t=1/0;for(let i=n.length-1;i>=0;i--){const s=n[i];t>s&&(t=s)}return t};class MaxProvider{constructor(t){this.max=-1/0,this.highest=new CircularBuffer(t)}filled(){return this.highest.filled}nextValue(t){return this.max<t&&(this.max=t),this.highest.push(t)===this.max&&t!==this.max&&(this.max=getMax(this.highest.toArray())),this.max}momentValue(t){return this.max>t?this.max:t}}class MinProvider{constructor(t){this.min=1/0,this.lowest=new CircularBuffer(t)}filled(){return this.lowest.filled}nextValue(t){return this.min>t&&(this.min=t),this.lowest.push(t)===this.min&&t!==this.min&&(this.min=getMin(this.lowest.toArray())),this.min}momentValue(t){return this.min<t?this.min:t}}class Stochastic{constructor(t=14,i=3){this.period=t,this.smaPeriod=i,this.sma=new SMA(this.smaPeriod),this.max=new MaxProvider(t),this.min=new MinProvider(t)}nextValue(t,i,s){const Le=this.max.nextValue(t),Oe=this.min.nextValue(i);if(!this.max.filled())return;const Ae=(s-Oe)/(Le-Oe)*100,Ee=this.sma.nextValue(Ae);return{k:Ae,d:Ee}}momentValue(t,i,s){if(!this.max.filled())return;const Le=this.max.momentValue(t),Oe=this.min.momentValue(i),Ae=(s-Oe)/(Le-Oe)*100,Ee=this.sma.momentValue(Ae);return{k:Ae,d:Ee}}}class AvgChangeProvider{constructor(t){this.avgGain=new SMMA(t),this.avgLoss=new SMMA(t)}nextValue(t){const i=t-this.prev;if(!this.prev){this.prev=t;return}const s=i>0,Le=i<0,Oe=s?i:0,Ae=Le?i:0,Ee=this.avgGain.nextValue(Oe),$e=this.avgLoss.nextValue(Ae);return this.prev=t,{upAvg:Ee,downAvg:$e}}momentValue(t){const i=t-this.prev,s=i>0,Le=i<0,Oe=s?i:0,Ae=Le?i:0,Ee=this.avgGain.momentValue(Oe),$e=this.avgLoss.momentValue(Ae);return{upAvg:Ee,downAvg:$e}}}class RSI{constructor(t=14){this.period=t,this.change=new AvgChangeProvider(this.period)}nextValue(t){const{downAvg:i,upAvg:s}=this.change.nextValue(t)||{};return s===void 0||i===void 0?void 0:100-100/(1+s/-i)}momentValue(t){const{downAvg:i,upAvg:s}=this.change.momentValue(t)||{};return s===void 0||i===void 0?void 0:100-100/(1+s/-i)}}class StandardDeviation{constructor(t){this.period=t,this.values=new CircularBuffer(t)}nextValue(t,i){return this.values.push(t),Math.sqrt(this.values.toArray().reduce((s,Le)=>s+(Le-i)**2,0)/this.period)}momentValue(t,i){const s=this.values.push(t),Le=Math.sqrt(this.values.toArray().reduce((Oe,Ae)=>Oe+(Ae-i)**2,0)/this.period);return this.values.pushback(s),Le}}class BollingerBands{constructor(t=20,i=2){this.period=t,this.stdDev=i,this.fill=0,this.sma=new SMA(t),this.sd=new StandardDeviation(t)}nextValue(t){const i=this.sma.nextValue(t),s=this.sd.nextValue(t,i);if(this.fill++,this.fill!==this.period)return;const Le=i-this.stdDev*s,Oe=i+this.stdDev*s;return this.nextValue=Ae=>{const Ee=this.sma.nextValue(Ae),$e=this.sd.nextValue(Ae,Ee),Ie=Ee-this.stdDev*$e,Fe=Ee+this.stdDev*$e;return{lower:Ie,middle:Ee,upper:Fe}},{lower:Le,middle:i,upper:Oe}}momentValue(t){const i=this.sma.momentValue(t),s=this.sd.momentValue(t,i),Le=i-this.stdDev*s,Oe=i+this.stdDev*s;return{lower:Le,middle:i,upper:Oe}}}const Indicators={SMA,EMA,Stochastic,BollingerBands,RSI};var _tmpl$$1=template('<p class=text-base>Select csv file in <a class="font-bold text-blue-700"href=https://finance.yahoo.com/quote/BTC-USD/history/>Yahoo Finance</a> format:'),_tmpl$2=template("<p>[<b>Time</b>, <b>Open</b>, <b>High</b>, <b>Low</b>, <b>Close</b>, <b>AdjClose</b>, <b>Volume</b>]"),_tmpl$3=template("<br>"),_tmpl$4=template('<p>Example <a class="font-bold text-blue-700"href=https://finance.yahoo.com/quote/BTC-USD/history/>BTC-USD'),_tmpl$5=template('<label for=market-data-input style="border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;">'),_tmpl$6=template("<input style=display:none type=file id=market-data-input>"),_tmpl$7=template("<a href=https://www.investopedia.com/terms/b/basecurrency.asp>definition"),_tmpl$8=template("<a href=https://www.investopedia.com/terms/q/quotecurrency.asp>definition"),_tmpl$9=template("<div class=relative>"),_tmpl$10=template('<div class="flex h-full"><div class=w-3/4></div><div class="w-1/4 mx-8"><div class="flex flex-col w-full py-4"><h2 class="text-xl font-bold mb-4">Import market data</h2></div><div class="flex flex-col py-4"><h2 class="text-xl font-bold mb-4">Settings');function SelectMarketDataComponent(){return createComponent(Select,{get options(){return marketDatas()},get value(){return selectedMarketData()},onChange:n=>{n!==null&&setSelectedMarketData(n)},optionTextValue:"label",optionValue:"label",optionDisabled:"disabled",placeholder:"Select market data",itemComponent:n=>createComponent(SelectItem,{get item(){return n.item},get children(){return n.item.rawValue.label}}),get children(){return[createComponent(SelectTrigger,{"aria-label":"Market data",get children(){return createComponent(SelectValue,{children:n=>n.selectedOption().label})}}),createComponent(SelectContent,{})]}})}function MarketDataImporterComponent(){const[n,t]=createSignal(null),[i,s]=createSignal(!1);return[createComponent(Button,{class:"mt-4",onClick:()=>s(!0),children:"Import csv"}),createComponent(Dialog,{get open(){return i()},onOpenChange:s,get children(){return[createComponent(DialogTrigger,{}),createComponent(DialogContent,{class:"max-w-6xl max-h-2xl",get children(){return[createComponent(DialogHeader,{get children(){return[createComponent(DialogTitle,{class:"mb-4 font-bold text-2xl",children:"Import market data"}),createComponent(DialogDescription,{get children(){return[_tmpl$$1(),_tmpl$2(),_tmpl$3(),_tmpl$4()]}})]}}),(()=>{var Le=_tmpl$5();return insert(Le,(()=>{var Oe=createMemo(()=>!!n()?.label);return()=>Oe()?n()?.label:"Select file..."})()),Le})(),(()=>{var Le=_tmpl$6();return Le.addEventListener("change",Oe=>{const Ae=Oe.currentTarget.files[0];if(Ae===void 0){Oe.currentTarget.value="";const Ee=`Unexcepted error during file loading: ${Oe}`;console.error(Ee),showToast({title:"Import error",variant:"destructive",description:Ee})}else if(Ae.name.endsWith(".csv")){const Ee=new FileReader;Ee.readAsText(Ae,"UTF-8"),Ee.onload=function($e){const[Ie,Fe]=parseYahooCsv($e.target.result);if(Fe!==null){console.error(Fe),showToast({title:"Import error",variant:"destructive",description:`Importing ${Ae.name} result with error: ${Fe}`});return}const[He,ze]=detectCurrencySymbols(Ae.name);console.log(Ie),t({label:Ae.name,baseSymbol:He,quoteSymbol:ze,value:Ie,disabled:!1})},Ee.onerror=function($e){const Ie=`Error reading file: ${$e}`;console.error(Ie),showToast({title:"File reading error",variant:"destructive",description:Ie})}}else{Oe.currentTarget.value="";const Ee=`Wrong file extension for ${Ae.name}`;console.error(Ee),showToast({title:"Import error",variant:"destructive",description:Ee})}}),Le})(),createComponent(Show,{get when(){return n()},get children(){return[createComponent(Chart,{get marketData(){return n()?.value}}),createComponent(TextField,{get value(){return n()?.baseSymbol},onChange:Le=>t(Oe=>({...Oe,baseSymbol:Le})),get children(){return[createComponent(TextFieldLabel,{get children(){return["*Base symbol (crypto, stocks - see ",createMemo(()=>_tmpl$7()),")"]}}),createComponent(TextFieldInput,{placeholder:"e.g. APPLE"})]}}),createComponent(TextField,{get value(){return n()?.quoteSymbol},onChange:Le=>t(Oe=>({...Oe,quoteSymbol:Le})),get children(){return[createComponent(TextFieldLabel,{get children(){return["*Quote currency (currency of profit - see ",createMemo(()=>_tmpl$8()),")"]}}),createComponent(TextFieldInput,{placeholder:"e.g. USD"})]}})]}}),createComponent(Button,{get disabled(){return n()===null},onClick:()=>{addMarketData(n()),setSelectedMarketData(n()),t(null),s(!1),showToast({title:"Import success",variant:"success",description:`${selectedMarketData().label} successfully imported`})},children:"Import"})]}})]}})]}function StrategyEditor(n){return(()=>{var t=_tmpl$10(),i=t.firstChild,s=i.nextSibling,Le=s.firstChild;Le.firstChild;var Oe=Le.nextSibling;return Oe.firstChild,insert(i,createComponent(Editor,{})),insert(Le,createComponent(SelectMarketDataComponent,{}),null),insert(Le,createComponent(MarketDataImporterComponent,{}),null),insert(Oe,createComponent(NumberField,{get defaultValue(){return backtestingOptions.initialBalance},onRawValueChange:Ae=>setBacktestingOptions({...backtestingOptions,initialBalance:Ae}),minValue:0,get children(){return[createComponent(NumberFieldLabel,{get children(){return["Initial balance [",createMemo(()=>selectedMarketData().quoteSymbol),"]"]}}),(()=>{var Ae=_tmpl$9();return insert(Ae,createComponent(NumberFieldInput,{}),null),insert(Ae,createComponent(NumberFieldIncrementTrigger,{}),null),insert(Ae,createComponent(NumberFieldDecrementTrigger,{}),null),Ae})(),createComponent(NumberFieldDescription,{children:"Your investement capital"})]}}),null),insert(Oe,createComponent(Button,{class:"mt-4",onClick:()=>runBacktestingEngine(n.setBacktestingReport),children:"Run"}),null),t})()}function runBacktestingEngine(setBacktestingReport){const windowObject=window;windowObject.initStrategy=null,windowObject.onTick=null,windowObject.Indicators=Indicators;try{eval(strategyCode.value)}catch(n){if(n instanceof Error){console.error(n),showToast({title:"JS Evaluation error",variant:"destructive",description:`${n.name}: ${n.message}`});return}}const strategy={initStrategy:windowObject.initStrategy,onTick:windowObject.onTick},baseSymbol=selectedMarketData().baseSymbol,quoteSymbol=selectedMarketData().quoteSymbol,data=selectedMarketData().value,importedData=new MarketData(data,baseSymbol,quoteSymbol),initialBalance=backtestingOptions.initialBalance,commissionPercentage=backtestingOptions.commissionPercentage,broker=new Broker(importedData,initialBalance,commissionPercentage);try{const n=runBacktesting(strategy,broker);console.log(n),setBacktestingReport(n)}catch(n){if(n instanceof Error){console.error(n),showToast({title:"Backtesting error",variant:"destructive",description:`${n.name}: ${n.message}`});return}}}var _tmpl$=template('<main class="mx-auto p-4 h-full"><div class="flex flex-col w-full h-full"><div class=mb-4><div class="hidden sm:block"><div class="border-b border-gray-200"><nav class="-mb-px flex gap-6"><a href=#>Editor</a><a href=#>Backtesting report');function prepareMarkers(n){const t=n.closedPositions.map(Le=>Le.type===PositionType.BUY?{time:Le.startDate,position:"belowBar",color:"#0af047",shape:"arrowUp",text:`BUY ${Le.id}`}:{time:Le.startDate,position:"aboveBar",color:"#f0890c",shape:"arrowDown",text:`SELL ${Le.id}`}),i=n.closedPositions.map(Le=>({time:Le.endDate,position:"aboveBar",color:"#bb00fa",shape:"arrowDown",text:`CLOSE ${Le.id}`}));let s=t.concat(i);return s.sort((Le,Oe)=>Le.time.localeCompare(Oe.time)),s}function Home(){const[n,t]=createSignal(null),[i,s]=createSignal([]),[Le,Oe]=createSignal(0),Ae="shrink-0 border border-transparent p-3 text-sm font-medium text-gray-500 hover:text-gray-800",Ee="shrink-0 rounded-t-lg border border-gray-300 border-b-white p-3 text-sm font-medium text-sky-600 bg-sky-50";return createEffect(()=>{if(n()!==null){const $e=prepareMarkers(n());s($e),Oe(1)}else Oe(0)}),(()=>{var $e=_tmpl$(),Ie=$e.firstChild,Fe=Ie.firstChild,He=Fe.firstChild,ze=He.firstChild,je=ze.firstChild,Ne=je.firstChild,Ke=Ne.nextSibling;return Ne.$$click=()=>Oe(0),Ke.$$click=()=>Oe(1),insert(Ie,createComponent(Show,{get when(){return Le()===0},get children(){return createComponent(StrategyEditor,{setBacktestingReport:t})}}),null),insert(Ie,createComponent(Show,{get when(){return Le()===1},get children(){return createComponent(BacktestingReportComponent,{get backtestingReport(){return n()},get markers(){return i()}})}}),null),createRenderEffect(Be=>{var Ue=Le()===0?Ee:Ae,We=Le()===1?Ee:Ae;return Ue!==Be.e&&className(Ne,Be.e=Ue),We!==Be.t&&className(Ke,Be.t=We),Be},{e:void 0,t:void 0}),$e})()}delegateEvents(["click"]);export{Home as default};
